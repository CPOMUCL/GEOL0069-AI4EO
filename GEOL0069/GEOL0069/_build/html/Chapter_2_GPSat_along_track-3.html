

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>GPSat Along-Track Interpolation &#8212; GEOL0069 Guide Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter_2_GPSat_along_track-3';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Interpolation of Sea Level Anomaly using GPSat" href="Chapter_2_SLA_GPSat_William.html" />
    <link rel="prev" title="Introduction to GPSat" href="Chapter_2_Intro_to_GPSat.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to GEOL0069 AI for Earth Observation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3APreparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AIRIS.html">Introduction to Intelligently Reinforced Image Segmentation (IRIS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AML.html">Introduction to AI/Machine Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chapter_1_Sea_ice_and_Lead_Classification.html">Sea-ice and Lead Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_1_AI_Algorithms.html">AI/Machine Learning Implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AFetching_Data.html">Data Fetching</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_1_rollout_3.html">Roll-out on a Full Image</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Data_Colocating_S2_S3_3.html">Colocating Sentinel-3 OLCI/SRAL and Sentinal-2 Optical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Unsupervised_Learning_Methods_2.html">Unsupervised Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Regression.html">Regression Techniques for Predictive Analysis</a></li>

<li class="toctree-l1"><a class="reference internal" href="Creating_training_data_fromS3_S2-2.html">Creating Training Data from Sentinel-2 and Sentinel-3 OLCI Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Regression_Part2_2425.html">Application of Regression Techniques in Satellite Imagery Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Imagery_alignment_intro.html">Imagery Alignment: Introduction and Simple Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="Imagery_alignment_application.html">Images alignment on S3/S2</a></li>
<li class="toctree-l1"><a class="reference internal" href="Creating_training_data_from_aligned_misaligned_imagery.html">Creating Training Data from Aligned and Misaligned Imagery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Regression_Application_MPF_aligned_misaligned_training_data.html">Regression Application on Melt Pond Fractions (MPF)</a></li>

</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter2_IntrotoGaussianProcesses.html">Introduction to Gaussian Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_2_Intro_to_GPSat.html">Introduction to GPSat</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">GPSat Along-Track Interpolation</a></li>




<li class="toctree-l1"><a class="reference internal" href="Chapter_2_SLA_GPSat_William.html">Interpolation of Sea Level Anomaly using GPSat</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ExplainableAI.html">Explainable AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExplainableAI_Part2.html">Explainable AI Part 2</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter_2_GPSat_along_track-3.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Chapter_2_GPSat_along_track-3.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>GPSat Along-Track Interpolation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">GPSat Along-Track Interpolation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-gpsat">Import GPSat</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-profile-for-interpolation">Select profile for interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-expert-locations-at-200-km">Generate expert locations at 200 km</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-along-track-using-gpsat">Interpolate along-track using GPSat</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="gpsat-along-track-interpolation">
<h1>GPSat Along-Track Interpolation<a class="headerlink" href="#gpsat-along-track-interpolation" title="Permalink to this heading">#</a></h1>
<p>Materials can be accessed <a class="reference external" href="https://drive.google.com/drive/folders/14iRZmclnRpIzdvK3y1BBuD-_nnwOIpTX?usp=sharing">here</a>.</p>
<p>The main objective of this notebook is to:</p>
<ul class="simple">
<li><p>Extract <strong>along-track observations</strong> from GPOD processed data, including elevation, classification (lead/floe), and interpolated sea level anomaly (SLA).</p></li>
<li><p>Apply <strong>GPSat’s along-track interpolation</strong> to estimate SLA at all observation points (leads and floes).</p></li>
<li><p>Compare GPSat’s interpolated SLA against the <strong>linear interpolation</strong>.</p></li>
<li><p>Visualiae and assess the differences in interpolated SLA along specific satellite tracks, particularly over leads and floes.</p></li>
<li><p>The comparison helps evaluate the benefit of spatio-temporal interpolation using Gaussian Processes (GPSat) versus simple linear interpolation.</p></li>
</ul>
<section id="import-gpsat">
<h2>Import GPSat<a class="headerlink" href="#import-gpsat" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>cartopy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting cartopy
  Downloading Cartopy-0.24.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (7.9 kB)
Requirement already satisfied: numpy&gt;=1.23 in /usr/local/lib/python3.11/dist-packages (from cartopy) (1.26.4)
Requirement already satisfied: matplotlib&gt;=3.6 in /usr/local/lib/python3.11/dist-packages (from cartopy) (3.10.0)
Requirement already satisfied: shapely&gt;=1.8 in /usr/local/lib/python3.11/dist-packages (from cartopy) (2.0.7)
Requirement already satisfied: packaging&gt;=21 in /usr/local/lib/python3.11/dist-packages (from cartopy) (24.2)
Requirement already satisfied: pyshp&gt;=2.3 in /usr/local/lib/python3.11/dist-packages (from cartopy) (2.3.1)
Requirement already satisfied: pyproj&gt;=3.3.1 in /usr/local/lib/python3.11/dist-packages (from cartopy) (3.7.1)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (4.56.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (1.4.8)
Requirement already satisfied: pillow&gt;=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (11.1.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (3.2.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6-&gt;cartopy) (2.8.2)
Requirement already satisfied: certifi in /usr/local/lib/python3.11/dist-packages (from pyproj&gt;=3.3.1-&gt;cartopy) (2025.1.31)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.6-&gt;cartopy) (1.17.0)
Downloading Cartopy-0.24.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">11.7/11.7 MB</span> <span class=" -Color -Color-Red">70.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: cartopy
Successfully installed cartopy-0.24.1
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># TODO: allow for mounting of gdrive</span>
<span class="c1"># TODO: allow for checking out a branch</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">re</span>

    <span class="c1"># change to working directory</span>
    <span class="n">work_dir</span> <span class="o">=</span> <span class="s2">&quot;/content&quot;</span>

    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">work_dir</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;workspace directory: </span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

    <span class="c1"># clone repository</span>
    <span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/CPOMUCL/GPSat.git

    <span class="n">repo_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_dir</span><span class="p">,</span> <span class="s2">&quot;GPSat&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;changing directory to: </span><span class="si">{</span><span class="n">repo_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">repo_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;GPSat&#39;...
remote: Enumerating objects: 2873, done.
remote: Counting objects: 100% (272/272), done.
remote: Compressing objects: 100% (114/114), done.
remote: Total 2873 (delta 143), reused 253 (delta 139), pack-reused 2601 (from 1)
Receiving objects: 100% (2873/2873), 59.92 MiB | 10.61 MiB/s, done.
Resolving deltas: 100% (1959/1959), done.
Updating files: 100% (127/127), done.
changing directory to: /content/GPSat
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ignoring setuptools: markers &#39;python_version &gt;= &quot;3.12&quot;&#39; don&#39;t match your environment
Ignoring tensorflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;x86_64&quot;&#39; don&#39;t match your environment
Ignoring tensorflow-macos: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Ignoring gpflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Requirement already satisfied: astropy&gt;=5.1.1 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 5)) (7.0.1)
Requirement already satisfied: chardet&gt;=4.0.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 6)) (5.2.0)
Collecting pandas==1.5.3 (from -r requirements.txt (line 7))
  Downloading pandas-1.5.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)
Collecting tensorflow&lt;2.16.0,&gt;=2.14.0 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading tensorflow-2.15.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
Collecting tensorflow-probability&lt;0.24.0 (from -r requirements.txt (line 14))
  Downloading tensorflow_probability-0.23.0-py2.py3-none-any.whl.metadata (13 kB)
Collecting gpflow&gt;=2.9.0 (from -r requirements.txt (line 25))
  Downloading gpflow-2.9.2-py3-none-any.whl.metadata (13 kB)
Collecting gpytorch==1.10 (from -r requirements.txt (line 28))
  Downloading gpytorch-1.10-py3-none-any.whl.metadata (7.4 kB)
Requirement already satisfied: matplotlib&gt;=3.6.2 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 29)) (3.10.0)
Requirement already satisfied: scipy&gt;=1.9.3 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 30)) (1.13.1)
Requirement already satisfied: tables&gt;=3.7.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 31)) (3.10.2)
Collecting netCDF4==1.6.2 (from -r requirements.txt (line 32))
  Downloading netCDF4-1.6.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (1.6 kB)
Requirement already satisfied: xarray&gt;=2022.10.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 33)) (2025.1.2)
Requirement already satisfied: gast&gt;=0.4.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 34)) (0.6.0)
Requirement already satisfied: pyproj&gt;=3.4.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 35)) (3.7.1)
Requirement already satisfied: seaborn&gt;=0.11.2 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 36)) (0.13.2)
Collecting jupyter==1.0.0 (from -r requirements.txt (line 37))
  Downloading jupyter-1.0.0-py2.py3-none-any.whl.metadata (995 bytes)
Collecting scikit-learn==1.2.2 (from -r requirements.txt (line 38))
  Downloading scikit_learn-1.2.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (11 kB)
Requirement already satisfied: numba&gt;=0.56.4 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 39)) (0.60.0)
Requirement already satisfied: pytest&gt;=7.2.0 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 40)) (8.3.5)
Collecting dataclasses-json==0.5.7 (from -r requirements.txt (line 41))
  Downloading dataclasses_json-0.5.7-py3-none-any.whl.metadata (22 kB)
Collecting global-land-mask==1.0.0 (from -r requirements.txt (line 42))
  Downloading global_land_mask-1.0.0-py3-none-any.whl.metadata (5.2 kB)
Collecting cartopy==0.22.0 (from -r requirements.txt (line 43))
  Downloading Cartopy-0.22.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (15 kB)
Collecting fastparquet&gt;=2024.2.0 (from -r requirements.txt (line 44))
  Downloading fastparquet-2024.11.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (4.2 kB)
Requirement already satisfied: pyarrow&gt;=15.0.2 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 45)) (18.1.0)
Requirement already satisfied: Sphinx&gt;=5.0.2 in /usr/local/lib/python3.11/dist-packages (from -r requirements.txt (line 50)) (8.1.3)
Collecting nbsphinx&gt;=0.9.3 (from -r requirements.txt (line 51))
  Downloading nbsphinx-0.9.7-py3-none-any.whl.metadata (2.3 kB)
Collecting numpydoc&gt;=1.6.0 (from -r requirements.txt (line 52))
  Downloading numpydoc-1.8.0-py3-none-any.whl.metadata (4.3 kB)
Collecting sphinxemoji&gt;=0.2.0 (from -r requirements.txt (line 53))
  Downloading sphinxemoji-0.3.1-py3-none-any.whl.metadata (922 bytes)
Collecting sphinx-rtd-theme&gt;=1.3.0 (from -r requirements.txt (line 54))
  Downloading sphinx_rtd_theme-3.0.2-py2.py3-none-any.whl.metadata (4.4 kB)
Requirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.11/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 7)) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.11/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 7)) (2025.1)
Requirement already satisfied: numpy&gt;=1.21.0 in /usr/local/lib/python3.11/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 7)) (1.26.4)
Collecting linear-operator&gt;=0.4.0 (from gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading linear_operator-0.6-py3-none-any.whl.metadata (15 kB)
Collecting cftime (from netCDF4==1.6.2-&gt;-r requirements.txt (line 32))
  Downloading cftime-1.6.4.post1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (8.7 kB)
Requirement already satisfied: notebook in /usr/local/lib/python3.11/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.5.5)
Collecting qtconsole (from jupyter==1.0.0-&gt;-r requirements.txt (line 37))
  Downloading qtconsole-5.6.1-py3-none-any.whl.metadata (5.0 kB)
Requirement already satisfied: jupyter-console in /usr/local/lib/python3.11/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.1.0)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.11/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (7.16.6)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.11/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.17.1)
Requirement already satisfied: ipywidgets in /usr/local/lib/python3.11/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (7.7.1)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.11/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 38)) (1.4.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.11/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 38)) (3.5.0)
Collecting marshmallow&lt;4.0.0,&gt;=3.3.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 41))
  Downloading marshmallow-3.26.1-py3-none-any.whl.metadata (7.3 kB)
Collecting marshmallow-enum&lt;2.0.0,&gt;=1.5.1 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 41))
  Downloading marshmallow_enum-1.5.1-py2.py3-none-any.whl.metadata (2.5 kB)
Collecting typing-inspect&gt;=0.4.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 41))
  Downloading typing_inspect-0.9.0-py3-none-any.whl.metadata (1.5 kB)
Requirement already satisfied: shapely&gt;=1.7 in /usr/local/lib/python3.11/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 43)) (2.0.7)
Requirement already satisfied: packaging&gt;=20 in /usr/local/lib/python3.11/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 43)) (24.2)
Requirement already satisfied: pyshp&gt;=2.1 in /usr/local/lib/python3.11/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 43)) (2.3.1)
Requirement already satisfied: pyerfa&gt;=2.0.1.1 in /usr/local/lib/python3.11/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 5)) (2.0.1.5)
Requirement already satisfied: astropy-iers-data&gt;=0.2025.1.31.12.41.4 in /usr/local/lib/python3.11/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 5)) (0.2025.3.3.0.34.45)
Requirement already satisfied: PyYAML&gt;=6.0.0 in /usr/local/lib/python3.11/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 5)) (6.0.2)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=23.5.26 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (25.2.10)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.2.0)
Requirement already satisfied: h5py&gt;=2.9.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (3.12.1)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (18.1.1)
Collecting ml-dtypes~=0.3.1 (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading ml_dtypes-0.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (20 kB)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (3.4.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (4.25.6)
Requirement already satisfied: setuptools in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (75.1.0)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (1.17.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (2.5.0)
Requirement already satisfied: typing-extensions&gt;=3.6.6 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (4.12.2)
Collecting wrapt&lt;1.15,&gt;=1.11.0 (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading wrapt-1.14.1-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl.metadata (6.7 kB)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.37.1)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.11/dist-packages (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (1.70.0)
Collecting tensorboard&lt;2.16,&gt;=2.15 (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading tensorboard-2.15.2-py3-none-any.whl.metadata (1.7 kB)
Collecting tensorflow-estimator&lt;2.16,&gt;=2.15.0 (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading tensorflow_estimator-2.15.0-py2.py3-none-any.whl.metadata (1.3 kB)
Collecting keras&lt;2.16,&gt;=2.15.0 (from tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading keras-2.15.0-py3-none-any.whl.metadata (2.4 kB)
Requirement already satisfied: decorator in /usr/local/lib/python3.11/dist-packages (from tensorflow-probability&lt;0.24.0-&gt;-r requirements.txt (line 14)) (4.4.2)
Requirement already satisfied: cloudpickle&gt;=1.3 in /usr/local/lib/python3.11/dist-packages (from tensorflow-probability&lt;0.24.0-&gt;-r requirements.txt (line 14)) (3.1.1)
Requirement already satisfied: dm-tree in /usr/local/lib/python3.11/dist-packages (from tensorflow-probability&lt;0.24.0-&gt;-r requirements.txt (line 14)) (0.1.9)
Collecting check-shapes&gt;=1.0.0 (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25))
  Downloading check_shapes-1.1.1-py3-none-any.whl.metadata (2.4 kB)
Requirement already satisfied: deprecated in /usr/local/lib/python3.11/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25)) (1.2.18)
Requirement already satisfied: multipledispatch&gt;=0.6 in /usr/local/lib/python3.11/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25)) (1.0.0)
Requirement already satisfied: tabulate in /usr/local/lib/python3.11/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25)) (0.9.0)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (1.3.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (4.56.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (1.4.8)
Requirement already satisfied: pillow&gt;=8 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (11.1.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.11/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 29)) (3.2.1)
Requirement already satisfied: numexpr&gt;=2.6.2 in /usr/local/lib/python3.11/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (2.10.2)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.11/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (9.0.0)
Requirement already satisfied: blosc2&gt;=2.3.0 in /usr/local/lib/python3.11/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (3.2.0)
INFO: pip is looking at multiple versions of xarray to determine which version is compatible with other requirements. This could take a while.
Collecting xarray&gt;=2022.10.0 (from -r requirements.txt (line 33))
  Downloading xarray-2025.1.1-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2025.1.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.11.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.10.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.9.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.7.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.6.0-py3-none-any.whl.metadata (11 kB)
INFO: pip is still looking at multiple versions of xarray to determine which version is compatible with other requirements. This could take a while.
  Downloading xarray-2024.5.0-py3-none-any.whl.metadata (11 kB)
  Downloading xarray-2024.3.0-py3-none-any.whl.metadata (11 kB)
Requirement already satisfied: certifi in /usr/local/lib/python3.11/dist-packages (from pyproj&gt;=3.4.0-&gt;-r requirements.txt (line 35)) (2025.1.31)
Requirement already satisfied: llvmlite&lt;0.44,&gt;=0.43.0dev0 in /usr/local/lib/python3.11/dist-packages (from numba&gt;=0.56.4-&gt;-r requirements.txt (line 39)) (0.43.0)
Requirement already satisfied: iniconfig in /usr/local/lib/python3.11/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 40)) (2.0.0)
Requirement already satisfied: pluggy&lt;2,&gt;=1.5 in /usr/local/lib/python3.11/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 40)) (1.5.0)
Requirement already satisfied: cramjam&gt;=2.3 in /usr/local/lib/python3.11/dist-packages (from fastparquet&gt;=2024.2.0-&gt;-r requirements.txt (line 44)) (2.9.1)
Requirement already satisfied: fsspec in /usr/local/lib/python3.11/dist-packages (from fastparquet&gt;=2024.2.0-&gt;-r requirements.txt (line 44)) (2024.10.0)
Requirement already satisfied: sphinxcontrib-applehelp&gt;=1.0.7 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.0.0)
Requirement already satisfied: sphinxcontrib-devhelp&gt;=1.0.6 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.0.0)
Requirement already satisfied: sphinxcontrib-htmlhelp&gt;=2.0.6 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.1.0)
Requirement already satisfied: sphinxcontrib-jsmath&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (1.0.1)
Requirement already satisfied: sphinxcontrib-qthelp&gt;=1.0.6 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.0.0)
Requirement already satisfied: sphinxcontrib-serializinghtml&gt;=1.1.9 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.0.0)
Requirement already satisfied: Jinja2&gt;=3.1 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (3.1.5)
Requirement already satisfied: Pygments&gt;=2.17 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.18.0)
Requirement already satisfied: docutils&lt;0.22,&gt;=0.20 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (0.21.2)
Requirement already satisfied: snowballstemmer&gt;=2.2 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.2.0)
Requirement already satisfied: babel&gt;=2.13 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.17.0)
Requirement already satisfied: alabaster&gt;=0.7.14 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (1.0.0)
Requirement already satisfied: imagesize&gt;=1.3 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (1.4.1)
Requirement already satisfied: requests&gt;=2.30.0 in /usr/local/lib/python3.11/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.32.3)
Requirement already satisfied: traitlets&gt;=5 in /usr/local/lib/python3.11/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (5.7.1)
Requirement already satisfied: nbformat in /usr/local/lib/python3.11/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (5.10.4)
Collecting sphinxcontrib-jquery&lt;5,&gt;=4 (from sphinx-rtd-theme&gt;=1.3.0-&gt;-r requirements.txt (line 54))
  Downloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl.metadata (2.6 kB)
Collecting nvidia-cublas-cu12==12.2.5.6 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cublas_cu12-12.2.5.6-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-cupti-cu12==12.2.142 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cuda_cupti_cu12-12.2.142-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cuda-nvcc-cu12==12.2.140 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cuda_nvcc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-nvrtc-cu12==12.2.140 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cuda_nvrtc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-runtime-cu12==12.2.140 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cuda_runtime_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cudnn-cu12==8.9.4.25 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cudnn_cu12-8.9.4.25-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cufft-cu12==11.0.8.103 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cufft_cu12-11.0.8.103-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-curand-cu12==10.3.3.141 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_curand_cu12-10.3.3.141-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cusolver-cu12==11.5.2.141 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cusolver_cu12-11.5.2.141-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusparse-cu12==12.1.2.141 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_cusparse_cu12-12.1.2.141-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-nccl-cu12==2.16.5 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_nccl_cu12-2.16.5-py3-none-manylinux1_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvjitlink-cu12==12.2.140 (from tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11))
  Downloading nvidia_nvjitlink_cu12-12.2.140-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Requirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.11/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.45.1)
Requirement already satisfied: ndindex in /usr/local/lib/python3.11/dist-packages (from blosc2&gt;=2.3.0-&gt;tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (1.9.2)
Requirement already satisfied: msgpack in /usr/local/lib/python3.11/dist-packages (from blosc2&gt;=2.3.0-&gt;tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (1.1.0)
Requirement already satisfied: platformdirs in /usr/local/lib/python3.11/dist-packages (from blosc2&gt;=2.3.0-&gt;tables&gt;=3.7.0-&gt;-r requirements.txt (line 31)) (4.3.6)
Collecting dropstackframe&gt;=0.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25))
  Downloading dropstackframe-0.1.1-py3-none-any.whl.metadata (4.3 kB)
Collecting lark&lt;2.0.0,&gt;=1.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 25))
  Downloading lark-1.2.2-py3-none-any.whl.metadata (1.8 kB)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.11/dist-packages (from Jinja2&gt;=3.1-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (3.0.2)
Requirement already satisfied: torch&gt;=2.0 in /usr/local/lib/python3.11/dist-packages (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (2.5.1+cu124)
Collecting jaxtyping (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading jaxtyping-0.2.38-py3-none-any.whl.metadata (6.6 kB)
Requirement already satisfied: mpmath&lt;=1.3,&gt;=0.19 in /usr/local/lib/python3.11/dist-packages (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (1.3.0)
Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (4.13.3)
Requirement already satisfied: bleach!=5.0.0 in /usr/local/lib/python3.11/dist-packages (from bleach[css]!=5.0.0-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.2.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.7.1)
Requirement already satisfied: jupyter-core&gt;=4.7 in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (5.7.2)
Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.3.0)
Requirement already satisfied: mistune&lt;4,&gt;=2.0.3 in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (3.1.2)
Requirement already satisfied: nbclient&gt;=0.5.0 in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.10.2)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.11/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.5.1)
Requirement already satisfied: fastjsonschema&gt;=2.15 in /usr/local/lib/python3.11/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (2.21.1)
Requirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.11/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (4.23.0)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.11/dist-packages (from requests&gt;=2.30.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (3.4.1)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.11/dist-packages (from requests&gt;=2.30.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (3.10)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.11/dist-packages (from requests&gt;=2.30.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 50)) (2.3.0)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (2.38.0)
Requirement already satisfied: google-auth-oauthlib&lt;2,&gt;=0.5 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (1.2.1)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (3.7)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (3.1.3)
<span class=" -Color -Color-Yellow">WARNING: tensorflow-probability 0.23.0 does not provide the extra &#39;tf&#39;</span>
Collecting mypy-extensions&gt;=0.3.0 (from typing-inspect&gt;=0.4.0-&gt;dataclasses-json==0.5.7-&gt;-r requirements.txt (line 41))
  Downloading mypy_extensions-1.0.0-py3-none-any.whl.metadata (1.1 kB)
Requirement already satisfied: attrs&gt;=18.2.0 in /usr/local/lib/python3.11/dist-packages (from dm-tree-&gt;tensorflow-probability&lt;0.24.0-&gt;-r requirements.txt (line 14)) (25.1.0)
Requirement already satisfied: debugpy&gt;=1.0 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.8.0)
Requirement already satisfied: ipython&gt;=7.23.1 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (7.34.0)
Requirement already satisfied: jupyter-client&gt;=6.1.12 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.1.12)
Requirement already satisfied: matplotlib-inline&gt;=0.1 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.1.7)
Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.6.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (5.9.5)
Requirement already satisfied: pyzmq&gt;=17 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (24.0.1)
Requirement already satisfied: tornado&gt;=6.1 in /usr/local/lib/python3.11/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (6.4.2)
Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.2.0)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (3.6.10)
Requirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.11/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (3.0.13)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.11/dist-packages (from jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (3.0.50)
Requirement already satisfied: argon2-cffi in /usr/local/lib/python3.11/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (23.1.0)
Requirement already satisfied: Send2Trash&gt;=1.8.0 in /usr/local/lib/python3.11/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.8.3)
Requirement already satisfied: terminado&gt;=0.8.3 in /usr/local/lib/python3.11/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.18.1)
Requirement already satisfied: prometheus-client in /usr/local/lib/python3.11/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.21.1)
Requirement already satisfied: nbclassic&gt;=0.4.7 in /usr/local/lib/python3.11/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.2.0)
Collecting qtpy&gt;=2.4.0 (from qtconsole-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37))
  Downloading QtPy-2.4.3-py3-none-any.whl.metadata (12 kB)
Requirement already satisfied: webencodings in /usr/local/lib/python3.11/dist-packages (from bleach!=5.0.0-&gt;bleach[css]!=5.0.0-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.5.1)
Requirement already satisfied: tinycss2&lt;1.5,&gt;=1.1.0 in /usr/local/lib/python3.11/dist-packages (from bleach[css]!=5.0.0-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.4.0)
Requirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.11/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (5.5.2)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.11/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.4.1)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.11/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.11/dist-packages (from google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (2.0.0)
Collecting jedi&gt;=0.16 (from ipython&gt;=7.23.1-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37))
  Downloading jedi-0.19.2-py2.py3-none-any.whl.metadata (22 kB)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=7.23.1-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.7.5)
Requirement already satisfied: backcall in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=7.23.1-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.2.0)
Requirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.11/dist-packages (from ipython&gt;=7.23.1-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (4.9.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (2024.10.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (0.36.2)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /usr/local/lib/python3.11/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 51)) (0.23.1)
Requirement already satisfied: notebook-shim&gt;=0.2.3 in /usr/local/lib/python3.11/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.2.4)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.11/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.2.13)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.11/dist-packages (from terminado&gt;=0.8.3-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.7.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.11/dist-packages (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (3.17.0)
Requirement already satisfied: networkx in /usr/local/lib/python3.11/dist-packages (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (3.4.2)
INFO: pip is looking at multiple versions of torch to determine which version is compatible with other requirements. This could take a while.
Collecting torch&gt;=2.0 (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading torch-2.6.0-cp311-cp311-manylinux1_x86_64.whl.metadata (28 kB)
  Downloading torch-2.5.1-cp311-cp311-manylinux1_x86_64.whl.metadata (28 kB)
  Downloading torch-2.5.0-cp311-cp311-manylinux1_x86_64.whl.metadata (28 kB)
  Downloading torch-2.4.1-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
Requirement already satisfied: sympy in /usr/local/lib/python3.11/dist-packages (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (1.13.1)
  Downloading torch-2.4.0-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
  Downloading torch-2.3.1-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
  Downloading torch-2.3.0-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
INFO: pip is still looking at multiple versions of torch to determine which version is compatible with other requirements. This could take a while.
  Downloading torch-2.2.2-cp311-cp311-manylinux1_x86_64.whl.metadata (25 kB)
  Downloading torch-2.2.1-cp311-cp311-manylinux1_x86_64.whl.metadata (26 kB)
  Downloading torch-2.2.0-cp311-cp311-manylinux1_x86_64.whl.metadata (25 kB)
  Downloading torch-2.1.2-cp311-cp311-manylinux1_x86_64.whl.metadata (25 kB)
  Downloading torch-2.1.1-cp311-cp311-manylinux1_x86_64.whl.metadata (25 kB)
INFO: This is taking longer than usual. You might need to provide the dependency resolver with stricter constraints to reduce runtime. See https://pip.pypa.io/warnings/backtracking for guidance. If you want to abort this run, press Ctrl + C.
  Downloading torch-2.1.0-cp311-cp311-manylinux1_x86_64.whl.metadata (25 kB)
  Downloading torch-2.0.1-cp311-cp311-manylinux1_x86_64.whl.metadata (24 kB)
Collecting nvidia-cuda-nvrtc-cu11==11.7.99 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-cuda-runtime-cu11==11.7.99 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cuda-cupti-cu11==11.7.101 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cuda_cupti_cu11-11.7.101-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cudnn-cu11==8.5.0.96 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cublas-cu11==11.10.3.66 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cufft-cu11==10.9.0.58 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux2014_x86_64.whl.metadata (1.5 kB)
Collecting nvidia-curand-cu11==10.2.10.91 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_curand_cu11-10.2.10.91-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusolver-cu11==11.4.0.1 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cusolver_cu11-11.4.0.1-2-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-cusparse-cu11==11.7.4.91 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_cusparse_cu11-11.7.4.91-py3-none-manylinux1_x86_64.whl.metadata (1.6 kB)
Collecting nvidia-nccl-cu11==2.14.3 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_nccl_cu11-2.14.3-py3-none-manylinux1_x86_64.whl.metadata (1.8 kB)
Collecting nvidia-nvtx-cu11==11.7.91 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading nvidia_nvtx_cu11-11.7.91-py3-none-manylinux1_x86_64.whl.metadata (1.7 kB)
Collecting triton==2.0.0 (from torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading triton-2.0.0-1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl.metadata (1.0 kB)
Requirement already satisfied: cmake in /usr/local/lib/python3.11/dist-packages (from triton==2.0.0-&gt;torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28)) (3.31.6)
Collecting lit (from triton==2.0.0-&gt;torch&gt;=2.0-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading lit-18.1.8-py3-none-any.whl.metadata (2.5 kB)
Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.11/dist-packages (from argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (21.2.0)
Requirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.11/dist-packages (from beautifulsoup4-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (2.6)
Collecting wadler-lindig&gt;=0.1.3 (from jaxtyping-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 28))
  Downloading wadler_lindig-0.1.3-py3-none-any.whl.metadata (17 kB)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.4 in /usr/local/lib/python3.11/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=7.23.1-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (0.8.4)
Requirement already satisfied: jupyter-server&lt;3,&gt;=1.8 in /usr/local/lib/python3.11/dist-packages (from notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.24.0)
Requirement already satisfied: pyasn1&lt;0.7.0,&gt;=0.4.6 in /usr/local/lib/python3.11/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (0.6.1)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.11/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow&lt;2.16.0,&gt;=2.14.0-&gt;tensorflow[and-cuda]&lt;2.16.0,&gt;=2.14.0-&gt;-r requirements.txt (line 11)) (3.2.2)
Requirement already satisfied: cffi&gt;=1.0.1 in /usr/local/lib/python3.11/dist-packages (from argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.17.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.11/dist-packages (from cffi&gt;=1.0.1-&gt;argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (2.22)
Requirement already satisfied: anyio&lt;4,&gt;=3.1.0 in /usr/local/lib/python3.11/dist-packages (from jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (3.7.1)
Requirement already satisfied: websocket-client in /usr/local/lib/python3.11/dist-packages (from jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.8.0)
Requirement already satisfied: sniffio&gt;=1.1 in /usr/local/lib/python3.11/dist-packages (from anyio&lt;4,&gt;=3.1.0-&gt;jupyter-server&lt;3,&gt;=1.8-&gt;notebook-shim&gt;=0.2.3-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 37)) (1.3.1)
Downloading pandas-1.5.3-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (12.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">12.0/12.0 MB</span> <span class=" -Color -Color-Red">22.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading gpytorch-1.10-py3-none-any.whl (255 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">255.2/255.2 kB</span> <span class=" -Color -Color-Red">18.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading netCDF4-1.6.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.1/5.1 MB</span> <span class=" -Color -Color-Red">14.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading jupyter-1.0.0-py2.py3-none-any.whl (2.7 kB)
Downloading scikit_learn-1.2.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (9.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">9.6/9.6 MB</span> <span class=" -Color -Color-Red">21.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading dataclasses_json-0.5.7-py3-none-any.whl (25 kB)
Downloading global_land_mask-1.0.0-py3-none-any.whl (1.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.8/1.8 MB</span> <span class=" -Color -Color-Red">21.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading Cartopy-0.22.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">11.9/11.9 MB</span> <span class=" -Color -Color-Red">22.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading tensorflow-2.15.1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (475.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">475.3/475.3 MB</span> <span class=" -Color -Color-Red">4.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading tensorflow_probability-0.23.0-py2.py3-none-any.whl (6.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">6.9/6.9 MB</span> <span class=" -Color -Color-Red">96.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading gpflow-2.9.2-py3-none-any.whl (392 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">392.9/392.9 kB</span> <span class=" -Color -Color-Red">38.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading xarray-2024.3.0-py3-none-any.whl (1.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.1/1.1 MB</span> <span class=" -Color -Color-Red">68.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading fastparquet-2024.11.0-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.8/1.8 MB</span> <span class=" -Color -Color-Red">77.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nbsphinx-0.9.7-py3-none-any.whl (31 kB)
Downloading numpydoc-1.8.0-py3-none-any.whl (64 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">64.0/64.0 kB</span> <span class=" -Color -Color-Red">7.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading sphinxemoji-0.3.1-py3-none-any.whl (46 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">46.1/46.1 kB</span> <span class=" -Color -Color-Red">5.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading sphinx_rtd_theme-3.0.2-py2.py3-none-any.whl (7.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">7.7/7.7 MB</span> <span class=" -Color -Color-Red">107.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cublas_cu12-12.2.5.6-py3-none-manylinux1_x86_64.whl (417.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">417.8/417.8 MB</span> <span class=" -Color -Color-Red">4.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_cupti_cu12-12.2.142-py3-none-manylinux1_x86_64.whl (13.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">13.9/13.9 MB</span> <span class=" -Color -Color-Red">27.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_nvcc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (21.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">21.3/21.3 MB</span> <span class=" -Color -Color-Red">41.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_nvrtc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (23.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">23.4/23.4 MB</span> <span class=" -Color -Color-Red">41.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_runtime_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (845 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">845.8/845.8 kB</span> <span class=" -Color -Color-Red">44.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cudnn_cu12-8.9.4.25-py3-none-manylinux1_x86_64.whl (720.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">720.1/720.1 MB</span> <span class=" -Color -Color-Red">1.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cufft_cu12-11.0.8.103-py3-none-manylinux1_x86_64.whl (98.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">98.6/98.6 MB</span> <span class=" -Color -Color-Red">8.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_curand_cu12-10.3.3.141-py3-none-manylinux1_x86_64.whl (56.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">56.5/56.5 MB</span> <span class=" -Color -Color-Red">11.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cusolver_cu12-11.5.2.141-py3-none-manylinux1_x86_64.whl (124.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">124.9/124.9 MB</span> <span class=" -Color -Color-Red">8.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cusparse_cu12-12.1.2.141-py3-none-manylinux1_x86_64.whl (195.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">195.3/195.3 MB</span> <span class=" -Color -Color-Red">6.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_nccl_cu12-2.16.5-py3-none-manylinux1_x86_64.whl (188.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">188.7/188.7 MB</span> <span class=" -Color -Color-Red">6.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_nvjitlink_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (20.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">20.2/20.2 MB</span> <span class=" -Color -Color-Red">71.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading check_shapes-1.1.1-py3-none-any.whl (45 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">45.8/45.8 kB</span> <span class=" -Color -Color-Red">4.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading keras-2.15.0-py3-none-any.whl (1.7 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.7/1.7 MB</span> <span class=" -Color -Color-Red">74.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading linear_operator-0.6-py3-none-any.whl (176 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">176.3/176.3 kB</span> <span class=" -Color -Color-Red">19.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading marshmallow-3.26.1-py3-none-any.whl (50 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">50.9/50.9 kB</span> <span class=" -Color -Color-Red">5.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading marshmallow_enum-1.5.1-py2.py3-none-any.whl (4.2 kB)
Downloading ml_dtypes-0.3.2-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (2.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">2.2/2.2 MB</span> <span class=" -Color -Color-Red">55.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl (121 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">121.1/121.1 kB</span> <span class=" -Color -Color-Red">14.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading tensorboard-2.15.2-py3-none-any.whl (5.5 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.5/5.5 MB</span> <span class=" -Color -Color-Red">114.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading tensorflow_estimator-2.15.0-py2.py3-none-any.whl (441 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">442.0/442.0 kB</span> <span class=" -Color -Color-Red">35.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)
Downloading wrapt-1.14.1-cp311-cp311-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_17_x86_64.manylinux2014_x86_64.whl (78 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">78.4/78.4 kB</span> <span class=" -Color -Color-Red">9.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading cftime-1.6.4.post1-cp311-cp311-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.4/1.4 MB</span> <span class=" -Color -Color-Red">75.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading qtconsole-5.6.1-py3-none-any.whl (125 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">125.0/125.0 kB</span> <span class=" -Color -Color-Red">13.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading dropstackframe-0.1.1-py3-none-any.whl (4.6 kB)
Downloading lark-1.2.2-py3-none-any.whl (111 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">111.0/111.0 kB</span> <span class=" -Color -Color-Red">12.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading mypy_extensions-1.0.0-py3-none-any.whl (4.7 kB)
Downloading QtPy-2.4.3-py3-none-any.whl (95 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">95.0/95.0 kB</span> <span class=" -Color -Color-Red">10.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading torch-2.0.1-cp311-cp311-manylinux1_x86_64.whl (619.9 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">619.9/619.9 MB</span> <span class=" -Color -Color-Red">2.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cublas_cu11-11.10.3.66-py3-none-manylinux1_x86_64.whl (317.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">317.1/317.1 MB</span> <span class=" -Color -Color-Red">4.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_cupti_cu11-11.7.101-py3-none-manylinux1_x86_64.whl (11.8 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">11.8/11.8 MB</span> <span class=" -Color -Color-Red">82.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_nvrtc_cu11-11.7.99-2-py3-none-manylinux1_x86_64.whl (21.0 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">21.0/21.0 MB</span> <span class=" -Color -Color-Red">75.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cuda_runtime_cu11-11.7.99-py3-none-manylinux1_x86_64.whl (849 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">849.3/849.3 kB</span> <span class=" -Color -Color-Red">52.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cudnn_cu11-8.5.0.96-2-py3-none-manylinux1_x86_64.whl (557.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">557.1/557.1 MB</span> <span class=" -Color -Color-Red">2.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cufft_cu11-10.9.0.58-py3-none-manylinux2014_x86_64.whl (168.4 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">168.4/168.4 MB</span> <span class=" -Color -Color-Red">6.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_curand_cu11-10.2.10.91-py3-none-manylinux1_x86_64.whl (54.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">54.6/54.6 MB</span> <span class=" -Color -Color-Red">13.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cusolver_cu11-11.4.0.1-2-py3-none-manylinux1_x86_64.whl (102.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">102.6/102.6 MB</span> <span class=" -Color -Color-Red">7.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_cusparse_cu11-11.7.4.91-py3-none-manylinux1_x86_64.whl (173.2 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">173.2/173.2 MB</span> <span class=" -Color -Color-Red">6.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_nccl_cu11-2.14.3-py3-none-manylinux1_x86_64.whl (177.1 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">177.1/177.1 MB</span> <span class=" -Color -Color-Red">6.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading nvidia_nvtx_cu11-11.7.91-py3-none-manylinux1_x86_64.whl (98 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">98.6/98.6 kB</span> <span class=" -Color -Color-Red">11.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading triton-2.0.0-1-cp311-cp311-manylinux2014_x86_64.manylinux_2_17_x86_64.whl (63.3 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">63.3/63.3 MB</span> <span class=" -Color -Color-Red">11.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading jaxtyping-0.2.38-py3-none-any.whl (56 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">56.4/56.4 kB</span> <span class=" -Color -Color-Red">6.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading jedi-0.19.2-py2.py3-none-any.whl (1.6 MB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.6/1.6 MB</span> <span class=" -Color -Color-Red">75.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hDownloading wadler_lindig-0.1.3-py3-none-any.whl (20 kB)
Downloading lit-18.1.8-py3-none-any.whl (96 kB)
   ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">96.4/96.4 kB</span> <span class=" -Color -Color-Red">12.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hInstalling collected packages: lit, global-land-mask, wrapt, wadler-lindig, tensorflow-estimator, qtpy, nvidia-nvtx-cu11, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-nccl-cu11, nvidia-cusparse-cu11, nvidia-curand-cu12, nvidia-curand-cu11, nvidia-cufft-cu12, nvidia-cufft-cu11, nvidia-cuda-runtime-cu12, nvidia-cuda-runtime-cu11, nvidia-cuda-nvrtc-cu12, nvidia-cuda-nvrtc-cu11, nvidia-cuda-nvcc-cu12, nvidia-cuda-cupti-cu12, nvidia-cuda-cupti-cu11, nvidia-cublas-cu12, nvidia-cublas-cu11, mypy-extensions, ml-dtypes, marshmallow, lark, keras, jedi, dropstackframe, cftime, typing-inspect, scikit-learn, pandas, nvidia-cusparse-cu12, nvidia-cusolver-cu11, nvidia-cudnn-cu12, nvidia-cudnn-cu11, netCDF4, marshmallow-enum, jaxtyping, check-shapes, xarray, tensorflow-probability, sphinxemoji, sphinxcontrib-jquery, nvidia-cusolver-cu12, numpydoc, fastparquet, dataclasses-json, cartopy, tensorboard, sphinx-rtd-theme, qtconsole, tensorflow, gpflow, nbsphinx, jupyter, triton, torch, linear-operator, gpytorch
  Attempting uninstall: wrapt
    Found existing installation: wrapt 1.17.2
    Uninstalling wrapt-1.17.2:
      Successfully uninstalled wrapt-1.17.2
  Attempting uninstall: nvidia-nvjitlink-cu12
    Found existing installation: nvidia-nvjitlink-cu12 12.5.82
    Uninstalling nvidia-nvjitlink-cu12-12.5.82:
      Successfully uninstalled nvidia-nvjitlink-cu12-12.5.82
  Attempting uninstall: nvidia-nccl-cu12
    Found existing installation: nvidia-nccl-cu12 2.21.5
    Uninstalling nvidia-nccl-cu12-2.21.5:
      Successfully uninstalled nvidia-nccl-cu12-2.21.5
  Attempting uninstall: nvidia-curand-cu12
    Found existing installation: nvidia-curand-cu12 10.3.6.82
    Uninstalling nvidia-curand-cu12-10.3.6.82:
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="c1"># warnings.filterwarnings(&#39;ignore&#39;)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeat</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">GPSat</span> <span class="kn">import</span> <span class="n">get_data_path</span><span class="p">,</span> <span class="n">get_parent_path</span>
<span class="kn">from</span> <span class="nn">GPSat.dataprepper</span> <span class="kn">import</span> <span class="n">DataPrep</span>
<span class="kn">from</span> <span class="nn">GPSat.utils</span> <span class="kn">import</span> <span class="n">WGS84toEASE2_New</span><span class="p">,</span> <span class="n">EASE2toWGS84_New</span><span class="p">,</span> <span class="n">cprint</span><span class="p">,</span> <span class="n">grid_2d_flatten</span><span class="p">,</span> <span class="n">get_weighted_values</span>
<span class="kn">from</span> <span class="nn">GPSat.local_experts</span> <span class="kn">import</span> <span class="n">LocalExpertOI</span><span class="p">,</span> <span class="n">get_results_from_h5file</span>
<span class="kn">from</span> <span class="nn">GPSat.plot_utils</span> <span class="kn">import</span> <span class="n">plot_pcolormesh</span><span class="p">,</span> <span class="n">get_projection</span><span class="p">,</span> <span class="n">plot_pcolormesh_from_results_data</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">smooth_hyperparameters</span>
<span class="kn">import</span> <span class="nn">GPSat</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions_1d</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions_2d</span>


<span class="k">def</span> <span class="nf">GCdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xs</span><span class="p">):</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">lat</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="mi">6378137</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6356752</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span>\
                                  <span class="p">(</span><span class="mi">6378137</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6356752</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">minlat</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">maxlat</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">lon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">;</span> <span class="n">lat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">lon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">;</span> <span class="n">lat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">6356752</span><span class="c1">#np.mean(radius(np.arange(minlat,maxlat)))</span>

    <span class="n">Clat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Clat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">Slat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Slat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">Clon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Clon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
    <span class="n">Slon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Slon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Clat1</span><span class="o">*</span><span class="n">Clon1</span><span class="p">,</span><span class="n">Clat1</span><span class="o">*</span><span class="n">Slon1</span><span class="p">,</span><span class="n">Slat1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Clat2</span><span class="o">*</span><span class="n">Clon2</span><span class="p">,</span><span class="n">Clat2</span><span class="o">*</span><span class="n">Slon2</span><span class="p">,</span><span class="n">Slat2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-data">
<h1>Load data<a class="headerlink" href="#load-data" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#indices for GPOD data:</span>
<span class="c1">#0 = Lon</span>
<span class="c1">#1 = Lat</span>
<span class="c1">#2 = Interpolated SLA</span>
<span class="c1">#3 = Error in interpolated SLA</span>
<span class="c1">#4 = Freeboard</span>
<span class="c1">#5 = Pulse Peakiness</span>
<span class="c1">#6 = Lew</span>
<span class="c1">#7 = Class (1=Lead, 2=Floe, 3=OO)</span>
<span class="c1">#8 = Sigma 0</span>
<span class="c1">#9 = Raw Elevation</span>
<span class="c1">#10 = Mean Sea-surface</span>
<span class="c1">#11 = SIC</span>
<span class="c1">#12 = Sea ice type (0=FYI, 1=MYI)</span>
<span class="c1">#13 = Snow depth</span>
<span class="c1">#14 = Snow density</span>
<span class="c1">#15 = Sea ice thickness</span>
<span class="c1">#16 = GPOD SLA</span>
<span class="c1">#17 = GPOD SSH</span>
<span class="c1">#18 = GPOD SWH</span>
<span class="c1">#19 = Elevation from Samosa</span>

<span class="k">def</span> <span class="nf">process_track</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">grab_dates</span><span class="p">,</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Process a single track file if it falls on a date of interest &quot;&quot;&quot;</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">grab_dates</span><span class="p">:</span>
        <span class="n">time</span> <span class="o">=</span> <span class="mi">14975</span> <span class="o">+</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">days</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

        <span class="n">ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">f</span><span class="p">[:,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f</span><span class="p">[:,</span> <span class="mi">11</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.75</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">==</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s1">&#39;lead&#39;</span><span class="p">,</span> <span class="s1">&#39;floe&#39;</span><span class="p">)</span>

        <span class="n">elvmss</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
        <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span> <span class="o">==</span> <span class="s1">&#39;floe&#39;</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">0.1626</span>  <span class="c1"># Apply bias correction (see Lawrence et al., 2019)</span>

        <span class="n">xg</span><span class="p">,</span> <span class="n">yg</span> <span class="o">=</span> <span class="n">WGS84toEASE2_New</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>

        <span class="c1"># Initialise dataframe to store retrieved track data</span>
        <span class="n">track_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">xg</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">yg</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">time</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">date</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">classes</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elvmss</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;SAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">satellite</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="n">track_df</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">*</span> <span class="n">N</span>
        <span class="k">return</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">track_df</span>

    <span class="k">return</span> <span class="n">count</span><span class="p">,</span> <span class="kc">None</span>

<span class="c1"># Generate date range</span>
<span class="n">interp_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
<span class="n">grab_dates</span> <span class="o">=</span> <span class="p">[(</span><span class="n">interp_date</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span> <span class="o">+</span> \
             <span class="p">[(</span><span class="n">interp_date</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">x</span><span class="p">))</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>

<span class="c1"># Path to directories</span>
<span class="c1"># dirs = sorted(glob.glob(&#39;/Users/wg4031/Dropbox/GPOD_DATA/*&#39;))</span>
<span class="c1"># dirs = sorted(glob.glob(&#39;/content/drive/MyDrive/AI4EO/Week 8/GPOD/*&#39;))</span>
<span class="n">dirs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/GEOL0069/2425/Week 8/GPOD/*&#39;</span><span class="p">))</span>

<span class="c1"># Process tracks</span>
<span class="n">track_dfs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
    <span class="n">satellite</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">satellite</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;SARIN&#39;</span><span class="p">,</span> <span class="s1">&#39;SAR&#39;</span><span class="p">}:</span>
        <span class="n">satellite</span> <span class="o">=</span> <span class="s1">&#39;CS2&#39;</span>
    <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">directory</span><span class="si">}</span><span class="s2">/*v1.proc&quot;</span><span class="p">)):</span>
        <span class="n">count</span><span class="p">,</span> <span class="n">track_df</span> <span class="o">=</span> <span class="n">process_track</span><span class="p">(</span><span class="n">track</span><span class="p">,</span> <span class="n">grab_dates</span><span class="p">,</span> <span class="n">satellite</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">track_df</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">track_dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">track_df</span><span class="p">)</span>

<span class="c1">#Create a single dataframe for all tracks</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">track_dfs</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
&lt;ipython-input-7-f0c6357dd9f7&gt;:36: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  xg, yg = WGS84toEASE2_New(f[ID, 0], f[ID, 1])
</pre></div>
</div>
<div class="output text_html">
  <div id="df-0b69fdf9-842a-4c0b-b5b2-825b585c0cbf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>class</th>
      <th>interpSLA</th>
      <th>elevation</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.056178e+06</td>
      <td>-1.270463e+06</td>
      <td>17907</td>
      <td>-67.427184</td>
      <td>60.000844</td>
      <td>20190111</td>
      <td>lead</td>
      <td>NaN</td>
      <td>0.4397</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-3.055943e+06</td>
      <td>-1.270243e+06</td>
      <td>17907</td>
      <td>-67.429148</td>
      <td>60.003653</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.4207</td>
      <td>0.4250</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.055707e+06</td>
      <td>-1.270022e+06</td>
      <td>17907</td>
      <td>-67.431112</td>
      <td>60.006463</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.4201</td>
      <td>0.4296</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.055472e+06</td>
      <td>-1.269801e+06</td>
      <td>17907</td>
      <td>-67.433077</td>
      <td>60.009272</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.4195</td>
      <td>0.4494</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.055236e+06</td>
      <td>-1.269580e+06</td>
      <td>17907</td>
      <td>-67.435042</td>
      <td>60.012081</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.4190</td>
      <td>0.4171</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>47467</th>
      <td>-2.092143e+06</td>
      <td>4.608423e+05</td>
      <td>17907</td>
      <td>-102.422330</td>
      <td>70.722023</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.3117</td>
      <td>0.0157</td>
      <td>S3A</td>
      <td>21</td>
    </tr>
    <tr>
      <th>47468</th>
      <td>-2.094627e+06</td>
      <td>4.630147e+05</td>
      <td>17907</td>
      <td>-102.464724</td>
      <td>70.695717</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.3311</td>
      <td>0.1970</td>
      <td>S3A</td>
      <td>21</td>
    </tr>
    <tr>
      <th>47469</th>
      <td>-2.095123e+06</td>
      <td>4.634492e+05</td>
      <td>17907</td>
      <td>-102.473190</td>
      <td>70.690454</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.3343</td>
      <td>0.0774</td>
      <td>S3A</td>
      <td>21</td>
    </tr>
    <tr>
      <th>47470</th>
      <td>-2.102075e+06</td>
      <td>4.695333e+05</td>
      <td>17907</td>
      <td>-102.591270</td>
      <td>70.616747</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.4460</td>
      <td>1.9451</td>
      <td>S3A</td>
      <td>21</td>
    </tr>
    <tr>
      <th>47471</th>
      <td>-2.102324e+06</td>
      <td>4.697506e+05</td>
      <td>17907</td>
      <td>-102.595473</td>
      <td>70.614113</td>
      <td>20190111</td>
      <td>lead</td>
      <td>NaN</td>
      <td>2.0547</td>
      <td>S3A</td>
      <td>21</td>
    </tr>
  </tbody>
</table>
<p>47472 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0b69fdf9-842a-4c0b-b5b2-825b585c0cbf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0b69fdf9-842a-4c0b-b5b2-825b585c0cbf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0b69fdf9-842a-4c0b-b5b2-825b585c0cbf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-e23b3ead-c1d9-455a-8538-1f52ed19a3c4">
  <button class="colab-df-quickchart" onclick="quickchart('df-e23b3ead-c1d9-455a-8538-1f52ed19a3c4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-e23b3ead-c1d9-455a-8538-1f52ed19a3c4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_a5577bc4-6c50-4614-a13a-8f466332068b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a5577bc4-6c50-4614-a13a-8f466332068b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/AI4EO/Week 8/&#39;</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;df_GPOD.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/AI4EO/Week 8/&#39;</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;df_GPOD.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="select-profile-for-interpolation">
<h1>Select profile for interpolation<a class="headerlink" href="#select-profile-for-interpolation" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interptrack</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#select the 2nd track loaded within the specified date range around our interp date</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">interptrack</span><span class="p">]</span>


<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df_val</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e408f5c8bccf6900a9ffb19aa3647335f80cb2520d9c577990242d504241fb02.png" src="_images/e408f5c8bccf6900a9ffb19aa3647335f80cb2520d9c577990242d504241fb02.png" />
<div class="output text_html">
  <div id="df-4d77ad12-13dc-43f7-a066-b71be47ee0d5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>class</th>
      <th>interpSLA</th>
      <th>elevation</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3051</th>
      <td>-546016.208513</td>
      <td>7.870765e+05</td>
      <td>17907</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3052</th>
      <td>-545744.788692</td>
      <td>7.872712e+05</td>
      <td>17907</td>
      <td>-145.269889</td>
      <td>81.414930</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.1204</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3053</th>
      <td>-545473.353742</td>
      <td>7.874660e+05</td>
      <td>17907</td>
      <td>-145.289868</td>
      <td>81.414880</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.2833</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3054</th>
      <td>-545201.932777</td>
      <td>7.876608e+05</td>
      <td>17907</td>
      <td>-145.309847</td>
      <td>81.414830</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.2403</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3055</th>
      <td>-544930.498775</td>
      <td>7.878555e+05</td>
      <td>17907</td>
      <td>-145.329826</td>
      <td>81.414779</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.1529</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>6054</th>
      <td>985661.345909</td>
      <td>1.804912e+06</td>
      <td>17907</td>
      <td>151.361068</td>
      <td>71.501454</td>
      <td>20190111</td>
      <td>lead</td>
      <td>-0.0670</td>
      <td>-0.1594</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6055</th>
      <td>985942.928513</td>
      <td>1.805084e+06</td>
      <td>17907</td>
      <td>151.356490</td>
      <td>71.498852</td>
      <td>20190111</td>
      <td>lead</td>
      <td>-0.0672</td>
      <td>-0.1119</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6056</th>
      <td>986224.515088</td>
      <td>1.805257e+06</td>
      <td>17907</td>
      <td>151.351913</td>
      <td>71.496250</td>
      <td>20190111</td>
      <td>lead</td>
      <td>-0.0674</td>
      <td>-0.0875</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6057</th>
      <td>986506.099320</td>
      <td>1.805430e+06</td>
      <td>17907</td>
      <td>151.347337</td>
      <td>71.493648</td>
      <td>20190111</td>
      <td>lead</td>
      <td>-0.0677</td>
      <td>-0.1143</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
    <tr>
      <th>6058</th>
      <td>986787.687498</td>
      <td>1.805602e+06</td>
      <td>17907</td>
      <td>151.342762</td>
      <td>71.491046</td>
      <td>20190111</td>
      <td>lead</td>
      <td>NaN</td>
      <td>-0.1230</td>
      <td>S3A</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>3008 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-4d77ad12-13dc-43f7-a066-b71be47ee0d5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-4d77ad12-13dc-43f7-a066-b71be47ee0d5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-4d77ad12-13dc-43f7-a066-b71be47ee0d5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-01fbf546-bf88-4f29-86b2-0bed541b08fc">
  <button class="colab-df-quickchart" onclick="quickchart('df-01fbf546-bf88-4f29-86b2-0bed541b08fc')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-01fbf546-bf88-4f29-86b2-0bed541b08fc button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_a4eceb9b-b01e-45d8-843d-674ba1c481f9">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_val')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_a4eceb9b-b01e-45d8-843d-674ba1c481f9 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_val');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lead&#39;</span><span class="p">)</span>
<span class="n">floes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;floe&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">leads</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">leads</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;leads&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">floes</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">floes</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;floes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">])),</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/78a79cfacf4ba18e8e6e2820bdd48077f52018e113ab9afddfc0eb0b53bdaa0d.png" src="_images/78a79cfacf4ba18e8e6e2820bdd48077f52018e113ab9afddfc0eb0b53bdaa0d.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="generate-expert-locations-at-200-km">
<h1>Generate expert locations at 200 km<a class="headerlink" href="#generate-expert-locations-at-200-km" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#divide track into 200 km points for expert locations</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">r_exp</span> <span class="o">=</span> <span class="n">GCdist</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">Xs</span><span class="p">)</span> <span class="c1">#compute distance matrix</span>
<span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span>
<span class="n">exp_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]),</span><span class="mf">100e3</span><span class="p">)</span>
<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">exp_grid</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">-</span><span class="n">ix</span><span class="p">)</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">temp</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">16</span><span class="p">:</span>
        <span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">experts</span> <span class="o">=</span> <span class="n">df_val</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">]</span>
<span class="n">experts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-5-41fd6520fc49&gt;:42: RuntimeWarning: invalid value encountered in arccos
  return r*np.arccos(np.dot(n1,n2.T))
&lt;ipython-input-12-d50798efbcae&gt;:4: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  df_val[&#39;dist_along_track&#39;] = r_exp[0,:]
</pre></div>
</div>
<img alt="_images/45612f832d880a2cc309342c46257cf34e00a14b88260dbbae0772fa9605c997.png" src="_images/45612f832d880a2cc309342c46257cf34e00a14b88260dbbae0772fa9605c997.png" />
<div class="output text_html">
  <div id="df-02c3d168-309a-410b-93cf-8155ef21879f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>class</th>
      <th>interpSLA</th>
      <th>elevation</th>
      <th>SAT</th>
      <th>track</th>
      <th>dist_along_track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3051</th>
      <td>-546016.208513</td>
      <td>7.870765e+05</td>
      <td>17907</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>3265</th>
      <td>-463933.092598</td>
      <td>8.457381e+05</td>
      <td>17907</td>
      <td>-151.252849</td>
      <td>81.354797</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1058</td>
      <td>0.1921</td>
      <td>S3A</td>
      <td>1</td>
      <td>9.994286e+04</td>
    </tr>
    <tr>
      <th>3492</th>
      <td>-381627.223432</td>
      <td>9.040727e+05</td>
      <td>17907</td>
      <td>-157.114416</td>
      <td>81.204893</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1514</td>
      <td>0.2990</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.998845e+05</td>
    </tr>
    <tr>
      <th>3690</th>
      <td>-299105.371262</td>
      <td>9.620754e+05</td>
      <td>17907</td>
      <td>-162.729741</td>
      <td>80.969739</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1631</td>
      <td>0.1433</td>
      <td>S3A</td>
      <td>1</td>
      <td>2.998243e+05</td>
    </tr>
    <tr>
      <th>3825</th>
      <td>-216099.960293</td>
      <td>1.019932e+06</td>
      <td>17907</td>
      <td>-168.037266</td>
      <td>80.654613</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1428</td>
      <td>0.2485</td>
      <td>S3A</td>
      <td>1</td>
      <td>4.000924e+05</td>
    </tr>
    <tr>
      <th>3990</th>
      <td>-133165.724552</td>
      <td>1.077256e+06</td>
      <td>17907</td>
      <td>-172.953091</td>
      <td>80.269255</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1102</td>
      <td>0.2677</td>
      <td>S3A</td>
      <td>1</td>
      <td>5.000264e+05</td>
    </tr>
    <tr>
      <th>4192</th>
      <td>-49760.137359</td>
      <td>1.134422e+06</td>
      <td>17907</td>
      <td>-177.488394</td>
      <td>79.819258</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.0774</td>
      <td>0.2515</td>
      <td>S3A</td>
      <td>1</td>
      <td>6.002874e+05</td>
    </tr>
    <tr>
      <th>4381</th>
      <td>33283.280733</td>
      <td>1.190861e+06</td>
      <td>17907</td>
      <td>178.399061</td>
      <td>79.317314</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.0529</td>
      <td>-0.2437</td>
      <td>S3A</td>
      <td>1</td>
      <td>6.998821e+05</td>
    </tr>
    <tr>
      <th>4565</th>
      <td>116230.866694</td>
      <td>1.246762e+06</td>
      <td>17907</td>
      <td>174.673926</td>
      <td>78.769895</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.0425</td>
      <td>0.1048</td>
      <td>S3A</td>
      <td>1</td>
      <td>7.991409e+05</td>
    </tr>
    <tr>
      <th>4655</th>
      <td>201015.684995</td>
      <td>1.303415e+06</td>
      <td>17907</td>
      <td>171.232783</td>
      <td>78.169840</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.0350</td>
      <td>0.0139</td>
      <td>S3A</td>
      <td>1</td>
      <td>9.003789e+05</td>
    </tr>
    <tr>
      <th>4772</th>
      <td>285139.888655</td>
      <td>1.359144e+06</td>
      <td>17907</td>
      <td>168.151543</td>
      <td>77.540136</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.0656</td>
      <td>0.1261</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.000618e+06</td>
    </tr>
    <tr>
      <th>4850</th>
      <td>368313.182510</td>
      <td>1.413774e+06</td>
      <td>17907</td>
      <td>165.398005</td>
      <td>76.889086</td>
      <td>20190111</td>
      <td>floe</td>
      <td>0.1252</td>
      <td>0.2662</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.099527e+06</td>
    </tr>
    <tr>
      <th>4965</th>
      <td>453033.080743</td>
      <td>1.468943e+06</td>
      <td>17907</td>
      <td>162.859844</td>
      <td>76.201280</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.1816</td>
      <td>0.2570</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.200082e+06</td>
    </tr>
    <tr>
      <th>5118</th>
      <td>537064.961105</td>
      <td>1.523191e+06</td>
      <td>17907</td>
      <td>160.577753</td>
      <td>75.498204</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.1785</td>
      <td>0.2155</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.299637e+06</td>
    </tr>
    <tr>
      <th>5273</th>
      <td>621797.087847</td>
      <td>1.577416e+06</td>
      <td>17907</td>
      <td>158.486276</td>
      <td>74.771394</td>
      <td>20190111</td>
      <td>lead</td>
      <td>0.0927</td>
      <td>0.1021</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.399844e+06</td>
    </tr>
    <tr>
      <th>5445</th>
      <td>705823.874464</td>
      <td>1.630721e+06</td>
      <td>17907</td>
      <td>156.595627</td>
      <td>74.035515</td>
      <td>20190111</td>
      <td>lead</td>
      <td>-0.0423</td>
      <td>-0.0856</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.499050e+06</td>
    </tr>
    <tr>
      <th>5607</th>
      <td>791380.428738</td>
      <td>1.684520e+06</td>
      <td>17907</td>
      <td>154.836064</td>
      <td>73.273008</td>
      <td>20190111</td>
      <td>floe</td>
      <td>-0.0745</td>
      <td>0.0633</td>
      <td>S3A</td>
      <td>1</td>
      <td>1.599899e+06</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-02c3d168-309a-410b-93cf-8155ef21879f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-02c3d168-309a-410b-93cf-8155ef21879f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-02c3d168-309a-410b-93cf-8155ef21879f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-5fc754ec-58d9-41a8-9895-1382af9d76c2">
  <button class="colab-df-quickchart" onclick="quickchart('df-5fc754ec-58d9-41a8-9895-1382af9d76c2')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-5fc754ec-58d9-41a8-9895-1382af9d76c2 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_ae3436a2-4392-4ada-a1a3-43ac7e358890">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('experts')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_ae3436a2-4392-4ada-a1a3-43ac7e358890 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('experts');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="interpolate-along-track-using-gpsat">
<h1>Interpolate along-track using GPSat<a class="headerlink" href="#interpolate-along-track-using-gpsat" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WHERE TO SAVE</span>

<span class="n">store_path</span> <span class="o">=</span> <span class="n">get_parent_path</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/AI4EO/Week 8/&quot;</span><span class="p">,</span> <span class="s2">&quot;GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5&quot;</span><span class="p">)</span>

<span class="c1">#if exists, remove before reprocessing</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">store_path</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing removing old file: </span><span class="si">{</span><span class="n">store_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span>

<span class="c1">#SET PARAMETERS OF MODEL (e.g., use data within 300 km and +/- 4 days)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;data_source&quot;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;lead&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">])</span><span class="o">&lt;</span><span class="mf">0.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]))],</span>
    <span class="s2">&quot;obs_col&quot;</span><span class="p">:</span> <span class="s2">&quot;elevation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coords_col&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span>
    <span class="c1"># selection criteria used for each local expert</span>
    <span class="s2">&quot;local_select&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="s2">&quot;y&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">100_000</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span><span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;global_select&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">45</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1">#GIVE DATAFRAME OF EXPERTS</span>
<span class="n">local_expert</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">experts</span>
<span class="p">}</span>

<span class="c1">#GIVE DATAFRAME OF PREDICTION LOCATIONS (predict at all lead and floe locations along track)</span>
<span class="n">pred_loc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;from_dataframe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;df&quot;</span><span class="p">:</span> <span class="n">df_val</span><span class="p">,</span>
    <span class="s2">&quot;max_dist&quot;</span><span class="p">:</span> <span class="mi">200_000</span>
<span class="p">}</span>


<span class="c1">#SETUP SPARSE GP MODEL (PLAY WITH MINIBATCH AND INDUCING POINTS)</span>
<span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;oi_model&quot;: &quot;GPflowSVGPModel&quot;,</span>
    <span class="s2">&quot;oi_model&quot;</span><span class="p">:</span> <span class="s2">&quot;GPflowGPRModel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;init_params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># scale (divide) coordinates</span>
        <span class="s2">&quot;coords_scale&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;minibatch_size&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;num_inducing_points&quot;</span><span class="p">:</span><span class="mi">200</span>
    <span class="p">},</span>
    <span class="s2">&quot;constraints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># lengthscales - same order coord_col (see data)</span>
        <span class="s2">&quot;lengthscales&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">],</span>
            <span class="c1"># &quot;low&quot;: [5_000, 5_000, 1e-08],</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200000</span><span class="p">,</span> <span class="mi">200000</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">10</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">locexp</span> <span class="o">=</span> <span class="n">LocalExpertOI</span><span class="p">(</span><span class="n">expert_loc_config</span><span class="o">=</span><span class="n">local_expert</span><span class="p">,</span>
                       <span class="n">data_config</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                       <span class="n">model_config</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                       <span class="n">pred_loc_config</span><span class="o">=</span><span class="n">pred_loc</span><span class="p">)</span>

<span class="c1"># run optimal interpolation</span>
<span class="n">locexp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
           <span class="n">optimise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#SMOOTH HYPERPARMETERS</span>
<span class="n">smooth_configs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lengthscales&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                  <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">),</span>
                  <span class="s2">&quot;kernel_variance&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)}</span>

<span class="n">smooth_hyperparameters</span><span class="p">(</span><span class="n">result_file</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
                       <span class="n">params_to_smooth</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lengthscales&quot;</span><span class="p">,</span> <span class="s2">&quot;kernel_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">],</span>
                       <span class="n">smooth_config_dict</span><span class="o">=</span><span class="n">smooth_configs</span><span class="p">,</span>
                       <span class="n">save_config_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># %%</span>
<span class="c1"># ---</span>
<span class="c1"># Make predictions with smoothed hyperparameters</span>
<span class="c1"># ---</span>
<span class="n">model</span><span class="p">[</span><span class="s1">&#39;load_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">store_path</span><span class="p">,</span> <span class="s2">&quot;table_suffix&quot;</span><span class="p">:</span> <span class="s2">&quot;_SMOOTHED&quot;</span><span class="p">}</span>
<span class="n">locexp</span> <span class="o">=</span> <span class="n">LocalExpertOI</span><span class="p">(</span><span class="n">expert_loc_config</span><span class="o">=</span><span class="n">local_expert</span><span class="p">,</span>
                       <span class="n">data_config</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                       <span class="n">model_config</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                       <span class="n">pred_loc_config</span><span class="o">=</span><span class="n">pred_loc</span><span class="p">)</span>

<span class="n">locexp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
           <span class="n">optimise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">table_suffix</span><span class="o">=</span><span class="s1">&#39;_SMOOTHED&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;ptrepack --chunkshape=auto --propindexes --complib=blosc &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="o">+</span><span class="s1">&#39; temp_store_3D.csv&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;rm &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;mv temp_store_3D.csv &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Removing removing old file: /content/drive/MyDrive/AI4EO/Week 8/GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5
&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.002 seconds
in json_serializable - key: &#39;data_source&#39; has value DataFrame/Series, but is too long: 27519 &gt;  100
storing as str
in json_serializable - key: &#39;df&#39; has value DataFrame/Series, but is too long: 3008 &gt;  100
storing as str
---------
storing expert locations in &#39;expert_locs&#39; table
exception occurred: &#39;No object named expert_locs in the file&#39;
will now close object
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/tables/path.py:146: NaturalNameWarning: object name is a Python keyword: &#39;class&#39;; you will not be able to use natural naming to access this object; using ``getattr()`` will still work, though
  check_attribute_name(name)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------
dropping expert locations that already exists in &#39;run_details&#39; table
exception occurred: &#39;No object named run_details in the file&#39;
will now close object

<span class=" -Color -Color-Bold">--------------------------------------------------</span>
1 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3051 -546016.208513  787076.451694  17907 -145.249909  81.414978  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3051  floe        NaN     0.0247  S3A      1               0.0  
&#39;data_select&#39;: 0.007 seconds
&#39;load&#39;: 0.007 seconds
&#39;local_data_select&#39;: 0.015 seconds
number obs: 93
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.212 seconds
&#39;get_parameters&#39;: 0.016 seconds
&#39;set_lengthscales_constraints&#39;: 0.027 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.072 seconds
&#39;optimise_parameters&#39;: 4.118 seconds
&#39;get_parameters&#39;: 0.011 seconds
parameters:
lengthscales: array([10.0000794 , 10.00000003,  1.07851957]) 
kernel_variance: 0.004832774357565874
likelihood_variance: 0.01
&#39;predict&#39;: 0.100 seconds
total run time : 5.07 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
2 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3265 -463933.092598  845738.103282  17907 -151.252849  81.354797  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3265  floe     0.1058     0.1921  S3A      1      99942.861425  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 86
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.025 seconds
&#39;optimise_parameters&#39;: 0.593 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([19.99992119, 17.24115497,  1.00426511]) 
kernel_variance: 0.002556878446184804
likelihood_variance: 0.01
&#39;predict&#39;: 0.088 seconds
total run time : 1.26 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
3 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3492 -381627.223432  904072.682038  17907 -157.114416  81.204893  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3492  floe     0.1514      0.299  S3A      1     199884.538895  
&#39;local_data_select&#39;: 0.012 seconds
number obs: 64
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.025 seconds
&#39;optimise_parameters&#39;: 0.567 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99999039,  0.93903642]) 
kernel_variance: 0.008271452044102177
likelihood_variance: 0.01
&#39;predict&#39;: 0.087 seconds
total run time : 1.24 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
4 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3690 -299105.371262  962075.386745  17907 -162.729741  80.969739  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3690  floe     0.1631     0.1433  S3A      1     299824.298116  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 86
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;set_lengthscales_constraints&#39;: 0.015 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.025 seconds
&#39;optimise_parameters&#39;: 0.744 seconds
&#39;get_parameters&#39;: 0.009 seconds
parameters:
lengthscales: array([20.        , 19.99970279,  1.00473908]) 
kernel_variance: 0.007932341693216844
likelihood_variance: 0.01
&#39;predict&#39;: 0.119 seconds
total run time : 1.55 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
5 / 17
current local expert:
                  x             y      t         lon        lat      date  \
3825 -216099.960293  1.019932e+06  17907 -168.037266  80.654613  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3825  floe     0.1428     0.2485  S3A      1     400092.433493  
&#39;local_data_select&#39;: 0.017 seconds
number obs: 158
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.057 seconds
&#39;set_lengthscales_constraints&#39;: 0.022 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.041 seconds
&#39;optimise_parameters&#39;: 1.018 seconds
&#39;get_parameters&#39;: 0.009 seconds
parameters:
lengthscales: array([19.99996977, 15.22688103,  1.00910276]) 
kernel_variance: 0.0038242584251263973
likelihood_variance: 0.01
&#39;predict&#39;: 0.142 seconds
total run time : 1.93 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
6 / 17
current local expert:
                  x             y      t         lon        lat      date  \
3990 -133165.724552  1.077256e+06  17907 -172.953091  80.269255  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3990  floe     0.1102     0.2677  S3A      1      500026.35979  
&#39;local_data_select&#39;: 0.014 seconds
number obs: 160
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.070 seconds
&#39;set_lengthscales_constraints&#39;: 0.021 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.040 seconds
**********
optimization failed!
&#39;optimise_parameters&#39;: 0.986 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([19.99999981, 15.02754791,  1.01162574]) 
kernel_variance: 0.00448558064733694
likelihood_variance: 0.010000000000000005
&#39;predict&#39;: 0.099 seconds
total run time : 1.73 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
7 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4192 -49760.137359  1.134422e+06  17907 -177.488394  79.819258  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4192  floe     0.0774     0.2515  S3A      1     600287.353674  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 102
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 0.639 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99996906,  0.99371725]) 
kernel_variance: 0.005588960596841969
likelihood_variance: 0.01
&#39;predict&#39;: 0.096 seconds
total run time : 1.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
8 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4381  33283.280733  1.190861e+06  17907  178.399061  79.317314  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4381  floe     0.0529    -0.2437  S3A      1      699882.11203  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 192
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 0.727 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 20.        ,  1.08365537]) 
kernel_variance: 0.0013204097868571736
likelihood_variance: 0.01
&#39;predict&#39;: 0.106 seconds
total run time : 1.42 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
9 / 17
current local expert:
                  x             y      t         lon        lat      date  \
4565  116230.866694  1.246762e+06  17907  174.673926  78.769895  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4565  floe     0.0425     0.1048  S3A      1     799140.878717  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 142
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 0.645 seconds
&#39;get_parameters&#39;: 0.007 seconds
parameters:
lengthscales: array([10.00000174, 10.00010324,  1.07749607]) 
kernel_variance: 0.0014502635084760278
likelihood_variance: 0.01
&#39;predict&#39;: 0.090 seconds
total run time : 1.32 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
10 / 17
current local expert:
                  x             y      t         lon       lat      date  \
4655  201015.684995  1.303415e+06  17907  171.232783  78.16984  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4655  lead      0.035     0.0139  S3A      1     900378.903734  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 120
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 0.618 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99927068,  0.98655156]) 
kernel_variance: 0.0016322749654441528
likelihood_variance: 0.01
&#39;predict&#39;: 0.085 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
total run time : 1.80 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
11 / 17
current local expert:
                  x             y      t         lon        lat      date  \
4772  285139.888655  1.359144e+06  17907  168.151543  77.540136  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4772  lead     0.0656     0.1261  S3A      1      1.000618e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 137
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 0.800 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99903279,  1.00875065]) 
kernel_variance: 0.003878634010503833
likelihood_variance: 0.01
&#39;predict&#39;: 0.084 seconds
total run time : 1.46 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
12 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4850  368313.18251  1.413774e+06  17907  165.398005  76.889086  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4850  floe     0.1252     0.2662  S3A      1      1.099527e+06  
&#39;local_data_select&#39;: 0.011 seconds
number obs: 272
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.025 seconds
&#39;optimise_parameters&#39;: 1.310 seconds
&#39;get_parameters&#39;: 0.007 seconds
parameters:
lengthscales: array([14.71264191, 14.90425739,  1.00434004]) 
kernel_variance: 0.008910754210994321
likelihood_variance: 0.01
&#39;predict&#39;: 0.106 seconds
total run time : 2.12 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
13 / 17
current local expert:
                  x             y      t         lon       lat      date  \
4965  453033.080743  1.468943e+06  17907  162.859844  76.20128  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4965  lead     0.1816      0.257  S3A      1      1.200082e+06  
&#39;local_data_select&#39;: 0.014 seconds
number obs: 252
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.055 seconds
&#39;set_lengthscales_constraints&#39;: 0.020 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
&#39;optimise_parameters&#39;: 1.617 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([20.        , 19.99958833,  0.98325741]) 
kernel_variance: 0.013224512337402605
likelihood_variance: 0.01
&#39;predict&#39;: 0.165 seconds
total run time : 2.55 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
14 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5118  537064.961105  1.523191e+06  17907  160.577753  75.498204  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5118  lead     0.1785     0.2155  S3A      1      1.299637e+06  
&#39;local_data_select&#39;: 0.020 seconds
number obs: 285
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.054 seconds
&#39;set_lengthscales_constraints&#39;: 0.019 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.035 seconds
&#39;optimise_parameters&#39;: 1.430 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99993393,  1.13152018]) 
kernel_variance: 0.010721445475129453
likelihood_variance: 0.01
&#39;predict&#39;: 0.132 seconds
total run time : 2.18 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
15 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5273  621797.087847  1.577416e+06  17907  158.486276  74.771394  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5273  lead     0.0927     0.1021  S3A      1      1.399844e+06  
&#39;local_data_select&#39;: 0.009 seconds
number obs: 312
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.035 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 1.500 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99999999,  1.17321952]) 
kernel_variance: 0.019124913039713382
likelihood_variance: 0.01
&#39;predict&#39;: 0.124 seconds
total run time : 2.20 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
16 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5445  705823.874464  1.630721e+06  17907  156.595627  74.035515  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5445  lead    -0.0423    -0.0856  S3A      1      1.499050e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 280
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.049 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 1.418 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([18.89607394, 10.22109253,  0.99150766]) 
kernel_variance: 0.008567747482027816
likelihood_variance: 0.010000000000000002
&#39;predict&#39;: 0.121 seconds
total run time : 2.15 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
17 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5607  791380.428738  1.684520e+06  17907  154.836064  73.273008  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5607  floe    -0.0745     0.0633  S3A      1      1.599899e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 380
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;set_lengthscales_constraints&#39;: 0.015 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.027 seconds
&#39;optimise_parameters&#39;: 2.012 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 19.99868113,  1.03980256]) 
kernel_variance: 0.00474309536614913
likelihood_variance: 0.01
&#39;predict&#39;: 0.154 seconds
total run time : 2.76 seconds
storing any remaining tables
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
&#39;run&#39;: 34.786 seconds
found model_name: GPflowGPRModel
setting lengthscales to: [1.]
&#39;__init__&#39;: 0.037 seconds
reading in results
selecting only tables: [&#39;lengthscales&#39;, &#39;kernel_variance&#39;, &#39;likelihood_variance&#39;]
&#39;data_select&#39;: 0.001 seconds
&#39;load&#39;: 0.001 seconds
expert_locations data will not be merged on results data
adding smoothed table: lengthscales_SMOOTHED
adding smoothed table: kernel_variance_SMOOTHED
adding smoothed table: likelihood_variance_SMOOTHED
writing (smoothed) hyper parameters to:
/content/drive/MyDrive/AI4EO/Week 8/GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5
table_suffix:_SMOOTHED
<span class=" -Color -Color-Bold">writing: lengthscales_SMOOTHED to table</span>
<span class=" -Color -Color-Bold">writing: kernel_variance_SMOOTHED to table</span>
<span class=" -Color -Color-Bold">writing: likelihood_variance_SMOOTHED to table</span>
&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.000 seconds
in json_serializable - key: &#39;data_source&#39; has value DataFrame/Series, but is too long: 27519 &gt;  100
storing as str
in json_serializable - key: &#39;df&#39; has value DataFrame/Series, but is too long: 3008 &gt;  100
storing as str
---------
storing expert locations in &#39;expert_locs&#39; table
exception occurred: &#39;No object named expert_locs_SMOOTHED in the file&#39;
will now close object
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/local/lib/python3.11/dist-packages/tables/path.py:146: NaturalNameWarning: object name is a Python keyword: &#39;class&#39;; you will not be able to use natural naming to access this object; using ``getattr()`` will still work, though
  check_attribute_name(name)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>---------
dropping expert locations that already exists in &#39;run_details&#39; table
exception occurred: &#39;No object named run_details_SMOOTHED in the file&#39;
will now close object

<span class=" -Color -Color-Bold">--------------------------------------------------</span>
1 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3051 -546016.208513  787076.451694  17907 -145.249909  81.414978  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3051  floe        NaN     0.0247  S3A      1               0.0  
&#39;data_select&#39;: 0.003 seconds
&#39;load&#39;: 0.003 seconds
&#39;local_data_select&#39;: 0.012 seconds
number obs: 93
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;get_parameters&#39;: 0.008 seconds
&#39;_read_params_from_file&#39;: 0.116 seconds
&#39;set_parameters&#39;: 0.016 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.035 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.007 seconds
parameters:
lengthscales: array([11.32961738, 11.3295908 ,  1.01639504]) 
kernel_variance: 0.005135586308331684
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.084 seconds
total run time : 0.87 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
2 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3265 -463933.092598  845738.103282  17907 -151.252849  81.354797  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3265  floe     0.1058     0.1921  S3A      1      99942.861425  
&#39;local_data_select&#39;: 0.014 seconds
number obs: 86
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.052 seconds
&#39;_read_params_from_file&#39;: 0.149 seconds
&#39;set_parameters&#39;: 0.017 seconds
&#39;set_lengthscales_constraints&#39;: 0.015 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.053 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.010 seconds
parameters:
lengthscales: array([11.54324263, 11.5432246 ,  1.00717565]) 
kernel_variance: 0.005411830869837097
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.136 seconds
total run time : 1.06 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
3 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3492 -381627.223432  904072.682038  17907 -157.114416  81.204893  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3492  floe     0.1514      0.299  S3A      1     199884.538895  
&#39;local_data_select&#39;: 0.014 seconds
number obs: 64
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.056 seconds
&#39;_read_params_from_file&#39;: 0.159 seconds
&#39;set_parameters&#39;: 0.017 seconds
&#39;set_lengthscales_constraints&#39;: 0.016 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.054 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.009 seconds
parameters:
lengthscales: array([11.72605551, 11.72604505,  1.00151642]) 
kernel_variance: 0.005585139674041097
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.133 seconds
total run time : 1.05 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
4 / 17
current local expert:
                  x              y      t         lon        lat      date  \
3690 -299105.371262  962075.386745  17907 -162.729741  80.969739  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3690  floe     0.1631     0.1433  S3A      1     299824.298116  
&#39;local_data_select&#39;: 0.015 seconds
number obs: 86
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.054 seconds
&#39;_read_params_from_file&#39;: 0.142 seconds
&#39;set_parameters&#39;: 0.017 seconds
&#39;set_lengthscales_constraints&#39;: 0.016 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.057 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.010 seconds
parameters:
lengthscales: array([11.84934071, 11.84933631,  1.00118652]) 
kernel_variance: 0.0055162988770332015
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.155 seconds
total run time : 1.11 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
5 / 17
current local expert:
                  x             y      t         lon        lat      date  \
3825 -216099.960293  1.019932e+06  17907 -168.037266  80.654613  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3825  floe     0.1428     0.2485  S3A      1     400092.433493  
&#39;local_data_select&#39;: 0.016 seconds
number obs: 158
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.059 seconds
&#39;_read_params_from_file&#39;: 0.153 seconds
&#39;set_parameters&#39;: 0.017 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.89321679, 11.89321734,  1.00634559]) 
kernel_variance: 0.005139869998580747
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.094 seconds
total run time : 0.88 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
6 / 17
current local expert:
                  x             y      t         lon        lat      date  \
3990 -133165.724552  1.077256e+06  17907 -172.953091  80.269255  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
3990  floe     0.1102     0.2677  S3A      1      500026.35979  
&#39;local_data_select&#39;: 0.009 seconds
number obs: 160
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;_read_params_from_file&#39;: 0.111 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.038 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.85384793, 11.85385266,  1.01518323]) 
kernel_variance: 0.004528588641525287
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.098 seconds
total run time : 0.81 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
7 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4192 -49760.137359  1.134422e+06  17907 -177.488394  79.819258  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4192  floe     0.0774     0.2515  S3A      1     600287.353674  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 102
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;_read_params_from_file&#39;: 0.107 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.75241246, 11.75241156,  1.02450266]) 
kernel_variance: 0.0038610420346922086
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.088 seconds
total run time : 0.79 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
8 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4381  33283.280733  1.190861e+06  17907  178.399061  79.317314  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4381  floe     0.0529    -0.2437  S3A      1      699882.11203  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 192
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.047 seconds
&#39;_read_params_from_file&#39;: 0.110 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.040 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.64442943, 11.64433581,  1.03035358]) 
kernel_variance: 0.003409986153195546
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.096 seconds
total run time : 0.82 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
9 / 17
current local expert:
                  x             y      t         lon        lat      date  \
4565  116230.866694  1.246762e+06  17907  174.673926  78.769895  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4565  floe     0.0425     0.1048  S3A      1     799140.878717  
&#39;local_data_select&#39;: 0.009 seconds
number obs: 142
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;_read_params_from_file&#39;: 0.109 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.037 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.59793192, 11.59721805,  1.03054761]) 
kernel_variance: 0.003488893737652303
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.098 seconds
total run time : 0.79 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
10 / 17
current local expert:
                  x             y      t         lon       lat      date  \
4655  201015.684995  1.303415e+06  17907  171.232783  78.16984  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4655  lead      0.035     0.0139  S3A      1     900378.903734  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 120
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.037 seconds
&#39;_read_params_from_file&#39;: 0.117 seconds
&#39;set_parameters&#39;: 0.014 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.037 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.64717899, 11.64332307,  1.02702952]) 
kernel_variance: 0.00436467254608604
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.106 seconds
SAVING RESULTS TO TABLES:
run_details
preds
total run time : 0.96 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
11 / 17
current local expert:
                  x             y      t         lon        lat      date  \
4772  285139.888655  1.359144e+06  17907  168.151543  77.540136  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4772  lead     0.0656     0.1261  S3A      1      1.000618e+06  
&#39;local_data_select&#39;: 0.011 seconds
number obs: 137
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;_read_params_from_file&#39;: 0.115 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.75993639, 11.74439734,  1.02589767]) 
kernel_variance: 0.006002175330962928
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.086 seconds
total run time : 0.81 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
12 / 17
current local expert:
                 x             y      t         lon        lat      date  \
4850  368313.18251  1.413774e+06  17907  165.398005  76.889086  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4850  floe     0.1252     0.2662  S3A      1      1.099527e+06  
&#39;local_data_select&#39;: 0.009 seconds
number obs: 272
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;_read_params_from_file&#39;: 0.109 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.038 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.87181547, 11.82402013,  1.0322075 ]) 
kernel_variance: 0.00800769076062283
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.113 seconds
total run time : 0.82 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
13 / 17
current local expert:
                  x             y      t         lon       lat      date  \
4965  453033.080743  1.468943e+06  17907  162.859844  76.20128  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
4965  lead     0.1816      0.257  S3A      1      1.200082e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 252
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;_read_params_from_file&#39;: 0.113 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.037 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.94705505, 11.83017546,  1.04558409]) 
kernel_variance: 0.009863005236674471
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.101 seconds
total run time : 0.82 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
14 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5118  537064.961105  1.523191e+06  17907  160.577753  75.498204  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5118  lead     0.1785     0.2155  S3A      1      1.299637e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 285
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.038 seconds
&#39;_read_params_from_file&#39;: 0.123 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.037 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.98250216, 11.75812554,  1.05926313]) 
kernel_variance: 0.01100614176380566
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.112 seconds
total run time : 0.84 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
15 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5273  621797.087847  1.577416e+06  17907  158.486276  74.771394  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5273  lead     0.0927     0.1021  S3A      1      1.399844e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 312
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.108 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.99534113, 11.6448036 ,  1.06657488]) 
kernel_variance: 0.011255931676787352
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.128 seconds
total run time : 0.84 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
16 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5445  705823.874464  1.630721e+06  17907  156.595627  74.035515  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5445  lead    -0.0423    -0.0856  S3A      1      1.499050e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 280
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.115 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.039 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.007 seconds
parameters:
lengthscales: array([11.99894263, 11.54102127,  1.06561341]) 
kernel_variance: 0.010762843822384597
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.117 seconds
total run time : 0.86 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
17 / 17
current local expert:
                  x             y      t         lon        lat      date  \
5607  791380.428738  1.684520e+06  17907  154.836064  73.273008  20190111   

     class  interpSLA  elevation  SAT  track  dist_along_track  
5607  floe    -0.0745     0.0633  S3A      1      1.599899e+06  
&#39;local_data_select&#39;: 0.010 seconds
number obs: 380
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;_read_params_from_file&#39;: 0.142 seconds
&#39;set_parameters&#39;: 0.023 seconds
&#39;set_lengthscales_constraints&#39;: 0.017 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.061 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.012 seconds
parameters:
lengthscales: array([11.99979603, 11.47727759,  1.05922198]) 
kernel_variance: 0.00984363194984507
likelihood_variance: 0.019999999999999987
&#39;predict&#39;: 0.207 seconds
total run time : 1.16 seconds
storing any remaining tables
SAVING RESULTS TO TABLES:
run_details
preds
&#39;run&#39;: 15.722 seconds
Done!
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract, store in dict</span>
<span class="n">store_path</span> <span class="o">=</span> <span class="s2">&quot;/content/drive/MyDrive/AI4EO/Week 8/GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5&quot;</span>
<span class="n">dfs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">GPSat</span><span class="o">.</span><span class="n">local_experts</span><span class="o">.</span><span class="n">get_results_from_h5file</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reading in results
getting all tables
merging on expert location data
table: &#39;oi_config&#39; does not have all coords_col: [&#39;x&#39;, &#39;y&#39;, &#39;t&#39;] in columns, not merging on expert_locations
table: &#39;oi_config_SMOOTHED&#39; does not have all coords_col: [&#39;x&#39;, &#39;y&#39;, &#39;t&#39;] in columns, not merging on expert_locations
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;preds_SMOOTHED&quot;</span><span class="p">]</span>

<span class="n">preds_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-31caaecc-664d-4e35-953f-749a7c496ec0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>_dim_0</th>
      <th>f*</th>
      <th>f*_var</th>
      <th>y_var</th>
      <th>f_bar</th>
      <th>pred_loc_x</th>
      <th>pred_loc_y</th>
      <th>pred_loc_t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>class</th>
      <th>interpSLA</th>
      <th>elevation</th>
      <th>SAT</th>
      <th>track</th>
      <th>dist_along_track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>0</td>
      <td>0.018357</td>
      <td>0.000767</td>
      <td>0.020767</td>
      <td>0</td>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>1</td>
      <td>0.018514</td>
      <td>0.000766</td>
      <td>0.020766</td>
      <td>0</td>
      <td>-545744.788692</td>
      <td>787271.231607</td>
      <td>17907.0</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>2</td>
      <td>0.018674</td>
      <td>0.000765</td>
      <td>0.020765</td>
      <td>0</td>
      <td>-545473.353742</td>
      <td>787466.002222</td>
      <td>17907.0</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>3</td>
      <td>0.018836</td>
      <td>0.000764</td>
      <td>0.020764</td>
      <td>0</td>
      <td>-545201.932777</td>
      <td>787660.770465</td>
      <td>17907.0</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-546016.208513</td>
      <td>787076.451694</td>
      <td>17907.0</td>
      <td>4</td>
      <td>0.019002</td>
      <td>0.000763</td>
      <td>0.020763</td>
      <td>0</td>
      <td>-544930.498775</td>
      <td>787855.541507</td>
      <td>17907.0</td>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>20190111</td>
      <td>floe</td>
      <td>NaN</td>
      <td>0.0247</td>
      <td>S3A</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-31caaecc-664d-4e35-953f-749a7c496ec0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-31caaecc-664d-4e35-953f-749a7c496ec0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-31caaecc-664d-4e35-953f-749a7c496ec0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2d812769-4c33-490f-ac38-9d5ceda15400">
  <button class="colab-df-quickchart" onclick="quickchart('df-2d812769-4c33-490f-ac38-9d5ceda15400')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2d812769-4c33-490f-ac38-9d5ceda15400 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # multiple local experts may make predictions at the same prediction location (pred_loc).</span>
<span class="c1"># # - for each prediction at a given location, take we weighted combination</span>
<span class="c1"># # - weights being a function of the distance to each local expert that made a prediction at a given location.</span>

<span class="n">inference_radius</span> <span class="o">=</span> <span class="mi">200_000</span>  <span class="c1"># 200km</span>
<span class="n">plt_data</span> <span class="o">=</span> <span class="n">glue_local_predictions_2d</span><span class="p">(</span><span class="n">preds_df</span><span class="o">=</span><span class="n">preds_data</span><span class="p">,</span>
                                     <span class="n">pred_loc_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred_loc_x&quot;</span><span class="p">,</span> <span class="s2">&quot;pred_loc_y&quot;</span><span class="p">],</span>
                                     <span class="n">xprt_loc_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
                                     <span class="n">vars_to_glue</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f*&quot;</span><span class="p">,</span> <span class="s2">&quot;f*_var&quot;</span><span class="p">],</span>
                                     <span class="n">inference_radius</span><span class="o">=</span><span class="n">inference_radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e2b7a18a-5b8d-4e7e-a98c-b14059ef9792" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred_loc_x</th>
      <th>pred_loc_y</th>
      <th>f*</th>
      <th>f*_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-546016.208513</td>
      <td>7.870765e+05</td>
      <td>0.024181</td>
      <td>0.001017</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-545744.788692</td>
      <td>7.872712e+05</td>
      <td>0.024373</td>
      <td>0.001016</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-545473.353742</td>
      <td>7.874660e+05</td>
      <td>0.024568</td>
      <td>0.001014</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-545201.932777</td>
      <td>7.876608e+05</td>
      <td>0.024766</td>
      <td>0.001012</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-544930.498775</td>
      <td>7.878555e+05</td>
      <td>0.024966</td>
      <td>0.001010</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2977</th>
      <td>955257.667849</td>
      <td>1.786233e+06</td>
      <td>0.014693</td>
      <td>0.006477</td>
    </tr>
    <tr>
      <th>2978</th>
      <td>955539.129893</td>
      <td>1.786406e+06</td>
      <td>0.014685</td>
      <td>0.006495</td>
    </tr>
    <tr>
      <th>2979</th>
      <td>955820.569170</td>
      <td>1.786580e+06</td>
      <td>0.014676</td>
      <td>0.006513</td>
    </tr>
    <tr>
      <th>2980</th>
      <td>956664.886400</td>
      <td>1.787099e+06</td>
      <td>0.014649</td>
      <td>0.006567</td>
    </tr>
    <tr>
      <th>2981</th>
      <td>956946.352964</td>
      <td>1.787272e+06</td>
      <td>0.014640</td>
      <td>0.006585</td>
    </tr>
  </tbody>
</table>
<p>2982 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e2b7a18a-5b8d-4e7e-a98c-b14059ef9792')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e2b7a18a-5b8d-4e7e-a98c-b14059ef9792 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e2b7a18a-5b8d-4e7e-a98c-b14059ef9792');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-19da7bb0-e120-429c-8aa6-321bb78fb0eb">
  <button class="colab-df-quickchart" onclick="quickchart('df-19da7bb0-e120-429c-8aa6-321bb78fb0eb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-19da7bb0-e120-429c-8aa6-321bb78fb0eb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_ca627d3b-57b0-4271-ad41-734dad2b83d2">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('plt_data')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_ca627d3b-57b0-4271-ad41-734dad2b83d2 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('plt_data');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#merge the two datasets containing SLA predictions and additional variables of interest</span>
<span class="n">sla_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_val</span><span class="p">[[</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;interpSLA&#39;</span><span class="p">,</span> <span class="s1">&#39;dist_along_track&#39;</span><span class="p">,</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span> <span class="s1">&#39;elevation&#39;</span><span class="p">]],</span> <span class="n">plt_data</span><span class="p">[[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">,</span> <span class="s1">&#39;pred_loc_y&#39;</span><span class="p">,</span> <span class="s1">&#39;f*&#39;</span><span class="p">]],</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">,</span> <span class="s1">&#39;pred_loc_y&#39;</span><span class="p">])</span>
<span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;sla_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">]</span>
<span class="n">sla_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-e09391e2-5231-451e-b0bf-33b0879372d5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>lon</th>
      <th>lat</th>
      <th>x</th>
      <th>y</th>
      <th>interpSLA</th>
      <th>dist_along_track</th>
      <th>class</th>
      <th>elevation</th>
      <th>pred_loc_x</th>
      <th>pred_loc_y</th>
      <th>f*</th>
      <th>sla_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-145.249909</td>
      <td>81.414978</td>
      <td>-546016.208513</td>
      <td>7.870765e+05</td>
      <td>NaN</td>
      <td>0.000000e+00</td>
      <td>floe</td>
      <td>0.0247</td>
      <td>-546016.208513</td>
      <td>7.870765e+05</td>
      <td>0.024181</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-145.269889</td>
      <td>81.414930</td>
      <td>-545744.788692</td>
      <td>7.872712e+05</td>
      <td>NaN</td>
      <td>3.309358e+02</td>
      <td>floe</td>
      <td>0.1204</td>
      <td>-545744.788692</td>
      <td>7.872712e+05</td>
      <td>0.024373</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-145.289868</td>
      <td>81.414880</td>
      <td>-545473.353742</td>
      <td>7.874660e+05</td>
      <td>NaN</td>
      <td>6.618785e+02</td>
      <td>floe</td>
      <td>0.2833</td>
      <td>-545473.353742</td>
      <td>7.874660e+05</td>
      <td>0.024568</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-145.309847</td>
      <td>81.414830</td>
      <td>-545201.932777</td>
      <td>7.876608e+05</td>
      <td>NaN</td>
      <td>9.928085e+02</td>
      <td>floe</td>
      <td>0.2403</td>
      <td>-545201.932777</td>
      <td>7.876608e+05</td>
      <td>0.024766</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-145.329826</td>
      <td>81.414779</td>
      <td>-544930.498775</td>
      <td>7.878555e+05</td>
      <td>NaN</td>
      <td>1.323751e+03</td>
      <td>floe</td>
      <td>0.1529</td>
      <td>-544930.498775</td>
      <td>7.878555e+05</td>
      <td>0.024966</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2977</th>
      <td>151.862624</td>
      <td>71.781861</td>
      <td>955257.667849</td>
      <td>1.786233e+06</td>
      <td>-0.0407</td>
      <td>1.792640e+06</td>
      <td>lead</td>
      <td>-0.0409</td>
      <td>955257.667849</td>
      <td>1.786233e+06</td>
      <td>0.014693</td>
      <td>-0.055393</td>
    </tr>
    <tr>
      <th>2978</th>
      <td>151.857915</td>
      <td>71.779270</td>
      <td>955539.129893</td>
      <td>1.786406e+06</td>
      <td>-0.0408</td>
      <td>1.792970e+06</td>
      <td>lead</td>
      <td>-0.0611</td>
      <td>955539.129893</td>
      <td>1.786406e+06</td>
      <td>0.014685</td>
      <td>-0.055485</td>
    </tr>
    <tr>
      <th>2979</th>
      <td>151.853207</td>
      <td>71.776679</td>
      <td>955820.569170</td>
      <td>1.786580e+06</td>
      <td>-0.0410</td>
      <td>1.793301e+06</td>
      <td>lead</td>
      <td>-0.0716</td>
      <td>955820.569170</td>
      <td>1.786580e+06</td>
      <td>0.014676</td>
      <td>-0.055676</td>
    </tr>
    <tr>
      <th>2980</th>
      <td>151.839091</td>
      <td>71.768906</td>
      <td>956664.886400</td>
      <td>1.787099e+06</td>
      <td>-0.0413</td>
      <td>1.794292e+06</td>
      <td>lead</td>
      <td>-0.0373</td>
      <td>956664.886400</td>
      <td>1.787099e+06</td>
      <td>0.014649</td>
      <td>-0.055949</td>
    </tr>
    <tr>
      <th>2981</th>
      <td>151.834387</td>
      <td>71.766314</td>
      <td>956946.352964</td>
      <td>1.787272e+06</td>
      <td>-0.0413</td>
      <td>1.794623e+06</td>
      <td>lead</td>
      <td>-0.0284</td>
      <td>956946.352964</td>
      <td>1.787272e+06</td>
      <td>0.014640</td>
      <td>-0.055940</td>
    </tr>
  </tbody>
</table>
<p>2982 rows × 12 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e09391e2-5231-451e-b0bf-33b0879372d5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e09391e2-5231-451e-b0bf-33b0879372d5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e09391e2-5231-451e-b0bf-33b0879372d5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-6bb86c8d-8074-4803-88bd-2e6f09eb76d4">
  <button class="colab-df-quickchart" onclick="quickchart('df-6bb86c8d-8074-4803-88bd-2e6f09eb76d4')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-6bb86c8d-8074-4803-88bd-2e6f09eb76d4 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_38f9ae3d-46e5-49c8-88fb-51553a8e57ff">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('sla_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_38f9ae3d-46e5-49c8-88fb-51553a8e57ff button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('sla_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leads_df</span> <span class="o">=</span> <span class="n">sla_df</span><span class="p">[</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lead&#39;</span><span class="p">]</span>
<span class="n">floes_df</span> <span class="o">=</span> <span class="n">sla_df</span><span class="p">[</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;floe&#39;</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">leads_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="n">leads_df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;leads&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">floes_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="n">floes_df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;floes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GPSat interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;SLA (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance along track (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/69c8b3083ca899e395adea970596bae9b6b447bfa6e483d33433a323dec06e63.png" src="_images/69c8b3083ca899e395adea970596bae9b6b447bfa6e483d33433a323dec06e63.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Map the linear SLA, GPsat SLA and the difference</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">lin_sla</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Linear interp SLA&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">lin_sla</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SLA (m)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">gp_sla</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;GPSat interp SLA&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">gp_sla</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SLA (m)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">sla_diff</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;sla_diff&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference: Linear - GPSat&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sla_diff</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Difference in SLA (m)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">extend</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">71</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
<span class="n">distot</span> <span class="o">=</span> <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Distance along track&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">distot</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Distance (km)&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/eaf6d0902049ecb099d94a30ae7e79a020d6f7c229805a4263dfefb4146e5a64.png" src="_images/eaf6d0902049ecb099d94a30ae7e79a020d6f7c229805a4263dfefb4146e5a64.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the difference in SLA</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;dist_along_track&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span><span class="p">,</span> <span class="n">sla_df</span><span class="p">[</span><span class="s1">&#39;sla_diff&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Distance along track (km)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Difference in SLA (m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Difference in SLA between linear and GPSat interpolation&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c4f7fe1a81dcf21e4064db88b96e711fcfb96ed38c82aa6fdbac539a1c64f987.png" src="_images/c4f7fe1a81dcf21e4064db88b96e711fcfb96ed38c82aa6fdbac539a1c64f987.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter_2_Intro_to_GPSat.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to GPSat</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter_2_SLA_GPSat_William.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Interpolation of Sea Level Anomaly using GPSat</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">GPSat Along-Track Interpolation</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-gpsat">Import GPSat</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-profile-for-interpolation">Select profile for interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-expert-locations-at-200-km">Generate expert locations at 200 km</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-along-track-using-gpsat">Interpolate along-track using GPSat</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michel Tsamados/Weibin Chen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>