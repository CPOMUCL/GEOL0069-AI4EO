

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Interpolation of Sea Level Anomaly using GPSat &#8212; GEOL0069 Guide Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter_2_SLA_GPSat_William';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Along track interpolation" href="Chapter_2_GPSat_along_track-2.html" />
    <link rel="prev" title="Introduction to GPSat" href="Chapter_2_Intro_to_GPSat.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to GEOL0069 AI for Earth Observation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3APreparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AIRIS.html">Introduction to Intelligently Reinforced Image Segmentation (IRIS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AML.html">Introduction to AI/Machine Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3ASea-ice_and_Lead_Classification.html">Sea-ice and Lead Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AAI_Algorithms.html">AI/Machine Learning Implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AFetching_Data.html">Data Fetching</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3Arollout.html">Roll-out on a Full Image</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3AData_Colocating_S2_S3.html">Colocating Sentinel-3 OLCI and Sentinal-2 Optical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3AUnsupervised_Learning_Methods.html">Unsupervised Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3ARegression.html">Regression Techniques for Predictive Analysis</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chapter1%3AAligning_Images.html">Aligning Sentinel-2 and Sentinel-3 OLCI Data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3AColocating_data.html">Colocate Sentinel-2 and Sentinel-3 Imagery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3ARegression_Part2.html">Application of Regression Techniques in Satellite Imagery Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="References1.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter2_IntrotoGaussianProcesses.html">Introduction to Gaussian Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_2_Intro_to_GPSat.html">Introduction to GPSat</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Interpolation of Sea Level Anomaly using GPSat</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_2_GPSat_along_track-2.html">Along track interpolation</a></li>




</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Chapter_2_SLA_GPSat_William.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Interpolation of Sea Level Anomaly using GPSat</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fetching-data">Fetching data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-product-selection">Step 1: Product Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-defining-the-region-of-interest">Step 2: Defining the Region of Interest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-initiating-the-search">Step 3: Initiating the Search</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sla-interpolation">SLA Interpolation</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="interpolation-of-sea-level-anomaly-using-gpsat">
<h1>Interpolation of Sea Level Anomaly using GPSat<a class="headerlink" href="#interpolation-of-sea-level-anomaly-using-gpsat" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
<section id="fetching-data">
<h2>Fetching data<a class="headerlink" href="#fetching-data" title="Permalink to this heading">#</a></h2>
<p>In week 4, we’ve introduced the method to fetch different types of data from the Google Earth Engine and Copernicus Dataspace. The data we are going to use in this week’s content is teh altimetry data. Therefore, we will use Copernicus Dataspace API instead of Google Earth Engine. Let’s fetch this data and recall some of the procedures.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>cartopy
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting cartopy
  Downloading Cartopy-0.22.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (11.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">11.8/11.8 MB</span> <span class=" -Color -Color-Red">38.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: numpy&gt;=1.21 in /usr/local/lib/python3.10/dist-packages (from cartopy) (1.25.2)
Requirement already satisfied: matplotlib&gt;=3.4 in /usr/local/lib/python3.10/dist-packages (from cartopy) (3.7.1)
Requirement already satisfied: shapely&gt;=1.7 in /usr/local/lib/python3.10/dist-packages (from cartopy) (2.0.3)
Requirement already satisfied: packaging&gt;=20 in /usr/local/lib/python3.10/dist-packages (from cartopy) (23.2)
Requirement already satisfied: pyshp&gt;=2.1 in /usr/local/lib/python3.10/dist-packages (from cartopy) (2.3.1)
Requirement already satisfied: pyproj&gt;=3.1.0 in /usr/local/lib/python3.10/dist-packages (from cartopy) (3.6.1)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (1.4.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (3.1.1)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.4-&gt;cartopy) (2.8.2)
Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from pyproj&gt;=3.1.0-&gt;cartopy) (2024.2.2)
Requirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=3.4-&gt;cartopy) (1.16.0)
Installing collected packages: cartopy
Successfully installed cartopy-0.22.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">date</span>
<span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">get_access_token</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain an access token to the Copernicus Data Space Ecosystem.</span>
<span class="sd">    Necessary for the download of hosted products.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span>  <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;curl --location --request POST &#39;https://identity.dataspace.copernicus.eu/auth/realms/CDSE/protocol/openid-connect/token&#39; </span><span class="se">\</span>
<span class="s2">            --header &#39;Content-Type: application/x-www-form-urlencoded&#39; </span><span class="se">\</span>
<span class="s2">            --data-urlencode &#39;grant_type=password&#39; </span><span class="se">\</span>
<span class="s2">            --data-urlencode &#39;username=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">            --data-urlencode &#39;password=</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">            --data-urlencode &#39;client_id=cdse-public&#39;&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">access_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">access_dict</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">],</span> <span class="n">access_dict</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span>

<span class="c1">#=============================================================================================================================================================#</span>

<span class="k">def</span> <span class="nf">get_new_access_token</span><span class="p">(</span><span class="n">refresh_token</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain a new access token to the Copernicus Data Space Ecosystem using a previously provided refesh token.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span>  <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;curl --location --request POST &#39;https://identity.dataspace.copernicus.eu/auth/realms/CDSE/protocol/openid-connect/token&#39; </span><span class="se">\</span>
<span class="s2">    --header &#39;Content-Type: application/x-www-form-urlencoded&#39; </span><span class="se">\</span>
<span class="s2">    --data-urlencode &#39;grant_type=refresh_token&#39; </span><span class="se">\</span>
<span class="s2">    --data-urlencode &#39;refresh_token=</span><span class="si">{</span><span class="n">refresh_token</span><span class="si">}</span><span class="s2">&#39; </span><span class="se">\</span>
<span class="s2">    --data-urlencode &#39;client_id=cdse-public&#39;&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">access_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">access_dict</span><span class="p">[</span><span class="s1">&#39;access_token&#39;</span><span class="p">],</span> <span class="n">access_dict</span><span class="p">[</span><span class="s1">&#39;refresh_token&#39;</span><span class="p">]</span>

<span class="c1">#=============================================================================================================================================================#</span>

<span class="k">def</span> <span class="nf">get_S3_products_by_names</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain a pandas dataframe of Sentinel products for a given list of product names.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">all_results</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;https://catalogue.dataspace.copernicus.eu/odata/v1/Products?$filter=&quot;</span>

    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">query_url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">base_url</span><span class="si">}</span><span class="s2">Name eq &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&amp;$top=1000&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">query_url</span><span class="p">)</span>
        <span class="n">json_response</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>

        <span class="k">if</span> <span class="s1">&#39;value&#39;</span> <span class="ow">in</span> <span class="n">json_response</span><span class="p">:</span>
            <span class="n">all_results</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">json_response</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">])</span>

    <span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">all_results</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">results_df</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
        <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;Satellite&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">][:</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
        <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;SensingStart&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ContentDate&#39;</span><span class="p">][</span><span class="s1">&#39;Start&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
        <span class="n">results_df</span><span class="p">[</span><span class="s1">&#39;SensingEnd&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;ContentDate&#39;</span><span class="p">][</span><span class="s1">&#39;End&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">()]</span>
        <span class="n">results_df</span> <span class="o">=</span> <span class="n">results_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;SensingStart&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">results_df</span>

<span class="k">def</span> <span class="nf">download_single_product</span><span class="p">(</span><span class="n">product_id</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">access_token</span><span class="p">,</span> <span class="n">download_dir</span><span class="o">=</span><span class="s2">&quot;downloaded_products&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download a single product from the Copernicus Data Space.</span>

<span class="sd">    :param product_id: The unique identifier for the product.</span>
<span class="sd">    :param file_name: The name of the file to be downloaded.</span>
<span class="sd">    :param access_token: The access token for authorization.</span>
<span class="sd">    :param download_dir: The directory where the product will be saved.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure the download directory exists</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Construct the download URL</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;https://zipper.dataspace.copernicus.eu/odata/v1/Products(</span><span class="si">{</span><span class="n">product_id</span><span class="si">}</span><span class="s2">)/$value&quot;</span>

    <span class="c1"># Set up the session and headers</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Authorization&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">}</span>
    <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
    <span class="n">session</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>

    <span class="c1"># Perform the request</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Check if the request was successful</span>
    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="c1"># Define the path for the output file</span>
        <span class="n">output_file_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">download_dir</span><span class="p">,</span> <span class="n">file_name</span> <span class="o">+</span> <span class="s2">&quot;.zip&quot;</span><span class="p">)</span>

        <span class="c1"># Stream the content to a file</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">8192</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                    <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Downloaded: </span><span class="si">{</span><span class="n">output_file_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Failed to download product </span><span class="si">{</span><span class="n">product_id</span><span class="si">}</span><span class="s2">. Status Code: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cop_dspace_usrnm</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c1"># amend with your copernicus dataspace username</span>
<span class="n">cop_dspace_psswrd</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="c1"># amend with your copernicus dataspace password</span>
<span class="n">token</span><span class="p">,</span> <span class="n">refresh_token</span> <span class="o">=</span> <span class="n">get_access_token</span><span class="p">(</span><span class="n">cop_dspace_usrnm</span><span class="p">,</span> <span class="n">cop_dspace_psswrd</span><span class="p">)</span>
<span class="n">product_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230101T185252_20230101T185651_20230101T203101_0239_094_027______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230101T121709_20230101T122349_20230101T135934_0400_094_023______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230102T182657_20230102T183045_20230102T200425_0228_094_041______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230102T115112_20230102T115751_20230102T132929_0399_094_037______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230105T121326_20230105T122007_20230105T134843_0401_094_080______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230105T184910_20230105T185308_20230105T202752_0238_094_084______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230106T182316_20230106T182702_20230106T200253_0226_094_098______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230109T120945_20230109T121625_20230109T135020_0400_094_137______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230103T122643_20230103T123314_20230103T140329_0391_074_294______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230104T183621_20230104T184014_20230104T201141_0233_074_312______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230107T122257_20230107T122931_20230107T135514_0394_074_351______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230107T185833_20230107T190234_20230107T203555_0240_074_355______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230108T183238_20230108T183630_20230108T200807_0232_074_369______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230108T115654_20230108T120333_20230108T133905_0399_074_365______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230111T185450_20230111T185850_20230111T202939_0240_075_027______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230111T121911_20230111T122547_20230111T135219_0396_075_023______MAR_O_NR_005.SEN3&quot;</span>
<span class="p">]</span>

<span class="n">results_df</span> <span class="o">=</span> <span class="n">get_S3_products_by_names</span><span class="p">(</span><span class="n">product_names</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">results_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     @odata.mediaContentType                                    Id  \
1   application/octet-stream  df44f31a-61d2-5964-838b-816a54e39e43   
0   application/octet-stream  ccd45b65-52f8-5761-a43a-5909c6b05cc4   
3   application/octet-stream  eef92190-f150-5f99-b61d-6fe53bac377a   
2   application/octet-stream  30e00559-06fb-57f4-9960-544f0f036439   
8   application/octet-stream  68339973-c768-5475-a93f-20b271d53880   
9   application/octet-stream  e7247cfb-ad7c-59ed-80cb-a86f7ca8a5f7   
4   application/octet-stream  f9d13b5d-3ad2-5723-bd0e-2a9f3a685797   
5   application/octet-stream  596577bf-a7eb-5ad3-974a-45e7819244c9   
6   application/octet-stream  e7c0673a-7102-5025-ac1b-d989957274e0   
10  application/octet-stream  d4cc75e3-d55e-5a77-bb26-35efe4f6f918   
11  application/octet-stream  fc0101b5-a4a1-5a1c-9221-ef07a816ed1c   
13  application/octet-stream  45b2e256-9995-5ac3-8070-bfcd00e8e026   
12  application/octet-stream  65b1891a-60ca-5241-b5a8-96aa428b8838   
7   application/octet-stream  46ba2140-f18a-52b3-b3e9-c1f913736c2f   
15  application/octet-stream  985457af-568b-51a9-b457-c97c85e57e70   
14  application/octet-stream  09864a89-0698-5ccb-a88d-4e63737db88c   

                                                 Name  \
1   S3A_SR_2_WAT____20230101T121709_20230101T12234...   
0   S3A_SR_2_WAT____20230101T185252_20230101T18565...   
3   S3A_SR_2_WAT____20230102T115112_20230102T11575...   
2   S3A_SR_2_WAT____20230102T182657_20230102T18304...   
8   S3B_SR_2_WAT____20230103T122643_20230103T12331...   
9   S3B_SR_2_WAT____20230104T183621_20230104T18401...   
4   S3A_SR_2_WAT____20230105T121326_20230105T12200...   
5   S3A_SR_2_WAT____20230105T184910_20230105T18530...   
6   S3A_SR_2_WAT____20230106T182316_20230106T18270...   
10  S3B_SR_2_WAT____20230107T122257_20230107T12293...   
11  S3B_SR_2_WAT____20230107T185833_20230107T19023...   
13  S3B_SR_2_WAT____20230108T115654_20230108T12033...   
12  S3B_SR_2_WAT____20230108T183238_20230108T18363...   
7   S3A_SR_2_WAT____20230109T120945_20230109T12162...   
15  S3B_SR_2_WAT____20230111T121911_20230111T12254...   
14  S3B_SR_2_WAT____20230111T185450_20230111T18585...   

                 ContentType  ContentLength                OriginDate  \
1   application/octet-stream        7922688  2023-01-01T13:10:44.359Z   
0   application/octet-stream        4774912  2023-01-01T19:37:55.360Z   
3   application/octet-stream        8019968  2023-01-02T12:34:29.055Z   
2   application/octet-stream        4599808  2023-01-02T19:14:19.371Z   
8   application/octet-stream        7710720  2023-01-03T13:09:14.467Z   
9   application/octet-stream        4670464  2023-01-04T19:18:01.274Z   
4   application/octet-stream        8035328  2023-01-05T12:53:51.197Z   
5   application/octet-stream        4884480  2023-01-05T19:37:56.972Z   
6   application/octet-stream        4560896  2023-01-06T19:08:31.152Z   
10  application/octet-stream        7824384  2023-01-07T13:04:24.612Z   
11  application/octet-stream        4816896  2023-01-07T19:45:00.881Z   
13  application/octet-stream        7982080  2023-01-08T12:46:40.169Z   
12  application/octet-stream        4707328  2023-01-08T19:19:37.597Z   
7   application/octet-stream        8046592  2023-01-09T13:01:56.521Z   
15  application/octet-stream        7912448  2023-01-11T12:57:35.346Z   
14  application/octet-stream        4832256  2023-01-11T19:40:16.383Z   

             PublicationDate          ModificationDate  Online EvictionDate  \
1   2023-01-01T14:10:50.503Z  2023-01-01T14:10:54.931Z    True                
0   2023-01-01T20:38:06.184Z  2023-01-01T20:38:10.988Z    True                
3   2023-01-02T13:34:38.661Z  2023-01-02T13:34:41.932Z    True                
2   2023-01-02T20:14:24.803Z  2023-01-02T20:14:30.925Z    True                
8   2023-01-03T14:09:24.190Z  2023-01-03T14:09:29.684Z    True                
9   2023-01-04T20:18:08.757Z  2023-01-04T20:18:15.351Z    True                
4   2023-01-05T13:53:58.125Z  2023-01-05T13:54:02.355Z    True                
5   2023-01-05T20:38:02.201Z  2023-01-05T20:38:11.147Z    True                
6   2023-01-06T20:08:36.296Z  2023-01-06T20:08:40.188Z    True                
10  2023-01-07T14:04:31.948Z  2023-01-07T14:04:36.573Z    True                
11  2023-01-07T20:45:06.195Z  2023-01-07T20:45:10.350Z    True                
13  2023-01-08T13:46:46.625Z  2023-01-08T13:46:49.178Z    True                
12  2023-01-08T20:20:53.552Z  2023-01-08T20:20:57.349Z    True                
7   2023-01-09T14:02:06.200Z  2023-01-09T14:02:12.928Z    True                
15  2023-01-11T13:57:42.880Z  2023-01-11T13:57:46.771Z    True                
14  2023-01-11T20:40:25.478Z  2023-01-11T20:40:30.467Z    True                

                                               S3Path Checksum  \
1   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/01/S3...     [{}]   
0   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/01/S3...     [{}]   
3   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/02/S3...     [{}]   
2   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/02/S3...     [{}]   
8   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/03/S3...     [{}]   
9   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/04/S3...     [{}]   
4   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/05/S3...     [{}]   
5   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/05/S3...     [{}]   
6   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/06/S3...     [{}]   
10  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/07/S3...     [{}]   
11  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/07/S3...     [{}]   
13  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/08/S3...     [{}]   
12  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/08/S3...     [{}]   
7   /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/09/S3...     [{}]   
15  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/11/S3...     [{}]   
14  /eodata/Sentinel-3/SRAL/SR_2_WAT/2023/01/11/S3...     [{}]   

                                          ContentDate  \
1   {&#39;Start&#39;: &#39;2023-01-01T12:17:08.865Z&#39;, &#39;End&#39;: &#39;...   
0   {&#39;Start&#39;: &#39;2023-01-01T18:52:51.536Z&#39;, &#39;End&#39;: &#39;...   
3   {&#39;Start&#39;: &#39;2023-01-02T11:51:12.251Z&#39;, &#39;End&#39;: &#39;...   
2   {&#39;Start&#39;: &#39;2023-01-02T18:26:56.539Z&#39;, &#39;End&#39;: &#39;...   
8   {&#39;Start&#39;: &#39;2023-01-03T12:26:42.717Z&#39;, &#39;End&#39;: &#39;...   
9   {&#39;Start&#39;: &#39;2023-01-04T18:36:20.501Z&#39;, &#39;End&#39;: &#39;...   
4   {&#39;Start&#39;: &#39;2023-01-05T12:13:26.389Z&#39;, &#39;End&#39;: &#39;...   
5   {&#39;Start&#39;: &#39;2023-01-05T18:49:09.543Z&#39;, &#39;End&#39;: &#39;...   
6   {&#39;Start&#39;: &#39;2023-01-06T18:23:15.502Z&#39;, &#39;End&#39;: &#39;...   
10  {&#39;Start&#39;: &#39;2023-01-07T12:22:57.451Z&#39;, &#39;End&#39;: &#39;...   
11  {&#39;Start&#39;: &#39;2023-01-07T18:58:32.537Z&#39;, &#39;End&#39;: &#39;...   
13  {&#39;Start&#39;: &#39;2023-01-08T11:56:53.982Z&#39;, &#39;End&#39;: &#39;...   
12  {&#39;Start&#39;: &#39;2023-01-08T18:32:37.549Z&#39;, &#39;End&#39;: &#39;...   
7   {&#39;Start&#39;: &#39;2023-01-09T12:09:44.509Z&#39;, &#39;End&#39;: &#39;...   
15  {&#39;Start&#39;: &#39;2023-01-11T12:19:10.707Z&#39;, &#39;End&#39;: &#39;...   
14  {&#39;Start&#39;: &#39;2023-01-11T18:54:49.502Z&#39;, &#39;End&#39;: &#39;...   

                                            Footprint  \
1   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -75.1...   
0   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -78.1...   
3   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -72.3...   
2   geography&#39;SRID=4326;POLYGON ((-147.931 -67.383...   
8   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -75.8...   
9   geography&#39;SRID=4326;POLYGON ((-149.878 -67.056...   
4   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -74.7...   
5   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -78.2...   
6   geography&#39;SRID=4326;POLYGON ((-147.165 -67.527...   
10  geography&#39;SRID=4326;MULTIPOLYGON (((-180 -75.5...   
11  geography&#39;SRID=4326;MULTIPOLYGON (((-180 -77.8...   
13  geography&#39;SRID=4326;MULTIPOLYGON (((-180 -73.0...   
12  geography&#39;SRID=4326;POLYGON ((-149.091 -67.191...   
7   geography&#39;SRID=4326;MULTIPOLYGON (((-180 -74.4...   
15  geography&#39;SRID=4326;MULTIPOLYGON (((-180 -75.2...   
14  geography&#39;SRID=4326;MULTIPOLYGON (((-180 -78.0...   

                                         GeoFootprint Satellite  \
1   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
0   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
3   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
2   {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-147.931...       S3A   
8   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   
9   {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-149.878...       S3B   
4   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
5   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
6   {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-147.165...       S3A   
10  {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   
11  {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   
13  {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   
12  {&#39;type&#39;: &#39;Polygon&#39;, &#39;coordinates&#39;: [[[-149.091...       S3B   
7   {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3A   
15  {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   
14  {&#39;type&#39;: &#39;MultiPolygon&#39;, &#39;coordinates&#39;: [[[[-1...       S3B   

                       SensingStart                       SensingEnd  
1  2023-01-01 12:17:08.865000+00:00 2023-01-01 12:23:49.472000+00:00  
0  2023-01-01 18:52:51.536000+00:00 2023-01-01 18:56:50.577000+00:00  
3  2023-01-02 11:51:12.251000+00:00 2023-01-02 11:57:51.493000+00:00  
2  2023-01-02 18:26:56.539000+00:00 2023-01-02 18:30:44.985000+00:00  
8  2023-01-03 12:26:42.717000+00:00 2023-01-03 12:33:14.487000+00:00  
9  2023-01-04 18:36:20.501000+00:00 2023-01-04 18:40:14.345000+00:00  
4  2023-01-05 12:13:26.389000+00:00 2023-01-05 12:20:07.474000+00:00  
5  2023-01-05 18:49:09.543000+00:00 2023-01-05 18:53:07.973000+00:00  
6  2023-01-06 18:23:15.502000+00:00 2023-01-06 18:27:01.878000+00:00  
10 2023-01-07 12:22:57.451000+00:00 2023-01-07 12:29:31.488000+00:00  
11 2023-01-07 18:58:32.537000+00:00 2023-01-07 19:02:33.531000+00:00  
13 2023-01-08 11:56:53.982000+00:00 2023-01-08 12:03:33.469000+00:00  
12 2023-01-08 18:32:37.549000+00:00 2023-01-08 18:36:29.917000+00:00  
7  2023-01-09 12:09:44.509000+00:00 2023-01-09 12:16:25.473000+00:00  
15 2023-01-11 12:19:10.707000+00:00 2023-01-11 12:25:47.495000+00:00  
14 2023-01-11 18:54:49.502000+00:00 2023-01-11 18:58:49.769000+00:00  
</pre></div>
</div>
</div>
</div>
<p>Now we download all files altogether.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Assuming download_single_product is a function that takes product_id, file_name, token, and download_dir as arguments</span>

<span class="n">download_dir</span> <span class="o">=</span> <span class="s1">&#39;/Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/&#39;</span>

<span class="c1"># Loop through each row in the DataFrame</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">results_df</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">product_id</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Id&#39;</span><span class="p">]</span>
    <span class="n">file_name</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span>

    <span class="c1"># Call the download function for each product</span>
    <span class="n">download_single_product</span><span class="p">(</span><span class="n">product_id</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">token</span><span class="p">,</span> <span class="n">download_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230101T121709_20230101T122349_20230101T135934_0400_094_023______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230101T185252_20230101T185651_20230101T203101_0239_094_027______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230102T115112_20230102T115751_20230102T132929_0399_094_037______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230102T182657_20230102T183045_20230102T200425_0228_094_041______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230103T122643_20230103T123314_20230103T140329_0391_074_294______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230104T183621_20230104T184014_20230104T201141_0233_074_312______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230105T121326_20230105T122007_20230105T134843_0401_094_080______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230105T184910_20230105T185308_20230105T202752_0238_094_084______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230106T182316_20230106T182702_20230106T200253_0226_094_098______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230107T122257_20230107T122931_20230107T135514_0394_074_351______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230107T185833_20230107T190234_20230107T203555_0240_074_355______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230108T115654_20230108T120333_20230108T133905_0399_074_365______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230108T183238_20230108T183630_20230108T200807_0232_074_369______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3A_SR_2_WAT____20230109T120945_20230109T121625_20230109T135020_0400_094_137______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230111T121911_20230111T122547_20230111T135219_0396_075_023______MAR_O_NR_005.SEN3.zip
Downloaded: /Users/weibinchen/Desktop/UCL/PhD_Year_1/Data/S3B_SR_2_WAT____20230111T185450_20230111T185850_20230111T202939_0240_075_027______MAR_O_NR_005.SEN3.zip
</pre></div>
</div>
</div>
</div>
<p>By this stage, you should have all the Sentinel-3 files prepared for your analysis. If you need to locate additional files, the <a class="reference external" href="https://browser.dataspace.copernicus.eu/?zoom=5&amp;lat=50.16282&amp;lng=20.78613&amp;themeId=DEFAULT-THEME&amp;visualizationUrl=https%3A%2F%2Fsh.dataspace.copernicus.eu%2Fogc%2Fwms%2Fa91f72b5-f393-4320-bc0f-990129bd9e63&amp;datasetId=S2_L2A_CDAS&amp;demSource3D=%22MAPZEN%22&amp;cloudCoverage=30&amp;dateMode=SINGLE">Copernicus Data Space Browser</a> is an invaluable tool for pinpointing files in specific regions.</p>
<section id="step-1-product-selection">
<h3>Step 1: Product Selection<a class="headerlink" href="#step-1-product-selection" title="Permalink to this heading">#</a></h3>
<p>Begin by choosing the desired data products. For our purposes, select the SENTINEL-3/SRAL/Level-2 WAT dataset.
<img alt="Data Selection Interface" src="_images/image1.png" /></p>
<p>You can also define the temporal scope of your search by setting the desired date range.
<img alt="Date Range Selection" src="_images/image2.png" /></p>
</section>
<section id="step-2-defining-the-region-of-interest">
<h3>Step 2: Defining the Region of Interest<a class="headerlink" href="#step-2-defining-the-region-of-interest" title="Permalink to this heading">#</a></h3>
<p>Use the polygon tool to demarcate your area of interest on the map.
<img alt="Region Drawing Tool" src="_images/image_3.png" /></p>
</section>
<section id="step-3-initiating-the-search">
<h3>Step 3: Initiating the Search<a class="headerlink" href="#step-3-initiating-the-search" title="Permalink to this heading">#</a></h3>
<p>With the chosen products, defined time span, and spatial parameters set, the browser will retrieve a list of files that match your criteria.
<img alt="Search Results Interface" src="_images/image4.png" />
<img alt="File List Interface" src="image5.png" /></p>
</section>
</section>
<section id="sla-interpolation">
<h2>SLA Interpolation<a class="headerlink" href="#sla-interpolation" title="Permalink to this heading">#</a></h2>
<p>Now, the data is all set and we can proceed with the interpolation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span><span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>netCDF4
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Collecting netCDF4
  Downloading netCDF4-1.6.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.5/5.5 MB</span> <span class=" -Color -Color-Red">14.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting cftime (from netCDF4)
  Downloading cftime-1.6.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.3/1.3 MB</span> <span class=" -Color -Color-Red">49.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from netCDF4) (2024.2.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.10/dist-packages (from netCDF4) (1.25.2)
Installing collected packages: cftime, netCDF4
Successfully installed cftime-1.6.3 netCDF4-1.6.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/Data/&#39;</span>
<span class="n">SAR_file</span><span class="o">=</span><span class="s1">&#39;S3A_SR_2_WAT____20230101T121709_20230101T122349_20230101T135934_0400_094_023______MAR_O_NR_005.SEN3&#39;</span>
<span class="n">SAR_data</span><span class="o">=</span><span class="n">Dataset</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="n">SAR_file</span><span class="o">+</span><span class="s1">&#39;/enhanced_measurement.nc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAR_data</span><span class="o">.</span><span class="n">variables</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;time_01&#39;, &#39;time_20_ku&#39;, &#39;time_20_c&#39;, &#39;echo_sample_ind&#39;, &#39;UTC_day_01&#39;, &#39;UTC_sec_01&#39;, &#39;UTC_day_20_ku&#39;, &#39;UTC_sec_20_ku&#39;, &#39;UTC_day_20_c&#39;, &#39;UTC_sec_20_c&#39;, &#39;UTC_time_1hz_20_ku&#39;, &#39;UTC_time_1hz_20_c&#39;, &#39;lat_01&#39;, &#39;lon_01&#39;, &#39;lat_20_ku&#39;, &#39;lon_20_ku&#39;, &#39;lat_20_c&#39;, &#39;lon_20_c&#39;, &#39;lat_cor_20_ku&#39;, &#39;lon_cor_20_ku&#39;, &#39;lat_cor_20_c&#39;, &#39;lon_cor_20_c&#39;, &#39;surf_type_01&#39;, &#39;surf_type_20_ku&#39;, &#39;surf_type_20_c&#39;, &#39;surf_class_01&#39;, &#39;surf_class_20_ku&#39;, &#39;surf_class_20_c&#39;, &#39;rad_surf_type_01&#39;, &#39;angle_coast_01&#39;, &#39;angle_coast_20_ku&#39;, &#39;angle_coast_20_c&#39;, &#39;dist_coast_01&#39;, &#39;dist_coast_20_ku&#39;, &#39;dist_coast_20_c&#39;, &#39;alt_01&#39;, &#39;alt_20_ku&#39;, &#39;alt_20_c&#39;, &#39;orb_alt_rate_01&#39;, &#39;orb_alt_rate_20_ku&#39;, &#39;orb_alt_rate_20_c&#39;, &#39;tracker_range_20_ku&#39;, &#39;tracker_range_20_c&#39;, &#39;tracker_range_20_plrm_ku&#39;, &#39;h0_nav_dem_20_ku&#39;, &#39;agc_01_ku&#39;, &#39;agc_01_c&#39;, &#39;agc_01_plrm_ku&#39;, &#39;agc_20_ku&#39;, &#39;agc_20_c&#39;, &#39;agc_20_plrm_ku&#39;, &#39;agc_numval_01_ku&#39;, &#39;agc_numval_01_c&#39;, &#39;agc_numval_01_plrm_ku&#39;, &#39;agc_rms_01_ku&#39;, &#39;agc_rms_01_c&#39;, &#39;agc_rms_01_plrm_ku&#39;, &#39;agc_qual_20_ku&#39;, &#39;agc_qual_20_c&#39;, &#39;agc_qual_20_plrm_ku&#39;, &#39;scale_factor_20_ku&#39;, &#39;scale_factor_20_c&#39;, &#39;scale_factor_20_plrm_ku&#39;, &#39;range_ocean_01_ku&#39;, &#39;range_ocean_01_c&#39;, &#39;range_ocean_01_plrm_ku&#39;, &#39;range_ocean_20_ku&#39;, &#39;range_ocean_20_c&#39;, &#39;range_ocean_20_plrm_ku&#39;, &#39;range_ocean_qual_01_ku&#39;, &#39;range_ocean_qual_01_c&#39;, &#39;range_ocean_qual_01_plrm_ku&#39;, &#39;range_ocean_qual_20_ku&#39;, &#39;range_ocean_qual_20_c&#39;, &#39;range_ocean_qual_20_plrm_ku&#39;, &#39;range_ocean_rms_01_ku&#39;, &#39;range_ocean_rms_01_c&#39;, &#39;range_ocean_rms_01_plrm_ku&#39;, &#39;range_ocean_numval_01_ku&#39;, &#39;range_ocean_numval_01_c&#39;, &#39;range_ocean_numval_01_plrm_ku&#39;, &#39;interpolated_c_band_range_ocean_20_ku&#39;, &#39;sig0_ocean_01_ku&#39;, &#39;sig0_ocean_01_c&#39;, &#39;sig0_ocean_01_plrm_ku&#39;, &#39;sig0_ocean_20_ku&#39;, &#39;sig0_ocean_20_c&#39;, &#39;sig0_ocean_20_plrm_ku&#39;, &#39;sig0_ocean_qual_01_ku&#39;, &#39;sig0_ocean_qual_01_c&#39;, &#39;sig0_ocean_qual_01_plrm_ku&#39;, &#39;sig0_ocean_qual_20_ku&#39;, &#39;sig0_ocean_qual_20_c&#39;, &#39;sig0_ocean_qual_20_plrm_ku&#39;, &#39;sig0_ocean_rms_01_ku&#39;, &#39;sig0_ocean_rms_01_c&#39;, &#39;sig0_ocean_rms_01_plrm_ku&#39;, &#39;sig0_ocean_numval_01_ku&#39;, &#39;sig0_ocean_numval_01_c&#39;, &#39;sig0_ocean_numval_01_plrm_ku&#39;, &#39;swh_ocean_01_ku&#39;, &#39;swh_ocean_01_c&#39;, &#39;swh_ocean_01_plrm_ku&#39;, &#39;swh_ocean_20_ku&#39;, &#39;swh_ocean_20_c&#39;, &#39;swh_ocean_20_plrm_ku&#39;, &#39;swh_ocean_qual_01_ku&#39;, &#39;swh_ocean_qual_01_c&#39;, &#39;swh_ocean_qual_01_plrm_ku&#39;, &#39;swh_ocean_qual_20_ku&#39;, &#39;swh_ocean_qual_20_c&#39;, &#39;swh_ocean_qual_20_plrm_ku&#39;, &#39;swh_ocean_rms_01_ku&#39;, &#39;swh_ocean_rms_01_c&#39;, &#39;swh_ocean_rms_01_plrm_ku&#39;, &#39;swh_ocean_numval_01_ku&#39;, &#39;swh_ocean_numval_01_c&#39;, &#39;swh_ocean_numval_01_plrm_ku&#39;, &#39;epoch_ocean_20_ku&#39;, &#39;epoch_ocean_20_c&#39;, &#39;epoch_ocean_20_plrm_ku&#39;, &#39;sigmac_ocean_20_ku&#39;, &#39;sigmac_ocean_20_c&#39;, &#39;sigmac_ocean_20_plrm_ku&#39;, &#39;amplitude_ocean_20_ku&#39;, &#39;amplitude_ocean_20_c&#39;, &#39;amplitude_ocean_20_plrm_ku&#39;, &#39;thermal_noise_ocean_20_ku&#39;, &#39;thermal_noise_ocean_20_c&#39;, &#39;thermal_noise_ocean_20_plrm_ku&#39;, &#39;off_nadir_angle_wf_ocean_20_ku&#39;, &#39;off_nadir_angle_wf_ocean_20_plrm_ku&#39;, &#39;number_of_iterations_ocean_20_ku&#39;, &#39;number_of_iterations_ocean_20_c&#39;, &#39;number_of_iterations_ocean_20_plrm_ku&#39;, &#39;mqe_ocean_20_ku&#39;, &#39;mqe_ocean_20_c&#39;, &#39;mqe_ocean_20_plrm_ku&#39;, &#39;ssha_01_ku&#39;, &#39;ssha_01_plrm_ku&#39;, &#39;ssha_20_ku&#39;, &#39;ssha_20_plrm_ku&#39;, &#39;range_ocog_20_ku&#39;, &#39;range_ocog_20_c&#39;, &#39;sig0_ocog_20_ku&#39;, &#39;sig0_ocog_20_c&#39;, &#39;range_ice_sheet_20_ku&#39;, &#39;range_ice_sheet_20_c&#39;, &#39;sig0_ice_sheet_20_ku&#39;, &#39;sig0_ice_sheet_20_c&#39;, &#39;elevation_ice_sheet_20_ku&#39;, &#39;elevation_ocog_20_ku&#39;, &#39;range_ice_20_ku&#39;, &#39;range_ice_20_c&#39;, &#39;range_ice_20_plrm_ku&#39;, &#39;sig0_ice_20_ku&#39;, &#39;sig0_ice_20_c&#39;, &#39;sig0_ice_20_plrm_ku&#39;, &#39;sig0_leading_edge_ice_20_ku&#39;, &#39;sig0_leading_edge_ice_20_c&#39;, &#39;sig0_leading_edge_ice_20_plrm_ku&#39;, &#39;width_leading_edge_ice_20_ku&#39;, &#39;width_leading_edge_ice_20_c&#39;, &#39;width_leading_edge_ice_20_plrm_ku&#39;, &#39;slope_first_trailing_edge_ice_20_ku&#39;, &#39;slope_first_trailing_edge_ice_20_c&#39;, &#39;slope_first_trailing_edge_ice_20_plrm_ku&#39;, &#39;slope_second_trailing_edge_ice_20_ku&#39;, &#39;slope_second_trailing_edge_ice_20_c&#39;, &#39;slope_second_trailing_edge_ice_20_plrm_ku&#39;, &#39;range_sea_ice_20_ku&#39;, &#39;sig0_sea_ice_sheet_20_ku&#39;, &#39;sea_ice_sea_surf_20_ku&#39;, &#39;sea_ice_ssha_20_ku&#39;, &#39;int_sea_ice_ssha_20_ku&#39;, &#39;freeboard_20_ku&#39;, &#39;surf_type_class_20_ku&#39;, &#39;uso_cor_20_ku&#39;, &#39;uso_cor_20_c&#39;, &#39;int_path_cor_20_ku&#39;, &#39;int_path_cor_20_c&#39;, &#39;int_path_cor_20_plrm_ku&#39;, &#39;dop_cor_l1b_20_ku&#39;, &#39;dop_cor_l1b_20_c&#39;, &#39;dop_cor_l1b_20_plrm_ku&#39;, &#39;dop_cor_20_ku&#39;, &#39;dop_cor_20_c&#39;, &#39;dop_cor_20_plrm_ku&#39;, &#39;dop_slope_cor_20_ku&#39;, &#39;dop_slope_cor_20_c&#39;, &#39;cog_cor_01&#39;, &#39;mod_instr_cor_range_01_ku&#39;, &#39;mod_instr_cor_range_01_c&#39;, &#39;mod_instr_cor_range_01_plrm_ku&#39;, &#39;net_instr_cor_range_20_ku&#39;, &#39;net_instr_cor_range_20_c&#39;, &#39;net_instr_cor_range_20_plrm_ku&#39;, &#39;agc_cor_20_ku&#39;, &#39;agc_cor_20_c&#39;, &#39;agc_cor_20_plrm_ku&#39;, &#39;sig0_cal_20_ku&#39;, &#39;sig0_cal_20_c&#39;, &#39;sig0_cal_20_plrm_ku&#39;, &#39;mod_instr_cor_sig0_01_ku&#39;, &#39;mod_instr_cor_sig0_01_c&#39;, &#39;mod_instr_cor_sig0_01_plrm_ku&#39;, &#39;net_instr_cor_sig0_20_ku&#39;, &#39;net_instr_cor_sig0_20_c&#39;, &#39;net_instr_cor_sig0_20_plrm_ku&#39;, &#39;mod_instr_cor_swh_01_ku&#39;, &#39;mod_instr_cor_swh_01_c&#39;, &#39;mod_instr_cor_swh_01_plrm_ku&#39;, &#39;net_instr_cor_swh_20_ku&#39;, &#39;net_instr_cor_swh_20_c&#39;, &#39;net_instr_cor_swh_20_plrm_ku&#39;, &#39;mod_dry_tropo_cor_zero_altitude_01&#39;, &#39;mod_dry_tropo_cor_meas_altitude_01&#39;, &#39;mod_wet_tropo_cor_zero_altitude_01&#39;, &#39;mod_wet_tropo_cor_meas_altitude_01&#39;, &#39;rad_wet_tropo_cor_01_ku&#39;, &#39;rad_wet_tropo_cor_01_plrm_ku&#39;, &#39;rad_wet_tropo_cor_sst_gam_01_ku&#39;, &#39;rad_wet_tropo_cor_sst_gam_01_plrm_ku&#39;, &#39;gpd_wet_tropo_cor_01&#39;, &#39;gpd_source_flag_01&#39;, &#39;iono_cor_alt_01_ku&#39;, &#39;iono_cor_alt_01_plrm_ku&#39;, &#39;iono_cor_alt_20_ku&#39;, &#39;iono_cor_alt_20_plrm_ku&#39;, &#39;iono_cor_gim_01_ku&#39;, &#39;sea_state_bias_01_ku&#39;, &#39;sea_state_bias_01_c&#39;, &#39;sea_state_bias_01_plrm_ku&#39;, &#39;atm_cor_sig0_01_ku&#39;, &#39;atm_cor_sig0_01_c&#39;, &#39;atm_cor_sig0_01_plrm_ku&#39;, &#39;mean_sea_surf_sol1_01&#39;, &#39;mean_sea_surf_sol1_20_ku&#39;, &#39;mean_sea_surf_sol1_20_c&#39;, &#39;mean_sea_surf_sol1_acc_01&#39;, &#39;mean_sea_surf_sol1_acc_20_ku&#39;, &#39;mean_sea_surf_sol1_acc_20_c&#39;, &#39;mean_sea_surf_sol2_01&#39;, &#39;mean_sea_surf_sol2_20_ku&#39;, &#39;mean_sea_surf_sol2_20_c&#39;, &#39;mean_sea_surf_sol2_acc_01&#39;, &#39;mean_sea_surf_sol2_acc_20_ku&#39;, &#39;mean_sea_surf_sol2_acc_20_c&#39;, &#39;mean_dyn_topo_01&#39;, &#39;mean_dyn_topo_acc_01&#39;, &#39;geoid_01&#39;, &#39;odle_01&#39;, &#39;inv_bar_cor_01&#39;, &#39;hf_fluct_cor_01&#39;, &#39;hf_fluct_cor_flag_01&#39;, &#39;ocean_tide_sol1_01&#39;, &#39;ocean_tide_sol2_01&#39;, &#39;ocean_tide_eq_01&#39;, &#39;ocean_tide_non_eq_01&#39;, &#39;load_tide_sol1_01&#39;, &#39;load_tide_sol2_01&#39;, &#39;solid_earth_tide_01&#39;, &#39;pole_tide_01&#39;, &#39;internal_tide_sol1_01&#39;, &#39;rain_rate_01&#39;, &#39;rain_att_01_ku&#39;, &#39;rain_att_01_plrm_ku&#39;, &#39;sea_ice_concentration_20_ku&#39;, &#39;snow_density_20_ku&#39;, &#39;snow_depth_20_ku&#39;, &#39;wind_speed_mod_u_01&#39;, &#39;wind_speed_mod_v_01&#39;, &#39;wind_speed_alt_01_ku&#39;, &#39;wind_speed_alt_01_plrm_ku&#39;, &#39;rad_water_vapor_01_ku&#39;, &#39;rad_water_vapor_01_plrm_ku&#39;, &#39;rad_liquid_water_01_ku&#39;, &#39;rad_liquid_water_01_plrm_ku&#39;, &#39;total_electron_content_01&#39;, &#39;corrected_off_nadir_angle_wf_ocean_01_ku&#39;, &#39;corrected_off_nadir_angle_wf_ocean_01_plrm_ku&#39;, &#39;val_alt_off_nadir_angle_wf_ocean_01_ku&#39;, &#39;val_alt_off_nadir_angle_wf_ocean_01_plrm_ku&#39;, &#39;off_nadir_angle_used_20_ku&#39;, &#39;off_nadir_angle_used_20_plrm_ku&#39;, &#39;off_nadir_angle_rms_01_ku&#39;, &#39;off_nadir_angle_rms_01_plrm_ku&#39;, &#39;off_nadir_angle_numval_01_ku&#39;, &#39;off_nadir_angle_numval_01_plrm_ku&#39;, &#39;mod_instr_cor_off_nadir_angle_01_ku&#39;, &#39;mod_instr_cor_off_nadir_angle_01_plrm_ku&#39;, &#39;off_nadir_roll_angle_pf_01&#39;, &#39;off_nadir_pitch_angle_pf_01&#39;, &#39;off_nadir_yaw_angle_pf_01&#39;, &#39;tb_238_01&#39;, &#39;tb_365_01&#39;, &#39;tb_238_std_01&#39;, &#39;tb_365_std_01&#39;, &#39;waveform_20_ku&#39;, &#39;waveform_20_c&#39;, &#39;waveform_20_plrm_ku&#39;, &#39;instr_op_mode_01&#39;, &#39;instr_op_mode_20_ku&#39;, &#39;instr_op_mode_20_c&#39;, &#39;mode_id_20_ku&#39;, &#39;mode_id_20_c&#39;, &#39;meteo_map_avail_01&#39;, &#39;rain_flag_01_ku&#39;, &#39;rain_flag_01_plrm_ku&#39;, &#39;open_sea_ice_flag_01_ku&#39;, &#39;open_sea_ice_flag_01_plrm_ku&#39;, &#39;open_water_class_01_ku&#39;, &#39;open_water_class_01_plrm_ku&#39;, &#39;first_year_ice_class_01_ku&#39;, &#39;first_year_ice_class_01_plrm_ku&#39;, &#39;multi_year_ice_class_01_ku&#39;, &#39;multi_year_ice_class_01_plrm_ku&#39;, &#39;wet_ice_class_01_ku&#39;, &#39;wet_ice_class_01_plrm_ku&#39;, &#39;ice_sheet_snow_facies_flag_01_ku&#39;, &#39;ice_sheet_snow_facies_flag_01_plrm_ku&#39;, &#39;interp_flag_mss_sol1_01&#39;, &#39;interp_flag_mss_sol1_20_ku&#39;, &#39;interp_flag_mss_sol1_20_c&#39;, &#39;interp_flag_mss_sol2_01&#39;, &#39;interp_flag_mss_sol2_20_ku&#39;, &#39;interp_flag_mss_sol2_20_c&#39;, &#39;interp_flag_mdt_01&#39;, &#39;interp_flag_ocean_tide_sol1_01&#39;, &#39;interp_flag_ocean_tide_sol2_01&#39;, &#39;rad_along_track_avg_flag_01&#39;, &#39;tb_238_quality_flag_01&#39;, &#39;tb_365_quality_flag_01&#39;, &#39;climato_use_flag_01_ku&#39;, &#39;climato_use_flag_01_plrm_ku&#39;, &#39;peakiness_1_20_ku&#39;, &#39;peakiness_1_20_c&#39;, &#39;peakiness_1_20_plrm_ku&#39;, &#39;peakiness_2_20_ku&#39;, &#39;peakiness_2_20_c&#39;, &#39;nb_stack_20_ku&#39;, &#39;nav_bul_status_20_ku&#39;, &#39;nav_bul_status_20_c&#39;, &#39;nav_bul_source_20_ku&#39;, &#39;nav_bul_source_20_c&#39;, &#39;nav_bul_coarse_time_20_ku&#39;, &#39;nav_bul_coarse_time_20_c&#39;, &#39;nav_bul_fine_time_20_ku&#39;, &#39;nav_bul_fine_time_20_c&#39;, &#39;seq_count_20_ku&#39;, &#39;seq_count_20_c&#39;, &#39;isp_time_status_20_ku&#39;, &#39;isp_time_status_20_c&#39;, &#39;oper_instr_20_ku&#39;, &#39;oper_instr_20_c&#39;, &#39;cl_gain_20_ku&#39;, &#39;cl_gain_20_c&#39;, &#39;acq_stat_20_ku&#39;, &#39;acq_stat_20_c&#39;, &#39;dem_eeprom_20_ku&#39;, &#39;dem_eeprom_20_c&#39;, &#39;weighting_20_ku&#39;, &#39;weighting_20_c&#39;, &#39;loss_track_20_ku&#39;, &#39;loss_track_20_c&#39;, &#39;flag_man_pres_20_ku&#39;, &#39;flag_man_pres_20_c&#39;, &#39;flag_man_thrust_20_ku&#39;, &#39;flag_man_thrust_20_c&#39;, &#39;flag_man_plane_20_ku&#39;, &#39;flag_man_plane_20_c&#39;, &#39;index_1hz_meas_20_ku&#39;, &#39;index_1hz_meas_20_c&#39;, &#39;index_first_20hz_meas_01_ku&#39;, &#39;index_first_20hz_meas_01_c&#39;, &#39;num_20hz_meas_01_ku&#39;, &#39;num_20hz_meas_01_c&#39;, &#39;orbit_type_01&#39;, &#39;waveform_qual_ice_20_ku&#39;, &#39;iono_cor_alt_filtered_01_ku&#39;, &#39;iono_cor_alt_filtered_01_plrm_ku&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_20_ku&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7860,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_01_ku&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(401,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_01_ku&#39;</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_01_ku&#39;</span><span class="p">])</span><span class="o">&lt;</span><span class="mf">0.3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7fa8328adb10&gt;]
</pre></div>
</div>
<img alt="_images/e4bf7e47d0fff3fdd5fd3a06d652e40e6fddf29a9cea0ce902cdcc829590d448.png" src="_images/e4bf7e47d0fff3fdd5fd3a06d652e40e6fddf29a9cea0ce902cdcc829590d448.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_20_ku&#39;</span><span class="p">][</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;ssha_20_ku&#39;</span><span class="p">])</span><span class="o">&lt;</span><span class="mf">0.3</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x7ea7d11f3fa0&gt;]
</pre></div>
</div>
<img alt="_images/3705d8eabc243ac53ca072c534446d4b371877d27d339e90db20d9acc1c736e0.png" src="_images/3705d8eabc243ac53ca072c534446d4b371877d27d339e90db20d9acc1c736e0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SAR_data</span><span class="p">[</span><span class="s1">&#39;lon_20_ku&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(7860,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Transformer</span>

<span class="c1"># Define the transformation function</span>
<span class="k">def</span> <span class="nf">WGS84toEASE2_Vectorized</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">return_vals</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">):</span>
    <span class="n">EASE2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;+proj=laea +lon_0=</span><span class="si">{</span><span class="n">lon_0</span><span class="si">}</span><span class="s2"> +lat_0=</span><span class="si">{</span><span class="n">lat_0</span><span class="si">}</span><span class="s2"> +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;</span>
    <span class="n">WGS84</span> <span class="o">=</span> <span class="s2">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;</span>
    <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">WGS84</span><span class="p">,</span> <span class="n">EASE2</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_vals</span> <span class="o">==</span> <span class="s1">&#39;both&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="k">def</span> <span class="nf">EASE2toWGS84</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">return_vals</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">):</span>

    <span class="n">valid_return_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">return_vals</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;return_val: </span><span class="si">{</span><span class="n">return_vals</span><span class="si">}</span><span class="s2"> is not in valid set: </span><span class="si">{</span><span class="n">valid_return_vals</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">EASE2</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;+proj=laea +lon_0=</span><span class="si">{</span><span class="n">lon_0</span><span class="si">}</span><span class="s2"> +lat_0=</span><span class="si">{</span><span class="n">lat_0</span><span class="si">}</span><span class="s2"> +x_0=0 +y_0=0 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;</span>
    <span class="n">WGS84</span> <span class="o">=</span> <span class="s2">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;</span>
    <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="n">EASE2</span><span class="p">,</span> <span class="n">WGS84</span><span class="p">)</span>
    <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">return_vals</span> <span class="o">==</span> <span class="s2">&quot;both&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span>
    <span class="k">elif</span> <span class="n">return_vals</span> <span class="o">==</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lon</span>
    <span class="k">elif</span> <span class="n">return_vals</span> <span class="o">==</span> <span class="s2">&quot;lat&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">lat</span>

<span class="k">def</span> <span class="nf">get_projection</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># projection</span>
    <span class="k">if</span> <span class="n">projection</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Projection</span><span class="p">):</span>
        <span class="k">pass</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;north&quot;</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s2">&quot;south&quot;</span><span class="p">,</span> <span class="n">projection</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="n">projection</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;projection provide as str: </span><span class="si">{</span><span class="n">projection</span><span class="si">}</span><span class="s2">, not implemented&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">projection</span>
<span class="k">def</span> <span class="nf">plot_pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span>
                    <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">qvmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">qvmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;YlGnBu_r&#39;</span><span class="p">,</span>
                    <span class="n">cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">scatter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">extent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">ocean_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">scatter_args</span><span class="p">):</span>

    <span class="c1"># ax = axs[j]</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;50m&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAKES</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">))</span>
    <span class="c1"># extent=[10, -150, -80, -67] if extent is None else extent</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span> <span class="k">if</span> <span class="n">extent</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">extent</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">(</span><span class="n">extent</span><span class="p">,</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>  <span class="c1"># lon_min,lon_max,lat_min,lat_max</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ocean_only</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">globe_mask</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ocean_only=</span><span class="si">{</span><span class="n">ocean_only</span><span class="si">}</span><span class="s2">, however globe_mask is missing, &quot;</span>
                          <span class="sa">f</span><span class="s2">&quot;install with pip install global-land-mask&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">is_in_ocean</span> <span class="o">=</span> <span class="n">globe_mask</span><span class="o">.</span><span class="n">is_ocean</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
            <span class="c1"># copy, just to be safe</span>
            <span class="n">plot_data</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>
            <span class="n">plot_data</span><span class="p">[</span><span class="o">~</span><span class="n">is_in_ocean</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">if</span> <span class="n">qvmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;both qvmin and vmin are supplied, only using qvmin&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">qvmin</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">qvmin</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;qvmin: </span><span class="si">{</span><span class="n">qvmin</span><span class="si">}</span><span class="s2">, needs to be in [0,1]&quot;</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">qvmin</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">qvmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;both qvmax and vmax are supplied, only using qvmax&quot;</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">qvmax</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">qvmax</span> <span class="o">&lt;=</span> <span class="mf">1.0</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;qvmax: </span><span class="si">{</span><span class="n">qvmax</span><span class="si">}</span><span class="s2">, needs to be in [0,1]&quot;</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanquantile</span><span class="p">(</span><span class="n">plot_data</span><span class="p">,</span> <span class="n">q</span><span class="o">=</span><span class="n">qvmax</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">vmin</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">vmax</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">vmin</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;vmin: </span><span class="si">{</span><span class="n">vmin</span><span class="si">}</span><span class="s2"> &gt; vmax: </span><span class="si">{</span><span class="n">vmax</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">scatter</span><span class="p">:</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">plot_data</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                          <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                          <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                          <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                          <span class="n">shading</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">,</span><span class="c1"># to remove DeprecationWarning</span>
                          <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">non_nan</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">plot_data</span><span class="p">)</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lon</span><span class="p">[</span><span class="n">non_nan</span><span class="p">],</span>
                       <span class="n">lat</span><span class="p">[</span><span class="n">non_nan</span><span class="p">],</span>
                       <span class="n">c</span><span class="o">=</span><span class="n">plot_data</span><span class="p">[</span><span class="n">non_nan</span><span class="p">],</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                       <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span>
                       <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>
                       <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                       <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="o">**</span><span class="n">scatter_args</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cbar_label</span><span class="p">:</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Load the dataset</span>
<span class="c1"># SAR_data = nc.Dataset(path + SAR_file + &#39;/enhanced_measurement.nc&#39;)</span>

<span class="c1"># # Extract spatial and temporal information</span>
<span class="c1"># lon = SAR_data.variables[lon_var_name][:]</span>
<span class="c1"># lat = SAR_data.variables[lat_var_name][:]</span>
<span class="c1"># time = SAR_data.variables[time_var_name][:]</span>
<span class="c1"># base_time = datetime(2000, 1, 1)</span>
<span class="c1"># datetimes = np.array([base_time + timedelta(seconds=int(t)) for t in time])</span>
<span class="c1"># ssha = SAR_data.variables[ssha_var_name][:]</span>

<span class="c1"># # Convert lon, lat to EASE-2 Grid</span>
<span class="c1"># x, y = WGS84toEASE2_Vectorized(lon, lat)</span>

<span class="c1"># # Create a DataFrame</span>
<span class="c1"># df = pd.DataFrame({</span>
<span class="c1">#     &#39;lon&#39;: lon,</span>
<span class="c1">#     &#39;lat&#39;: lat,</span>
<span class="c1">#     &#39;datetime&#39;: datetimes,</span>
<span class="c1">#     &#39;obs&#39;: ssha</span>
<span class="c1"># })</span>

<span class="c1"># # Convert datetime to float days since epoch</span>
<span class="c1"># df[&#39;t&#39;] = (df[&#39;datetime&#39;] - pd.Timestamp(&quot;1970-01-01&quot;)) / pd.Timedelta(&#39;1D&#39;)</span>

<span class="c1"># # Apply the coordinate transformation to the DataFrame directly</span>
<span class="c1"># transformer = Transformer.from_crs(&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;,</span>
<span class="c1">#                                    &quot;+proj=laea +lon_0=0 +lat_0=90 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs&quot;)</span>
<span class="c1"># df[&#39;x&#39;], df[&#39;y&#39;] = transformer.transform(df[&#39;lon&#39;].values, df[&#39;lat&#39;].values)</span>

<span class="c1"># # Drop rows with NaN in &#39;obs&#39; column</span>
<span class="c1"># df.dropna(subset=[&#39;obs&#39;], inplace=True)</span>

<span class="c1"># # Now df has &#39;x&#39;, &#39;y&#39;, &#39;t&#39;, and filtered &#39;obs&#39;</span>
<span class="c1"># print(df[[&#39;x&#39;, &#39;y&#39;, &#39;t&#39;, &#39;obs&#39;]])</span>
</pre></div>
</div>
</div>
</div>
<p>With a collection of 16 files, it’s essential to streamline the aforementioned process. Doing so will enable us to amalgamate the individual files into a comprehensive dataframe, forming an extensive dataset for thorough examination.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SEN3_files</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230101T185252_20230101T185651_20230101T203101_0239_094_027______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230101T121709_20230101T122349_20230101T135934_0400_094_023______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230102T182657_20230102T183045_20230102T200425_0228_094_041______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230102T115112_20230102T115751_20230102T132929_0399_094_037______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230105T121326_20230105T122007_20230105T134843_0401_094_080______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230105T184910_20230105T185308_20230105T202752_0238_094_084______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230106T182316_20230106T182702_20230106T200253_0226_094_098______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3A_SR_2_WAT____20230109T120945_20230109T121625_20230109T135020_0400_094_137______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230103T122643_20230103T123314_20230103T140329_0391_074_294______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230104T183621_20230104T184014_20230104T201141_0233_074_312______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230107T122257_20230107T122931_20230107T135514_0394_074_351______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230107T185833_20230107T190234_20230107T203555_0240_074_355______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230108T183238_20230108T183630_20230108T200807_0232_074_369______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230108T115654_20230108T120333_20230108T133905_0399_074_365______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230111T185450_20230111T185850_20230111T202939_0240_075_027______MAR_O_NR_005.SEN3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;S3B_SR_2_WAT____20230111T121911_20230111T122547_20230111T135219_0396_075_023______MAR_O_NR_005.SEN3&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">SEN3_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>16
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">netCDF4</span> <span class="k">as</span> <span class="nn">nc</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">pyproj</span> <span class="kn">import</span> <span class="n">Transformer</span>


<span class="k">def</span> <span class="nf">running_mean</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">window_size</span><span class="p">):</span>
    <span class="n">cumsum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cumsum</span><span class="p">[</span><span class="n">window_size</span><span class="p">:]</span> <span class="o">-</span> <span class="n">cumsum</span><span class="p">[:</span><span class="o">-</span><span class="n">window_size</span><span class="p">])</span> <span class="o">/</span> <span class="n">window_size</span>



<span class="c1"># Path to your data directory</span>
<span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/Data/&#39;</span>

<span class="c1"># Initialise an empty DataFrame to hold all data</span>
<span class="n">all_data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="n">SAR_file</span> <span class="ow">in</span> <span class="n">SEN3_files</span><span class="p">:</span>
    <span class="c1"># Construct the full path to the .nc file</span>
    <span class="n">file_path</span> <span class="o">=</span> <span class="n">path</span> <span class="o">+</span> <span class="n">SAR_file</span> <span class="o">+</span> <span class="s1">&#39;/enhanced_measurement.nc&#39;</span>

    <span class="c1"># Load the dataset</span>
    <span class="n">SAR_data</span> <span class="o">=</span> <span class="n">nc</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>

    <span class="c1"># Extract spatial and temporal information</span>
    <span class="c1"># lon = SAR_data.variables[&#39;lon_01&#39;][:]</span>
    <span class="c1"># lat = SAR_data.variables[&#39;lat_01&#39;][:]</span>
    <span class="c1"># time = SAR_data.variables[&#39;time_01&#39;][:]</span>
    <span class="c1"># ssha = SAR_data.variables[&#39;ssha_01_ku&#39;][:]  # Assuming ssha_01_ku exists in all files</span>


    <span class="c1">#smoothing and subsampling</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">SAR_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lon_20_ku&#39;</span><span class="p">][:]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">SAR_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;lat_20_ku&#39;</span><span class="p">][:]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">SAR_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;time_20_ku&#39;</span><span class="p">][:]</span>
    <span class="n">ssha</span> <span class="o">=</span> <span class="n">SAR_data</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s1">&#39;ssha_20_ku&#39;</span><span class="p">][:]</span>  <span class="c1"># Assuming ssha_01_ku exists in all files</span>
    <span class="n">window_size</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">lon</span> <span class="o">=</span> <span class="n">running_mean</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)[::</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">lat</span> <span class="o">=</span> <span class="n">running_mean</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)[::</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">running_mean</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)[::</span><span class="mi">20</span><span class="p">]</span>
    <span class="n">ssha</span> <span class="o">=</span> <span class="n">running_mean</span><span class="p">(</span><span class="n">ssha</span><span class="p">,</span> <span class="n">window_size</span><span class="p">)[::</span><span class="mi">20</span><span class="p">]</span>


    <span class="c1"># Convert time to datetime objects</span>
    <span class="n">base_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">datetimes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">base_time</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">time</span><span class="p">])</span>

    <span class="c1"># Convert lon, lat to EASE-2 Grid</span>
    <span class="n">transformer</span> <span class="o">=</span> <span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span><span class="s2">&quot;+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs&quot;</span><span class="p">,</span>
                                       <span class="s2">&quot;+proj=laea +lon_0=0 +lat_0=-90 +x_0=0 +y_0=0 +ellps=WGS84 +units=m +no_defs&quot;</span><span class="p">)</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>

    <span class="c1"># Create a DataFrame for this file</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
        <span class="s1">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
        <span class="s1">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
        <span class="s1">&#39;t&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">datetimes</span><span class="p">)</span> <span class="o">-</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timestamp</span><span class="p">(</span><span class="s2">&quot;1970-01-01&quot;</span><span class="p">))</span> <span class="o">/</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">(</span><span class="s1">&#39;1D&#39;</span><span class="p">),</span>
        <span class="s1">&#39;obs&#39;</span><span class="p">:</span> <span class="n">ssha</span><span class="p">,</span>
    <span class="p">})</span>

    <span class="c1"># Drop rows where &#39;obs&#39; is NaN</span>
    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Append to the all_data_df DataFrame</span>
    <span class="n">all_data_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">all_data_df</span><span class="p">,</span> <span class="n">df</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Now all_data_df contains concatenated data from all files</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_data_df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                 x             y             t      obs
0    -1.158352e+06 -2.326781e+06  19358.786713  0.00040
1    -1.153165e+06 -2.322564e+06  19358.786725 -0.00385
2    -1.147980e+06 -2.318345e+06  19358.786736 -0.00705
3    -1.142795e+06 -2.314125e+06  19358.786748 -0.00705
4    -1.137610e+06 -2.309902e+06  19358.786759 -0.00675
...            ...           ...           ...      ...
4946  1.307158e+06 -3.217842e+06  19368.517847  0.01555
4947  1.311551e+06 -3.222704e+06  19368.517859  0.03775
4948  1.315944e+06 -3.227565e+06  19368.517870  0.10420
4949  1.320338e+06 -3.232424e+06  19368.517882  0.13745
4950  1.324732e+06 -3.237280e+06  19368.517894  0.15085

[4951 rows x 4 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/&#39;</span>

<span class="c1"># Assuming all_data_df is your DataFrame</span>
<span class="n">all_data_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;all_data_20.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_data_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-80193d5a-574d-4332-8dae-92f1b67fbeac" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>obs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.158352e+06</td>
      <td>-2.326781e+06</td>
      <td>19358.786713</td>
      <td>0.00040</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.153165e+06</td>
      <td>-2.322564e+06</td>
      <td>19358.786725</td>
      <td>-0.00385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.147980e+06</td>
      <td>-2.318345e+06</td>
      <td>19358.786736</td>
      <td>-0.00705</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.142795e+06</td>
      <td>-2.314125e+06</td>
      <td>19358.786748</td>
      <td>-0.00705</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.137610e+06</td>
      <td>-2.309902e+06</td>
      <td>19358.786759</td>
      <td>-0.00675</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4946</th>
      <td>1.307158e+06</td>
      <td>-3.217842e+06</td>
      <td>19368.517847</td>
      <td>0.01555</td>
    </tr>
    <tr>
      <th>4947</th>
      <td>1.311551e+06</td>
      <td>-3.222704e+06</td>
      <td>19368.517859</td>
      <td>0.03775</td>
    </tr>
    <tr>
      <th>4948</th>
      <td>1.315944e+06</td>
      <td>-3.227565e+06</td>
      <td>19368.517870</td>
      <td>0.10420</td>
    </tr>
    <tr>
      <th>4949</th>
      <td>1.320338e+06</td>
      <td>-3.232424e+06</td>
      <td>19368.517882</td>
      <td>0.13745</td>
    </tr>
    <tr>
      <th>4950</th>
      <td>1.324732e+06</td>
      <td>-3.237280e+06</td>
      <td>19368.517894</td>
      <td>0.15085</td>
    </tr>
  </tbody>
</table>
<p>4951 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-80193d5a-574d-4332-8dae-92f1b67fbeac')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-80193d5a-574d-4332-8dae-92f1b67fbeac button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-80193d5a-574d-4332-8dae-92f1b67fbeac');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-2a3a0e2c-3be2-4761-98ff-d7e00aba043c">
  <button class="colab-df-quickchart" onclick="quickchart('df-2a3a0e2c-3be2-4761-98ff-d7e00aba043c')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-2a3a0e2c-3be2-4761-98ff-d7e00aba043c button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeat</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84</span><span class="p">(</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">get_projection</span><span class="p">(</span><span class="s1">&#39;south&#39;</span><span class="p">))</span>

<span class="n">plot_pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">lon</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span>
                <span class="n">lat</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span>
                <span class="n">plot_data</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;example: binned obs&quot;</span><span class="p">,</span>
                <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="c1"># extent=[-180, 180, -90, -60],</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span>
                <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">171.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mi">77</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;plot_pcolormesh&#39;: 0.217 seconds
</pre></div>
</div>
<img alt="_images/edf192f68babb039cf31b79245ea52665e1e440c8789282aae4a028b48ad0658.png" src="_images/edf192f68babb039cf31b79245ea52665e1e440c8789282aae4a028b48ad0658.png" />
</div>
</div>
<p>Now we proceed with GPSat, with the same process we went through in week 7.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># TODO: allow for mounting of gdrive</span>
<span class="c1"># TODO: allow for checking out a branch</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">re</span>

    <span class="c1"># change to working directory</span>
    <span class="n">work_dir</span> <span class="o">=</span> <span class="s2">&quot;/content&quot;</span>

    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">work_dir</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;workspace directory: </span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

    <span class="c1"># clone repository</span>
    <span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/CPOMUCL/GPSat.git

    <span class="n">repo_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_dir</span><span class="p">,</span> <span class="s2">&quot;GPSat&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;changing directory to: </span><span class="si">{</span><span class="n">repo_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">repo_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>fatal: destination path &#39;GPSat&#39; already exists and is not an empty directory.
changing directory to: /content/GPSat
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ignoring gpflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Ignoring tensorflow: markers &#39;platform_system == &quot;Windows&quot;&#39; don&#39;t match your environment
Ignoring tensorflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;x86_64&quot;&#39; don&#39;t match your environment
Ignoring tensorflow-macos: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Collecting setuptools&gt;=68.2.2 (from -r requirements.txt (line 1))
  Downloading setuptools-69.1.1-py3-none-any.whl (819 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">819.3/819.3 kB</span> <span class=" -Color -Color-Red">11.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: astropy&gt;=5.1.1 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 2)) (5.3.4)
Requirement already satisfied: chardet&gt;=4.0.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 3)) (5.2.0)
Requirement already satisfied: pandas==1.5.3 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 4)) (1.5.3)
Collecting gpflow&gt;=2.9.0 (from -r requirements.txt (line 10))
  Downloading gpflow-2.9.1-py3-none-any.whl (380 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">380.6/380.6 kB</span> <span class=" -Color -Color-Red">19.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: tensorflow[and-cuda]&gt;=2.14.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 12)) (2.15.0)
Collecting gpytorch==1.10 (from -r requirements.txt (line 19))
  Downloading gpytorch-1.10-py3-none-any.whl (255 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">255.2/255.2 kB</span> <span class=" -Color -Color-Red">17.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: matplotlib&gt;=3.6.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 20)) (3.7.1)
Requirement already satisfied: scipy&gt;=1.9.3 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 21)) (1.11.4)
Requirement already satisfied: tables&gt;=3.7.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 22)) (3.8.0)
Collecting netCDF4==1.6.2 (from -r requirements.txt (line 23))
  Downloading netCDF4-1.6.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.1/5.1 MB</span> <span class=" -Color -Color-Red">24.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: xarray&gt;=2022.10.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 24)) (2023.7.0)
Requirement already satisfied: gast&gt;=0.4.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 25)) (0.5.4)
Requirement already satisfied: pyproj&gt;=3.4.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 26)) (3.6.1)
Requirement already satisfied: seaborn&gt;=0.11.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 27)) (0.13.1)
Collecting jupyter==1.0.0 (from -r requirements.txt (line 28))
  Downloading jupyter-1.0.0-py2.py3-none-any.whl (2.7 kB)
Requirement already satisfied: scikit-learn==1.2.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 29)) (1.2.2)
Requirement already satisfied: numba&gt;=0.56.4 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 30)) (0.58.1)
Collecting numpy&lt;=1.23.5 (from -r requirements.txt (line 31))
  Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">17.1/17.1 MB</span> <span class=" -Color -Color-Red">82.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: pytest&gt;=7.2.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 32)) (7.4.4)
Collecting dataclasses-json==0.5.7 (from -r requirements.txt (line 33))
  Downloading dataclasses_json-0.5.7-py3-none-any.whl (25 kB)
Collecting global-land-mask==1.0.0 (from -r requirements.txt (line 34))
  Downloading global_land_mask-1.0.0-py3-none-any.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.8/1.8 MB</span> <span class=" -Color -Color-Red">91.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: cartopy==0.22.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 35)) (0.22.0)
Requirement already satisfied: Sphinx&gt;=5.0.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 38)) (5.0.2)
Collecting nbsphinx&gt;=0.9.3 (from -r requirements.txt (line 39))
  Downloading nbsphinx-0.9.3-py3-none-any.whl (31 kB)
Collecting numpydoc&gt;=1.6.0 (from -r requirements.txt (line 40))
  Downloading numpydoc-1.6.0-py3-none-any.whl (61 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">61.7/61.7 kB</span> <span class=" -Color -Color-Red">7.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting sphinxemoji&gt;=0.2.0 (from -r requirements.txt (line 41))
  Downloading sphinxemoji-0.3.1-py3-none-any.whl (46 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">46.1/46.1 kB</span> <span class=" -Color -Color-Red">6.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting sphinx-rtd-theme&gt;=1.3.0 (from -r requirements.txt (line 42))
  Downloading sphinx_rtd_theme-2.0.0-py2.py3-none-any.whl (2.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">2.8/2.8 MB</span> <span class=" -Color -Color-Red">98.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 4)) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 4)) (2023.4)
Collecting linear-operator&gt;=0.4.0 (from gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading linear_operator-0.5.2-py3-none-any.whl (175 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">175.6/175.6 kB</span> <span class=" -Color -Color-Red">24.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: cftime in /usr/local/lib/python3.10/dist-packages (from netCDF4==1.6.2-&gt;-r requirements.txt (line 23)) (1.6.3)
Requirement already satisfied: notebook in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.5.5)
Collecting qtconsole (from jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading qtconsole-5.5.1-py3-none-any.whl (123 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">123.4/123.4 kB</span> <span class=" -Color -Color-Red">17.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: jupyter-console in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.0)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.5.4)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (5.5.6)
Requirement already satisfied: ipywidgets in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (7.7.1)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 29)) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 29)) (3.3.0)
Collecting marshmallow&lt;4.0.0,&gt;=3.3.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading marshmallow-3.21.1-py3-none-any.whl (49 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">49.4/49.4 kB</span> <span class=" -Color -Color-Red">6.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting marshmallow-enum&lt;2.0.0,&gt;=1.5.1 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading marshmallow_enum-1.5.1-py2.py3-none-any.whl (4.2 kB)
Collecting typing-inspect&gt;=0.4.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)
Requirement already satisfied: shapely&gt;=1.7 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (2.0.3)
Requirement already satisfied: packaging&gt;=20 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (23.2)
Requirement already satisfied: pyshp&gt;=2.1 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (2.3.1)
Requirement already satisfied: pyerfa&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 2)) (2.0.1.1)
Requirement already satisfied: PyYAML&gt;=3.13 in /usr/local/lib/python3.10/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 2)) (6.0.1)
Collecting check-shapes&gt;=1.0.0 (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading check_shapes-1.1.1-py3-none-any.whl (45 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">45.8/45.8 kB</span> <span class=" -Color -Color-Red">5.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting deprecated (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading Deprecated-1.2.14-py2.py3-none-any.whl (9.6 kB)
Requirement already satisfied: multipledispatch&gt;=0.6 in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (1.0.0)
Requirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.9.0)
Requirement already satisfied: tensorflow-probability&gt;=0.12.0 in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.23.0)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (4.10.0)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (23.5.26)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.2.0)
Requirement already satisfied: h5py&gt;=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.9.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (16.0.6)
Requirement already satisfied: ml-dtypes~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.2.0)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.3.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.20.3)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.16.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.4.0)
Requirement already satisfied: wrapt&lt;1.15,&gt;=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.14.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.36.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.62.0)
Requirement already satisfied: tensorboard&lt;2.16,&gt;=2.15 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.2)
Requirement already satisfied: tensorflow-estimator&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.0)
Requirement already satisfied: keras&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.0)
Collecting nvidia-cublas-cu12==12.2.5.6 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cublas_cu12-12.2.5.6-py3-none-manylinux1_x86_64.whl (417.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">417.8/417.8 MB</span> <span class=" -Color -Color-Red">3.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-cupti-cu12==12.2.142 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_cupti_cu12-12.2.142-py3-none-manylinux1_x86_64.whl (13.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">13.9/13.9 MB</span> <span class=" -Color -Color-Red">90.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-nvcc-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_nvcc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (21.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">21.3/21.3 MB</span> <span class=" -Color -Color-Red">39.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-nvrtc-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_nvrtc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (23.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">23.4/23.4 MB</span> <span class=" -Color -Color-Red">36.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-runtime-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_runtime_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (845 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">845.8/845.8 kB</span> <span class=" -Color -Color-Red">71.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cudnn-cu12==8.9.4.25 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cudnn_cu12-8.9.4.25-py3-none-manylinux1_x86_64.whl (720.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">720.1/720.1 MB</span> <span class=" -Color -Color-Red">2.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cufft-cu12==11.0.8.103 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cufft_cu12-11.0.8.103-py3-none-manylinux1_x86_64.whl (98.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">98.6/98.6 MB</span> <span class=" -Color -Color-Red">16.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-curand-cu12==10.3.3.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_curand_cu12-10.3.3.141-py3-none-manylinux1_x86_64.whl (56.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">56.5/56.5 MB</span> <span class=" -Color -Color-Red">29.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cusolver-cu12==11.5.2.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cusolver_cu12-11.5.2.141-py3-none-manylinux1_x86_64.whl (124.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">124.9/124.9 MB</span> <span class=" -Color -Color-Red">7.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cusparse-cu12==12.1.2.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cusparse_cu12-12.1.2.141-py3-none-manylinux1_x86_64.whl (195.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">195.3/195.3 MB</span> <span class=" -Color -Color-Red">3.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-nccl-cu12==2.16.5 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_nccl_cu12-2.16.5-py3-none-manylinux1_x86_64.whl (188.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">188.7/188.7 MB</span> <span class=" -Color -Color-Red">5.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-nvjitlink-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_nvjitlink_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (20.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">20.2/20.2 MB</span> <span class=" -Color -Color-Red">76.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting tensorrt==8.6.1.post1 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading tensorrt-8.6.1.post1.tar.gz (18 kB)
  Preparing metadata (setup.py) ... ?25l?25hdone
Collecting tensorrt-bindings==8.6.1 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading tensorrt_bindings-8.6.1-cp310-none-manylinux_2_17_x86_64.whl (979 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">979.4/979.4 kB</span> <span class=" -Color -Color-Red">65.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hINFO: pip is looking at multiple versions of tensorflow[and-cuda] to determine which version is compatible with other requirements. This could take a while.
Collecting tensorflow[and-cuda]&gt;=2.14.0 (from -r requirements.txt (line 12))
  Downloading tensorflow-2.15.0.post1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (475.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">475.2/475.2 MB</span> <span class=" -Color -Color-Red">3.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (1.4.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (3.1.1)
Requirement already satisfied: cython&gt;=0.29.21 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (3.0.9)
Requirement already satisfied: numexpr&gt;=2.6.2 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (2.9.0)
Requirement already satisfied: blosc2~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (2.0.0)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (9.0.0)
Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from pyproj&gt;=3.4.0-&gt;-r requirements.txt (line 26)) (2024.2.2)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&gt;=0.56.4-&gt;-r requirements.txt (line 30)) (0.41.1)
Requirement already satisfied: iniconfig in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (2.0.0)
Requirement already satisfied: pluggy&lt;2.0,&gt;=0.12 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (1.4.0)
Requirement already satisfied: exceptiongroup&gt;=1.0.0rc8 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (1.2.0)
Requirement already satisfied: tomli&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (2.0.1)
Requirement already satisfied: sphinxcontrib-applehelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.8)
Requirement already satisfied: sphinxcontrib-devhelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.6)
Requirement already satisfied: sphinxcontrib-jsmath in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.1)
Requirement already satisfied: sphinxcontrib-htmlhelp&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.0.5)
Requirement already satisfied: sphinxcontrib-serializinghtml&gt;=1.1.5 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.1.10)
Requirement already satisfied: sphinxcontrib-qthelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.7)
Requirement already satisfied: Jinja2&gt;=2.3 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.1.3)
Requirement already satisfied: Pygments&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.16.1)
Requirement already satisfied: docutils&lt;0.19,&gt;=0.14 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (0.18.1)
Requirement already satisfied: snowballstemmer&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.2.0)
Requirement already satisfied: babel&gt;=1.3 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.14.0)
Requirement already satisfied: alabaster&lt;0.8,&gt;=0.7 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (0.7.16)
Requirement already satisfied: imagesize in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.4.1)
Requirement already satisfied: requests&gt;=2.5.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.31.0)
Requirement already satisfied: traitlets&gt;=5 in /usr/local/lib/python3.10/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (5.7.1)
Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (5.9.2)
Collecting sphinxcontrib-jquery&lt;5,&gt;=4 (from sphinx-rtd-theme&gt;=1.3.0-&gt;-r requirements.txt (line 42))
  Downloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl (121 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">121.1/121.1 kB</span> <span class=" -Color -Color-Red">15.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.42.0)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from blosc2~=2.0.0-&gt;tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (1.0.8)
Collecting dropstackframe&gt;=0.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading dropstackframe-0.1.0-py3-none-any.whl (4.5 kB)
Collecting lark&lt;2.0.0,&gt;=1.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading lark-1.1.9-py3-none-any.whl (111 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">111.7/111.7 kB</span> <span class=" -Color -Color-Red">15.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2&gt;=2.3-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.1.5)
Requirement already satisfied: torch&gt;=1.11 in /usr/local/lib/python3.10/dist-packages (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2.1.0+cu121)
Collecting jaxtyping&gt;=0.2.9 (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading jaxtyping-0.2.28-py3-none-any.whl (40 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">40.7/40.7 kB</span> <span class=" -Color -Color-Red">5.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting typeguard~=2.13.3 (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading typeguard-2.13.3-py3-none-any.whl (17 kB)
Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.9.4)
Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.12.3)
Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.1)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.4)
Requirement already satisfied: jupyter-core&gt;=4.7 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (5.7.1)
Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.3.0)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.8.4)
Requirement already satisfied: nbclient&gt;=0.5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.9.0)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.5.1)
Requirement already satisfied: tinycss2 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.2.1)
Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.10/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (2.19.1)
Requirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (4.19.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.0.7)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.27.0)
Requirement already satisfied: google-auth-oauthlib&lt;2,&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.2.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.5.2)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.0.1)
Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (4.4.2)
Requirement already satisfied: cloudpickle&gt;=1.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (2.2.1)
Requirement already satisfied: dm-tree in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.1.8)
Collecting mypy-extensions&gt;=0.3.0 (from typing-inspect&gt;=0.4.0-&gt;dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading mypy_extensions-1.0.0-py3-none-any.whl (4.7 kB)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.0)
Requirement already satisfied: ipython&gt;=5.0.0 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (7.34.0)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.12)
Requirement already satisfied: tornado&gt;=4.2 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.3.3)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.6.6)
Requirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.0.10)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.0.43)
Requirement already satisfied: pyzmq&lt;25,&gt;=17 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (23.2.1)
Requirement already satisfied: argon2-cffi in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (23.1.0)
Requirement already satisfied: nest-asyncio&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.6.0)
Requirement already satisfied: Send2Trash&gt;=1.8.0 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.8.2)
Requirement already satisfied: terminado&gt;=0.8.3 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.18.0)
Requirement already satisfied: prometheus-client in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.20.0)
Requirement already satisfied: nbclassic&gt;=0.4.7 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.0.0)
Collecting qtpy&gt;=2.4.0 (from qtconsole-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading QtPy-2.4.1-py3-none-any.whl (93 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">93.5/93.5 kB</span> <span class=" -Color -Color-Red">13.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (5.3.3)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.3.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.3.1)
Collecting jedi&gt;=0.16 (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.6/1.6 MB</span> <span class=" -Color -Color-Red">74.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.5)
Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.0)
Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.1.6)
Requirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.9.0)
Requirement already satisfied: attrs&gt;=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (23.2.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (2023.12.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (0.33.0)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (0.18.0)
Requirement already satisfied: platformdirs&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core&gt;=4.7-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.2.0)
Requirement already satisfied: jupyter-server&gt;=1.8 in /usr/local/lib/python3.10/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.24.0)
Requirement already satisfied: notebook-shim&gt;=0.2.3 in /usr/local/lib/python3.10/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.4)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.13)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.10/dist-packages (from terminado&gt;=0.8.3-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (3.13.1)
Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (1.12)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (3.2.1)
Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2023.6.0)
Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2.1.0)
Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (21.2.0)
Requirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (2.5)
Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.5.1)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.8.3)
Requirement already satisfied: anyio&lt;4,&gt;=3.1.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.7.1)
Requirement already satisfied: websocket-client in /usr/local/lib/python3.10/dist-packages (from jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.7.0)
Requirement already satisfied: pyasn1&lt;0.6.0,&gt;=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.5.1)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.2.2)
Requirement already satisfied: cffi&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.16.0)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy-&gt;torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (1.3.0)
Requirement already satisfied: sniffio&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio&lt;4,&gt;=3.1.0-&gt;jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.3.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi&gt;=1.0.1-&gt;argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (2.21)
Installing collected packages: global-land-mask, typeguard, setuptools, qtpy, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-nvcc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, mypy-extensions, marshmallow, lark, jedi, dropstackframe, deprecated, typing-inspect, nvidia-cusparse-cu12, nvidia-cudnn-cu12, marshmallow-enum, jaxtyping, check-shapes, sphinxemoji, sphinxcontrib-jquery, nvidia-cusolver-cu12, numpydoc, netCDF4, linear-operator, dataclasses-json, sphinx-rtd-theme, qtconsole, gpytorch, tensorflow, gpflow, nbsphinx, jupyter
  Attempting uninstall: setuptools
    Found existing installation: setuptools 67.7.2
    Uninstalling setuptools-67.7.2:
      Successfully uninstalled setuptools-67.7.2
  Attempting uninstall: numpy
    Found existing installation: numpy 1.25.2
    Uninstalling numpy-1.25.2:
      Successfully uninstalled numpy-1.25.2
  Attempting uninstall: netCDF4
    Found existing installation: netCDF4 1.6.5
    Uninstalling netCDF4-1.6.5:
      Successfully uninstalled netCDF4-1.6.5
  Attempting uninstall: tensorflow
    Found existing installation: tensorflow 2.15.0
    Uninstalling tensorflow-2.15.0:
      Successfully uninstalled tensorflow-2.15.0
<span class=" -Color -Color-Red">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.</span>
<span class=" -Color -Color-Red">chex 0.1.85 requires numpy&gt;=1.24.1, but you have numpy 1.23.5 which is incompatible.</span>
Successfully installed check-shapes-1.1.1 dataclasses-json-0.5.7 deprecated-1.2.14 dropstackframe-0.1.0 global-land-mask-1.0.0 gpflow-2.9.1 gpytorch-1.10 jaxtyping-0.2.28 jedi-0.19.1 jupyter-1.0.0 lark-1.1.9 linear-operator-0.5.2 marshmallow-3.21.1 marshmallow-enum-1.5.1 mypy-extensions-1.0.0 nbsphinx-0.9.3 netCDF4-1.6.2 numpy-1.23.5 numpydoc-1.6.0 nvidia-cublas-cu12-12.2.5.6 nvidia-cuda-cupti-cu12-12.2.142 nvidia-cuda-nvcc-cu12-12.2.140 nvidia-cuda-nvrtc-cu12-12.2.140 nvidia-cuda-runtime-cu12-12.2.140 nvidia-cudnn-cu12-8.9.4.25 nvidia-cufft-cu12-11.0.8.103 nvidia-curand-cu12-10.3.3.141 nvidia-cusolver-cu12-11.5.2.141 nvidia-cusparse-cu12-12.1.2.141 nvidia-nccl-cu12-2.16.5 nvidia-nvjitlink-cu12-12.2.140 qtconsole-5.5.1 qtpy-2.4.1 setuptools-69.1.1 sphinx-rtd-theme-2.0.0 sphinxcontrib-jquery-4.1 sphinxemoji-0.3.1 tensorflow-2.15.0.post1 typeguard-2.13.3 typing-inspect-0.9.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Obtaining file:///content/GPSat
  Preparing metadata (setup.py) ... ?25l?25hdone
Installing collected packages: GPSat
  Running setup.py develop for GPSat
Successfully installed GPSat-0.0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">GPSat</span> <span class="kn">import</span> <span class="n">get_data_path</span><span class="p">,</span> <span class="n">get_parent_path</span>
<span class="kn">from</span> <span class="nn">GPSat.dataprepper</span> <span class="kn">import</span> <span class="n">DataPrep</span>
<span class="kn">from</span> <span class="nn">GPSat.utils</span> <span class="kn">import</span> <span class="n">WGS84toEASE2_New</span><span class="p">,</span> <span class="n">EASE2toWGS84_New</span><span class="p">,</span> <span class="n">cprint</span><span class="p">,</span> <span class="n">grid_2d_flatten</span><span class="p">,</span> <span class="n">get_weighted_values</span>
<span class="kn">from</span> <span class="nn">GPSat.local_experts</span> <span class="kn">import</span> <span class="n">LocalExpertOI</span><span class="p">,</span> <span class="n">get_results_from_h5file</span>
<span class="kn">from</span> <span class="nn">GPSat.plot_utils</span> <span class="kn">import</span> <span class="n">plot_pcolormesh</span><span class="p">,</span> <span class="n">get_projection</span><span class="p">,</span> <span class="n">plot_pcolormesh_from_results_data</span>
<span class="kn">from</span> <span class="nn">GPSat.config_dataclasses</span> <span class="kn">import</span> <span class="n">DataConfig</span><span class="p">,</span> <span class="n">ModelConfig</span><span class="p">,</span> <span class="n">PredictionLocsConfig</span><span class="p">,</span> <span class="n">ExpertLocsConfig</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions_2d</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># savepath = &#39;/Users/wg4031/Downloads/&#39;</span>
<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/&#39;</span>

<span class="c1"># Load DataFrame from CSV file</span>
<span class="c1"># df = pd.read_csv(savepath+&#39;all_data_01.csv&#39;)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;all_data_20.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d2a87359-0859-4696-b275-a07e26f136e1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>obs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1.158352e+06</td>
      <td>-2.326781e+06</td>
      <td>19358.786713</td>
      <td>0.00040</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-1.153165e+06</td>
      <td>-2.322564e+06</td>
      <td>19358.786725</td>
      <td>-0.00385</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-1.147980e+06</td>
      <td>-2.318345e+06</td>
      <td>19358.786736</td>
      <td>-0.00705</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-1.142795e+06</td>
      <td>-2.314125e+06</td>
      <td>19358.786748</td>
      <td>-0.00705</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-1.137610e+06</td>
      <td>-2.309902e+06</td>
      <td>19358.786759</td>
      <td>-0.00675</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4946</th>
      <td>1.307158e+06</td>
      <td>-3.217842e+06</td>
      <td>19368.517847</td>
      <td>0.01555</td>
    </tr>
    <tr>
      <th>4947</th>
      <td>1.311551e+06</td>
      <td>-3.222704e+06</td>
      <td>19368.517859</td>
      <td>0.03775</td>
    </tr>
    <tr>
      <th>4948</th>
      <td>1.315944e+06</td>
      <td>-3.227565e+06</td>
      <td>19368.517870</td>
      <td>0.10420</td>
    </tr>
    <tr>
      <th>4949</th>
      <td>1.320338e+06</td>
      <td>-3.232424e+06</td>
      <td>19368.517882</td>
      <td>0.13745</td>
    </tr>
    <tr>
      <th>4950</th>
      <td>1.324732e+06</td>
      <td>-3.237280e+06</td>
      <td>19368.517894</td>
      <td>0.15085</td>
    </tr>
  </tbody>
</table>
<p>4951 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d2a87359-0859-4696-b275-a07e26f136e1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d2a87359-0859-4696-b275-a07e26f136e1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d2a87359-0859-4696-b275-a07e26f136e1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-4ceb2628-f1e6-48ed-b13d-71c3b80d29ef">
  <button class="colab-df-quickchart" onclick="quickchart('df-4ceb2628-f1e6-48ed-b13d-71c3b80d29ef')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-4ceb2628-f1e6-48ed-b13d-71c3b80d29ef button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_Eddy</span><span class="p">,</span> <span class="n">y_Eddy</span> <span class="o">=</span> <span class="n">WGS84toEASE2_New</span><span class="p">(</span><span class="n">lon</span><span class="o">=-</span><span class="mf">171.5</span><span class="p">,</span> <span class="n">lat</span><span class="o">=-</span><span class="mi">77</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-64-571f612af049&gt;:1: DeprecationWarning: Call to deprecated function (or staticmethod) WGS84toEASE2_New. (This function will be removed in future versions. Use `WGS84toEASE2` instead.)
  x_Eddy, y_Eddy = WGS84toEASE2_New(lon=-171.5, lat=-77,lat_0=-90)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plt.scatter(df[&#39;lon&#39;][df[&#39;lon&#39;]&lt;-150][df[&#39;lat&#39;]&lt;-72],df[&#39;lat&#39;][df[&#39;lon&#39;]&lt;-150][df[&#39;lat&#39;]&lt;-72])</span>
<span class="c1"># plt.scatter(-171.5, -77, marker = &#39;x&#39;, color=&#39;red&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span> <span class="n">y_Eddy</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fa52c626980&gt;
</pre></div>
</div>
<img alt="_images/b594d09b0993823c1608834bb7e3a34d9350d35bd9c82e1d9a3d040ab7edad0e.png" src="_images/b594d09b0993823c1608834bb7e3a34d9350d35bd9c82e1d9a3d040ab7edad0e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># condition=[df[&#39;x&#39;]&lt;200000.0][df[&#39;x&#39;]&gt;-600000.0][df[&#39;y&#39;]&lt;-1000000.0][df[&#39;y&#39;]&gt;-1800000.0]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">200000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">600000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">1000000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">1800000.0</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">200000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">600000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">1000000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">1800000.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span> <span class="n">y_Eddy</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fa52c5dc8b0&gt;
</pre></div>
</div>
<img alt="_images/76b72552774a346b45f6bf4b5935b895f381814bdbf7b3bcf74db0a560ab1daa.png" src="_images/76b72552774a346b45f6bf4b5935b895f381814bdbf7b3bcf74db0a560ab1daa.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># condition=[df[&#39;x&#39;]&lt;200000.0][df[&#39;x&#39;]&gt;-600000.0][df[&#39;y&#39;]&lt;-1000000.0][df[&#39;y&#39;]&gt;-1800000.0]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">100000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">300000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">1350000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">1550000.0</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">100000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">300000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&lt;-</span><span class="mf">1350000.0</span><span class="p">][</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">&gt;-</span><span class="mf">1550000.0</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span> <span class="n">y_Eddy</span><span class="p">,</span> <span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7fa52c2c1660&gt;
</pre></div>
</div>
<img alt="_images/8d59ae1e9528505b505e2604d03249e50d35ac022c0b0f4562f708d39a3becd2.png" src="_images/8d59ae1e9528505b505e2604d03249e50d35ac022c0b0f4562f708d39a3becd2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0       19358.786713
1       19358.786725
2       19358.786736
3       19358.786748
4       19358.786759
            ...     
3104    19368.517859
3105    19368.517870
3106    19368.517882
3107    19368.517894
3108    19368.517905
Name: t, Length: 3109, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># - spaced every 10km for some x,y range</span>
<span class="c1"># xy_grid = grid_2d_flatten(x_range=[-600000.0, 200000.0],</span>
<span class="c1">#                           y_range=[-1800000.0, -1000000.0],</span>
<span class="c1">#                           step_size=100_000)</span>
<span class="n">xy_grid</span> <span class="o">=</span> <span class="n">grid_2d_flatten</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">300000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100000.0</span><span class="p">],</span>
                          <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1550000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1350000.0</span><span class="p">],</span>
                          <span class="n">step_size</span><span class="o">=</span><span class="mi">20_000</span><span class="p">)</span>



<span class="c1"># store in dataframe</span>
<span class="n">eloc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy_grid</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># add a time coordinate</span>
<span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Local expert locations:&quot;</span><span class="p">)</span>
<span class="n">eloc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Local expert locations:
</pre></div>
</div>
<div class="output text_html">
  <div id="df-9b48e620-a4ea-461a-9aa6-ea406b6fa7bd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-290000.0</td>
      <td>-1540000.0</td>
      <td>19363.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-270000.0</td>
      <td>-1540000.0</td>
      <td>19363.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-250000.0</td>
      <td>-1540000.0</td>
      <td>19363.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-230000.0</td>
      <td>-1540000.0</td>
      <td>19363.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-210000.0</td>
      <td>-1540000.0</td>
      <td>19363.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9b48e620-a4ea-461a-9aa6-ea406b6fa7bd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9b48e620-a4ea-461a-9aa6-ea406b6fa7bd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9b48e620-a4ea-461a-9aa6-ea406b6fa7bd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-d6717ac8-56e7-4974-8f04-cd11b5346395">
  <button class="colab-df-quickchart" onclick="quickchart('df-d6717ac8-56e7-4974-8f04-cd11b5346395')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-d6717ac8-56e7-4974-8f04-cd11b5346395 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot expert locations</span>
<span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">get_projection</span><span class="p">(</span><span class="s1">&#39;south&#39;</span><span class="p">))</span>

<span class="n">plot_pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">lon</span><span class="o">=</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span>
                <span class="n">lat</span><span class="o">=</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span>
                <span class="n">plot_data</span><span class="o">=</span><span class="mi">0</span><span class="o">*</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;expert locations&quot;</span><span class="p">,</span>
                <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span>
                <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plot_pcolormesh</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                <span class="n">lon</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span>
                <span class="n">lat</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span>
                <span class="n">plot_data</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span>
                <span class="n">title</span><span class="o">=</span><span class="s2">&quot;example: binned obs&quot;</span><span class="p">,</span>
                <span class="n">scatter</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span>
                <span class="c1"># extent=[-180, 180, -90, -60],</span>
                <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">150</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span>
                <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="mf">171.5</span><span class="p">,</span> <span class="n">y</span><span class="o">=-</span><span class="mi">77</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-72-543cd1096308&gt;:2: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  eloc[&#39;lon&#39;], eloc[&#39;lat&#39;] = EASE2toWGS84_New(eloc[&#39;x&#39;], eloc[&#39;y&#39;],lat_0=-90)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;plot_pcolormesh&#39;: 0.010 seconds
&#39;plot_pcolormesh&#39;: 0.033 seconds
</pre></div>
</div>
<img alt="_images/4ce1ab0e4168d6b399ca2a9fd3b9cf3e3b84ded8d32b5772e933b605f75e8fa1.png" src="_images/4ce1ab0e4168d6b399ca2a9fd3b9cf3e3b84ded8d32b5772e933b605f75e8fa1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># - spaced every 5km</span>


<span class="c1"># xy_grid = grid_2d_flatten(x_range=[-600000.0, 200000.0],</span>
<span class="c1">#                           y_range=[-1800000.0, -1000000.0],</span>
<span class="c1">#                           step_size=10_000)</span>

<span class="n">xy_grid</span> <span class="o">=</span> <span class="n">grid_2d_flatten</span><span class="p">(</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">300000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100000.0</span><span class="p">],</span>
                          <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">1550000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1350000.0</span><span class="p">],</span>
                          <span class="n">step_size</span><span class="o">=</span><span class="mi">5_000</span><span class="p">)</span>


<span class="c1"># store in dataframe</span>
<span class="c1"># NOTE: the missing &#39;t&#39; coordinate will be determine by the expert location</span>
<span class="c1"># - alternatively the prediction location can be specified</span>
<span class="n">ploc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">xy_grid</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="c1"># Add lon-lat measurements</span>
<span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span> <span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Prediction locations:&quot;</span><span class="p">)</span>
<span class="n">ploc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Prediction locations:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-73-ddfe51deed04&gt;:19: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  ploc[&#39;lon&#39;], ploc[&#39;lat&#39;] = EASE2toWGS84_New(ploc[&#39;x&#39;], ploc[&#39;y&#39;], lat_0=-90)
</pre></div>
</div>
<div class="output text_html">
  <div id="df-97bfc04d-2663-4acb-8bfb-3bf361379713" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>lon</th>
      <th>lat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-297500.0</td>
      <td>-1547500.0</td>
      <td>-169.117906</td>
      <td>-75.852711</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-292500.0</td>
      <td>-1547500.0</td>
      <td>-169.296538</td>
      <td>-75.861163</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-287500.0</td>
      <td>-1547500.0</td>
      <td>-169.475381</td>
      <td>-75.869477</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-282500.0</td>
      <td>-1547500.0</td>
      <td>-169.654432</td>
      <td>-75.877652</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-277500.0</td>
      <td>-1547500.0</td>
      <td>-169.833687</td>
      <td>-75.885688</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1595</th>
      <td>-122500.0</td>
      <td>-1352500.0</td>
      <td>-174.824670</td>
      <td>-77.816683</td>
    </tr>
    <tr>
      <th>1596</th>
      <td>-117500.0</td>
      <td>-1352500.0</td>
      <td>-175.034829</td>
      <td>-77.820664</td>
    </tr>
    <tr>
      <th>1597</th>
      <td>-112500.0</td>
      <td>-1352500.0</td>
      <td>-175.245123</td>
      <td>-77.824480</td>
    </tr>
    <tr>
      <th>1598</th>
      <td>-107500.0</td>
      <td>-1352500.0</td>
      <td>-175.455545</td>
      <td>-77.828131</td>
    </tr>
    <tr>
      <th>1599</th>
      <td>-102500.0</td>
      <td>-1352500.0</td>
      <td>-175.666091</td>
      <td>-77.831617</td>
    </tr>
  </tbody>
</table>
<p>1600 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-97bfc04d-2663-4acb-8bfb-3bf361379713')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-97bfc04d-2663-4acb-8bfb-3bf361379713 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-97bfc04d-2663-4acb-8bfb-3bf361379713');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a9d198f8-eaa0-47e1-8620-10fa38e70cee">
  <button class="colab-df-quickchart" onclick="quickchart('df-a9d198f8-eaa0-47e1-8620-10fa38e70cee')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a9d198f8-eaa0-47e1-8620-10fa38e70cee button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set training and inference radius</span>
<span class="n">training_radius</span> <span class="o">=</span> <span class="mi">100_000</span>   <span class="c1"># 300km</span>
<span class="n">inference_radius</span> <span class="o">=</span> <span class="mi">50_000</span>  <span class="c1"># 200km</span>

<span class="c1"># Local expert locations config</span>
<span class="n">local_expert</span> <span class="o">=</span> <span class="n">ExpertLocsConfig</span><span class="p">(</span><span class="n">source</span> <span class="o">=</span> <span class="n">eloc</span><span class="p">)</span>

<span class="c1"># Model config</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ModelConfig</span><span class="p">(</span><span class="n">oi_model</span> <span class="o">=</span> <span class="s2">&quot;GPflowSVGPModel&quot;</span><span class="p">,</span> <span class="c1"># Use GPflow SVGP model</span>
<span class="c1"># model = ModelConfig(oi_model = &quot;GPflowGPRModel&quot;, # Use GPflow GPR model</span>
                    <span class="n">init_params</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="c1"># normalise xy coordinates by 50km</span>
                        <span class="s2">&quot;coords_scale&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10_000</span><span class="p">,</span> <span class="mi">10_000</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
                        <span class="p">},</span>
                    <span class="n">constraints</span> <span class="o">=</span> <span class="p">{</span>
                        <span class="c1"># set bounds on the lengthscale hyperparameters</span>
                        <span class="s2">&quot;lengthscales&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1e-08</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">],</span>
                            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">600_000</span><span class="p">,</span> <span class="mi">600_000</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
                        <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">)</span>

<span class="c1"># Data config</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">DataConfig</span><span class="p">(</span><span class="n">data_source</span> <span class="o">=</span> <span class="n">df</span><span class="p">,</span>
                  <span class="n">obs_col</span> <span class="o">=</span> <span class="s2">&quot;obs&quot;</span><span class="p">,</span>
                  <span class="n">coords_col</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span>
                  <span class="n">local_select</span> <span class="o">=</span> <span class="p">[</span>
                    <span class="c1"># Select data within 300km and ± 4 days of the expert location</span>
                    <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
                    <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">},</span>
                    <span class="p">{</span><span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span> <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;&quot;</span><span class="p">,</span> <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="n">training_radius</span><span class="p">}</span>
                  <span class="p">]</span>
                <span class="p">)</span>

<span class="c1"># Prediction locs config</span>
<span class="n">pred_loc</span> <span class="o">=</span> <span class="n">PredictionLocsConfig</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;from_dataframe&quot;</span><span class="p">,</span>
                                <span class="n">df</span> <span class="o">=</span> <span class="n">ploc</span><span class="p">,</span>
                                <span class="n">max_dist</span> <span class="o">=</span> <span class="n">inference_radius</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">locexp</span> <span class="o">=</span> <span class="n">LocalExpertOI</span><span class="p">(</span><span class="n">expert_loc_config</span> <span class="o">=</span> <span class="n">local_expert</span><span class="p">,</span>
                       <span class="n">data_config</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                       <span class="n">model_config</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
                       <span class="n">pred_loc_config</span> <span class="o">=</span> <span class="n">pred_loc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.001 seconds
in json_serializable - key: &#39;data_source&#39; has value DataFrame/Series, but is too long: 4951 &gt;  100
storing as str
in json_serializable - key: &#39;df&#39; has value DataFrame/Series, but is too long: 1600 &gt;  100
storing as str
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># path to store results</span>
<span class="n">store_path</span> <span class="o">=</span> <span class="n">get_parent_path</span><span class="p">(</span><span class="s2">&quot;results&quot;</span><span class="p">,</span> <span class="s2">&quot;inline_example.h5&quot;</span><span class="p">)</span>

<span class="c1"># for the purposes of a simple example, if store_path exists: delete it</span>
<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">store_path</span><span class="p">):</span>
    <span class="n">cprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;removing: </span><span class="si">{</span><span class="n">store_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span>

<span class="c1"># run optimal interpolation</span>
<span class="n">locexp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>removing: /content/GPSat/results/inline_example.h5
---------
storing expert locations in &#39;expert_locs&#39; table
exception occurred: &#39;No object named expert_locs in the file&#39;
will now close object

---------
dropping expert locations that already exists in &#39;run_details&#39; table
exception occurred: &#39;No object named run_details in the file&#39;
will now close object

<span class=" -Color -Color-Bold">--------------------------------------------------</span>
1 / 100
current local expert:
          x          y        t         lon        lat
0 -290000.0 -1540000.0  19363.0 -169.335424 -75.931873
&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.001 seconds
&#39;local_data_select&#39;: 0.004 seconds
number obs: 147
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;get_parameters&#39;: 0.015 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.489 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([ 5.73603468, 11.88452296,  5.89918771]) 
kernel_variance: 3.173034700731461
likelihood_variance: 1.9843067651399535
inducing_points: array([[  -30.69556014,  -144.37483449, 19359.49429398],
       [  -30.35830177,  -144.96485556, 19359.49430556],
       [  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028]]) (truncated) 
inducing_mean: array([[2.39984139],
       [2.43004593],
       [2.46358823],
       [2.48424085],
       [2.50465579]]) (truncated) 
inducing_chol: array([[[ 3.70859418e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.32312812e-01,  7.33186669e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.76041826e-01, -3.32755542e-01,  8.62687467e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.14565838e-03,  3.68877991e-04, -2.62446597e-04, ...,
          9.57464042e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.37190427e-03,  3.80177900e-04, -2.90927952e-04, ...,
         -5.88841824e-02,  9.80439656e-01,  0.00000000e+00],
        [-6.30086253e-04,  6.05590038e-05,  7.62812225e-04, ...,
         -1.85762837e-02, -1.67559018e-02,  9.95988438e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 4.53 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
2 / 100
current local expert:
          x          y        t         lon        lat
1 -270000.0 -1540000.0  19363.0 -170.055706 -75.964166
&#39;local_data_select&#39;: 0.003 seconds
number obs: 147
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.066 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.321 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([4.84148065, 9.4458284 , 5.29851904]) 
kernel_variance: 2.8000116507562467
likelihood_variance: 1.877869943521615
inducing_points: array([[  -30.35830177,  -144.96485556, 19359.49430556],
       [  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185]]) (truncated) 
inducing_mean: array([[1.88359596],
       [1.95020585],
       [1.9874051 ],
       [2.01182202],
       [2.02584674]]) (truncated) 
inducing_chol: array([[[ 4.00375421e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.29295691e-01,  7.45461047e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.74593463e-01, -3.32113475e-01,  8.56301671e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.02885998e-03,  5.42271714e-04,  7.43585854e-04, ...,
          9.35359826e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.87974812e-03,  9.40249737e-04,  1.30581719e-03, ...,
         -9.91240200e-02,  9.68123229e-01,  0.00000000e+00],
        [ 2.08625505e-03,  5.89413136e-04,  9.66697488e-04, ...,
         -2.61054114e-02, -3.04223387e-02,  9.93730686e-01]]]) 
&#39;predict&#39;: 0.105 seconds
total run time : 4.28 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
3 / 100
current local expert:
          x          y        t         lon        lat
2 -250000.0 -1540000.0  19363.0 -170.779176 -75.994217
&#39;local_data_select&#39;: 0.004 seconds
number obs: 149
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.175 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([5.16947098, 7.90272875, 4.80674431]) 
kernel_variance: 2.5877276182413538
likelihood_variance: 1.7806470235584557
inducing_points: array([[  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185],
       [  -28.66991789,  -147.91311885, 19359.49436343]]) (truncated) 
inducing_mean: array([[1.64965047],
       [1.67674887],
       [1.70744825],
       [1.70818938],
       [1.71972039]]) (truncated) 
inducing_chol: array([[[ 4.03957532e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.32452340e-01,  7.47243537e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.78197617e-01, -3.35604905e-01,  8.49555843e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.74078969e-05, -4.96542905e-04,  7.58136046e-05, ...,
          9.20986659e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.85510684e-04,  2.21634328e-04,  2.16478160e-04, ...,
         -1.24604239e-01,  9.59557975e-01,  0.00000000e+00],
        [ 1.42076625e-04,  4.67615430e-04,  1.03946541e-03, ...,
         -3.11516393e-02, -3.77010098e-02,  9.92688321e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 4.13 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
4 / 100
current local expert:
          x          y        t         lon        lat
3 -230000.0 -1540000.0  19363.0 -171.505624 -76.022012
&#39;local_data_select&#39;: 0.003 seconds
number obs: 153
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.523 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([15.05253227, 11.40136885,  6.75454098]) 
kernel_variance: 3.6244731628324534
likelihood_variance: 2.0706133499800567
inducing_points: array([[  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185],
       [  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657]]) (truncated) 
inducing_mean: array([[3.03491156],
       [3.02591702],
       [3.01556735],
       [3.05392948],
       [3.09477755]]) (truncated) 
inducing_chol: array([[[ 3.02694520e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.79383506e-01,  7.25552200e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.69887366e-01, -3.10283784e-01,  8.84689790e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 5.09516558e-04,  2.85853194e-04, -5.67754161e-05, ...,
          9.78031197e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.41452457e-03,  6.73972661e-04,  9.16873235e-05, ...,
         -2.80004596e-02,  9.91275044e-01,  0.00000000e+00],
        [ 9.78993772e-04,  6.03734107e-04,  1.01413624e-04, ...,
         -9.28702315e-03, -6.86088224e-03,  9.98293641e-01]]]) 
&#39;predict&#39;: 0.091 seconds
total run time : 4.48 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
5 / 100
current local expert:
          x          y        t         lon        lat
4 -210000.0 -1540000.0  19363.0 -172.234834 -76.047539
&#39;local_data_select&#39;: 0.004 seconds
number obs: 155
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.520 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([14.54625054, 10.83057384,  6.45576547]) 
kernel_variance: 3.5401190448430047
likelihood_variance: 2.1049098653100002
inducing_points: array([[  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657],
       [  -27.65520599,  -149.68061327, 19359.49439815],
       [  -27.31668417,  -150.26954128, 19359.49440972]]) (truncated) 
inducing_mean: array([[2.9640737 ],
       [3.04514305],
       [3.06916088],
       [3.10898907],
       [3.13576403]]) (truncated) 
inducing_chol: array([[[ 3.51365792e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.31833546e-01,  7.28282102e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.74410443e-01, -3.13889349e-01,  8.81587155e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.04242207e-04, -7.70650159e-05,  3.41855201e-05, ...,
          9.75226731e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.70330482e-03, -6.17389215e-04, -4.07490389e-04, ...,
         -3.09746910e-02,  9.89945592e-01,  0.00000000e+00],
        [-5.59862604e-04, -1.33269409e-03, -6.75331216e-06, ...,
         -1.10392187e-02, -8.09465444e-03,  9.98056697e-01]]]) 
&#39;predict&#39;: 0.092 seconds
total run time : 4.47 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
6 / 100
current local expert:
          x          y        t         lon        lat
5 -190000.0 -1540000.0  19363.0 -172.966584 -76.070784
&#39;local_data_select&#39;: 0.003 seconds
number obs: 156
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.636 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([11.18995342, 11.18818842,  1.20818722]) 
kernel_variance: 3.674281368339921
likelihood_variance: 2.1598867032173072
inducing_points: array([[  -27.65520599,  -149.68061327, 19359.49439815],
       [  -27.31668417,  -150.26954128, 19359.49440972],
       [  -26.97803514,  -150.85832638, 19359.4944213 ],
       [  -26.63924648,  -151.44698932, 19359.49443287],
       [  -26.30031521,  -152.0355292 , 19359.49444444]]) (truncated) 
inducing_mean: array([[3.20374559],
       [3.25117096],
       [3.23640467],
       [3.27006065],
       [3.31196899]]) (truncated) 
inducing_chol: array([[[ 3.51198799e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.47323250e-01,  7.35975171e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.66346828e-01, -3.07724743e-01,  8.84377162e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-7.97150373e-04, -3.76672493e-04,  3.20796166e-04, ...,
          9.72157222e-01,  0.00000000e+00,  0.00000000e+00],
        [-6.37585905e-04, -2.91095961e-04,  1.63036150e-04, ...,
         -3.36415392e-02,  9.88511253e-01,  0.00000000e+00],
        [-1.03363960e-04, -4.19608788e-05, -5.61761791e-05, ...,
         -1.16767587e-02, -9.21516666e-03,  9.97836266e-01]]]) 
&#39;predict&#39;: 0.110 seconds
total run time : 4.62 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
7 / 100
current local expert:
          x          y        t         lon        lat
6 -170000.0 -1540000.0  19363.0 -173.700646 -76.091738
&#39;local_data_select&#39;: 0.004 seconds
number obs: 164
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.178 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([5.87204159, 5.87375336, 2.10978046]) 
kernel_variance: 2.433856434592468
likelihood_variance: 1.7104724163313605
inducing_points: array([[  -26.63924648,  -151.44698932, 19359.49443287],
       [  -26.30031521,  -152.0355292 , 19359.49444444],
       [  -25.96125032,  -152.62394236, 19359.49445602],
       [  -25.6220425 ,  -153.21223323, 19359.49446759],
       [  -25.28269626,  -153.80040091, 19359.49447917]]) (truncated) 
inducing_mean: array([[1.58464625],
       [1.68972242],
       [1.74821611],
       [1.82512576],
       [1.91105081]]) (truncated) 
inducing_chol: array([[[ 4.46555825e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.07714489e-01,  7.58001632e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.69445555e-01, -3.26264717e-01,  8.46889818e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.37292711e-03,  3.09571212e-04,  2.92308669e-04, ...,
          9.02861367e-01,  0.00000000e+00,  0.00000000e+00],
        [-4.49332767e-04,  1.73122240e-04, -5.69983209e-05, ...,
         -1.42802575e-01,  9.48077935e-01,  0.00000000e+00],
        [ 5.36826556e-04, -6.45242017e-04, -1.80847743e-04, ...,
         -3.35296552e-02, -4.70476106e-02,  9.90208360e-01]]]) 
&#39;predict&#39;: 0.093 seconds
total run time : 4.17 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
8 / 100
current local expert:
          x          y        t         lon       lat
7 -150000.0 -1540000.0  19363.0 -174.436791 -76.11039
&#39;local_data_select&#39;: 0.004 seconds
number obs: 168
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 11.142 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([28.26681316, 41.79666862,  1.68389911]) 
kernel_variance: 0.039475884186846305
likelihood_variance: 0.0002823665850185604
inducing_points: array([[  -24.94320927,  -154.38845059, 19359.49449074],
       [  -24.60359082,  -154.97636188, 19359.49450231],
       [  -24.26384136,  -155.56413484, 19359.49451389],
       [  -23.92394843,  -156.1517927 , 19359.49452546],
       [  -23.58391719,  -156.73932379, 19359.49453704]]) (truncated) 
inducing_mean: array([[-0.44401112],
       [ 0.97560106],
       [ 0.36664625],
       [ 0.38793004],
       [ 0.44657738]]) (truncated) 
inducing_chol: array([[[ 5.13445748e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.79872276e-01,  4.36024407e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.56757950e-02, -5.47503067e-01,  7.83294964e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.40133361e-03, -2.47170817e-04,  2.66024828e-04, ...,
          9.06258511e-01,  0.00000000e+00,  0.00000000e+00],
        [-6.46499054e-03, -3.68983319e-04, -1.58901886e-03, ...,
         -1.20742828e-01,  9.56871810e-01,  0.00000000e+00],
        [-2.20600243e-03, -1.61984178e-04, -5.08342045e-04, ...,
         -4.77925061e-02, -4.22513040e-02,  9.89697137e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 12.19 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
9 / 100
current local expert:
          x          y        t         lon       lat
8 -130000.0 -1540000.0  19363.0 -175.174783 -76.12673
&#39;local_data_select&#39;: 0.004 seconds
number obs: 158
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.548 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([26.79887412, 37.35631295,  2.01699069]) 
kernel_variance: 0.06386462521875808
likelihood_variance: 0.0004917452260230875
inducing_points: array([[-1.74760875e+01, -1.45202606e+02,  1.93625098e+04],
       [-1.70830971e+01, -1.45757176e+02,  1.93625099e+04],
       [-1.66899827e+01, -1.46311602e+02,  1.93625099e+04],
       [-1.62967383e+01, -1.46865902e+02,  1.93625099e+04],
       [-1.59033656e+01, -1.47420064e+02,  1.93625099e+04]]) (truncated) 
inducing_mean: array([[ 0.32241331],
       [ 0.6176118 ],
       [-0.09690134],
       [-0.27766634],
       [-0.34651454]]) (truncated) 
inducing_chol: array([[[ 5.35764500e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.53067034e-01,  4.16475981e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.44368560e-03, -5.41773481e-01,  7.80237078e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.66397314e-03,  1.51293284e-03,  1.07239547e-03, ...,
          9.03575500e-01,  0.00000000e+00,  0.00000000e+00],
        [ 3.95067168e-03,  1.02867918e-03,  4.53142114e-04, ...,
         -1.23909597e-01,  9.57092483e-01,  0.00000000e+00],
        [-2.14252479e-03, -1.21630037e-03,  8.19111744e-04, ...,
         -4.50302669e-02, -3.87281245e-02,  9.90580142e-01]]]) 
&#39;predict&#39;: 0.092 seconds
total run time : 10.56 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
10 / 100
current local expert:
          x          y        t         lon        lat
9 -110000.0 -1540000.0  19363.0 -175.914383 -76.140751
&#39;local_data_select&#39;: 0.004 seconds
number obs: 142
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.059 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([33.47489127, 36.93392619,  3.11221468]) 
kernel_variance: 0.07660968586979076
likelihood_variance: 0.0005462205088583185
inducing_points: array([[-1.66899827e+01, -1.46311602e+02,  1.93625099e+04],
       [-1.62967383e+01, -1.46865902e+02,  1.93625099e+04],
       [-1.59033656e+01, -1.47420064e+02,  1.93625099e+04],
       [-1.55098637e+01, -1.47974092e+02,  1.93625099e+04],
       [-1.51162262e+01, -1.48528000e+02,  1.93625099e+04]]) (truncated) 
inducing_mean: array([[ 0.36898271],
       [ 0.00512205],
       [-0.19658175],
       [-0.10521658],
       [ 0.06257034]]) (truncated) 
inducing_chol: array([[[ 5.04760265e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.60461487e-01,  4.13662604e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-5.96230599e-03, -5.36827543e-01,  7.88406288e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 4.27978214e-03, -1.39118979e-04,  1.61895474e-03, ...,
          9.12644706e-01,  0.00000000e+00,  0.00000000e+00],
        [ 5.16620812e-03, -1.31440541e-03, -9.87340848e-03, ...,
         -1.07856293e-01,  9.60772264e-01,  0.00000000e+00],
        [-4.02174543e-04,  2.97919346e-03, -1.62689057e-03, ...,
         -4.37871739e-02, -3.49285207e-02,  9.90897633e-01]]]) 
&#39;predict&#39;: 0.096 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 9.79 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
11 / 100
current local expert:
           x          y        t         lon        lat
10 -290000.0 -1520000.0  19363.0 -169.198382 -76.109223
&#39;local_data_select&#39;: 0.004 seconds
number obs: 167
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.076 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.316 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([ 5.92078174, 26.91829583,  7.68313071]) 
kernel_variance: 5.304383368797349
likelihood_variance: 2.568777118232841
inducing_points: array([[  -37.97008687,  -148.01337268, 19359.77071759],
       [  -37.41675972,  -147.61936721, 19359.77072917],
       [  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389]]) (truncated) 
inducing_mean: array([[4.81064348],
       [4.63590933],
       [4.83043141],
       [4.79304835],
       [4.78946751]]) (truncated) 
inducing_chol: array([[[ 3.27291099e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.70545984e-01,  7.02106223e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.61143935e-01, -3.66214287e-01,  8.30917764e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.95604933e-04, -1.23749176e-03,  3.85044077e-04, ...,
          9.89847319e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.56897364e-04, -1.35234430e-03,  2.38625599e-04, ...,
         -1.44408995e-02,  9.93515566e-01,  0.00000000e+00],
        [ 4.66392702e-04, -1.10401644e-03, -2.21127250e-04, ...,
         -5.81137626e-03, -5.96346918e-03,  9.98215786e-01]]]) 
&#39;predict&#39;: 0.098 seconds
total run time : 5.33 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
12 / 100
current local expert:
           x          y        t         lon       lat
11 -270000.0 -1520000.0  19363.0 -169.927522 -76.14192
&#39;local_data_select&#39;: 0.003 seconds
number obs: 167
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.067 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.157 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([4.8606781 , 6.41930737, 4.20400838]) 
kernel_variance: 2.344183899671559
likelihood_variance: 1.7229738022051346
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[ 1.3866997 ],
       [-0.80451388],
       [ 1.09830639],
       [ 0.85672536],
       [ 0.85055483]]) (truncated) 
inducing_chol: array([[[ 4.54434717e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.87727246e-01,  7.51874643e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.76548126e-01, -3.37521306e-01,  8.30607423e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.44541662e-03, -1.05178545e-04, -5.66465785e-04, ...,
          9.02152090e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.45518954e-03, -9.26424526e-04, -1.52019018e-03, ...,
         -1.48743446e-01,  9.45463588e-01,  0.00000000e+00],
        [ 1.09640152e-03,  6.33883580e-04, -1.08900098e-03, ...,
         -4.03809534e-02, -5.19032039e-02,  9.88528700e-01]]]) 
&#39;predict&#39;: 0.089 seconds
total run time : 4.16 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
13 / 100
current local expert:
           x          y        t         lon        lat
12 -250000.0 -1520000.0  19363.0 -170.659974 -76.172349
&#39;local_data_select&#39;: 0.004 seconds
number obs: 167
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.067 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.066 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([3.52238478, 3.64139794, 2.94514857]) 
kernel_variance: 1.8746613518610238
likelihood_variance: 1.5074102383545658
inducing_points: array([[  -30.69556014,  -144.37483449, 19359.49429398],
       [  -30.35830177,  -144.96485556, 19359.49430556],
       [  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028]]) (truncated) 
inducing_mean: array([[0.43819424],
       [0.50558714],
       [0.56638619],
       [0.60025667],
       [0.62563692]]) (truncated) 
inducing_chol: array([[[ 5.35128637e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.68965030e-01,  7.59688867e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.72725972e-01, -3.31826574e-01,  8.07100906e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.23390402e-04,  3.17159824e-04,  3.13996829e-04, ...,
          8.38517771e-01,  0.00000000e+00,  0.00000000e+00],
        [-5.15065627e-05,  2.59943578e-04,  1.34317756e-04, ...,
         -2.42198080e-01,  8.79642181e-01,  0.00000000e+00],
        [-8.59202592e-05,  2.39055204e-05, -7.12666419e-05, ...,
         -7.39574636e-02, -1.18899960e-01,  9.64648649e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 4.08 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
14 / 100
current local expert:
           x          y        t         lon        lat
13 -230000.0 -1520000.0  19363.0 -171.395518 -76.200495
&#39;local_data_select&#39;: 0.004 seconds
number obs: 181
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.067 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([4.50017695, 4.65127469, 3.45808353]) 
kernel_variance: 2.0058602896681594
likelihood_variance: 1.5892768046147072
inducing_points: array([[  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185],
       [  -28.66991789,  -147.91311885, 19359.49436343]]) (truncated) 
inducing_mean: array([[0.62545447],
       [0.6810047 ],
       [0.71963257],
       [0.74733497],
       [0.78372432]]) (truncated) 
inducing_chol: array([[[ 4.88785725e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.97699272e-01,  7.59234322e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.76734159e-01, -3.32723476e-01,  8.29122363e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.63881036e-04,  2.87870720e-04, -4.25645230e-06, ...,
          8.71262245e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.01183409e-03,  4.55777297e-04,  2.11271166e-04, ...,
         -1.97633104e-01,  9.15922104e-01,  0.00000000e+00],
        [-2.30386893e-03, -1.21699864e-04, -1.97833196e-04, ...,
         -5.49494760e-02, -7.91773617e-02,  9.80858750e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 4.10 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
15 / 100
current local expert:
           x          y        t         lon        lat
14 -210000.0 -1520000.0  19363.0 -172.133932 -76.226346
&#39;local_data_select&#39;: 0.004 seconds
number obs: 173
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.289 seconds
&#39;get_parameters&#39;: 0.017 seconds
parameters:
lengthscales: array([26.280486  , 36.55399469,  2.37341755]) 
kernel_variance: 0.034582378142318175
likelihood_variance: 0.0002125804670964093
inducing_points: array([[  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185],
       [  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657]]) (truncated) 
inducing_mean: array([[-0.22678761],
       [-0.36493251],
       [-0.19796312],
       [-0.19881724],
       [-0.19880013]]) (truncated) 
inducing_chol: array([[[ 4.98351614e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.64825768e-01,  4.23925986e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 1.14257189e-03, -5.62555401e-01,  7.63341509e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.01502456e-03,  7.81129204e-05,  1.44914390e-04, ...,
          8.70433555e-01,  0.00000000e+00,  0.00000000e+00],
        [-2.62803049e-03,  1.08180375e-04,  1.18994148e-04, ...,
         -1.64120845e-01,  9.36333586e-01,  0.00000000e+00],
        [-2.33087498e-03, -3.87471745e-04,  1.13736929e-04, ...,
         -6.94167575e-02, -5.94078672e-02,  9.83323726e-01]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 10.35 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
16 / 100
current local expert:
           x          y        t         lon        lat
15 -190000.0 -1520000.0  19363.0 -172.874984 -76.249887
&#39;local_data_select&#39;: 0.004 seconds
number obs: 167
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.068 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.706 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([26.73457964, 35.55802345,  1.44237039]) 
kernel_variance: 0.025134251483511307
likelihood_variance: 0.0002407128784132806
inducing_points: array([[  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657],
       [  -27.65520599,  -149.68061327, 19359.49439815],
       [  -27.31668417,  -150.26954128, 19359.49440972],
       [  -26.97803514,  -150.85832638, 19359.4944213 ]]) (truncated) 
inducing_mean: array([[-0.32183214],
       [-0.54819926],
       [-0.24219315],
       [-0.23174943],
       [-0.17108114]]) (truncated) 
inducing_chol: array([[[ 6.11740176e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.87255993e-01,  4.58619721e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.61946743e-02, -5.44083018e-01,  7.78832705e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-8.54528701e-04,  4.01215922e-04, -3.66844027e-05, ...,
          9.06950405e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.01375787e-04,  6.31010303e-04,  1.81110048e-04, ...,
         -1.15648357e-01,  9.57250226e-01,  0.00000000e+00],
        [-9.82636687e-04, -5.40729249e-05,  3.28483963e-04, ...,
         -5.10281545e-02, -3.92072185e-02,  9.89025353e-01]]]) 
&#39;predict&#39;: 0.105 seconds
total run time : 10.78 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
17 / 100
current local expert:
           x          y        t         lon        lat
16 -170000.0 -1520000.0  19363.0 -173.618439 -76.271109
&#39;local_data_select&#39;: 0.004 seconds
number obs: 174
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.078 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.519 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([28.82823154, 24.1975159 ,  1.26013355]) 
kernel_variance: 0.02649127236731422
likelihood_variance: 0.00024294182705462565
inducing_points: array([[  -26.63924648,  -151.44698932, 19359.49443287],
       [  -26.30031521,  -152.0355292 , 19359.49444444],
       [  -25.96125032,  -152.62394236, 19359.49445602],
       [  -25.6220425 ,  -153.21223323, 19359.49446759],
       [  -25.28269626,  -153.80040091, 19359.49447917]]) (truncated) 
inducing_mean: array([[-0.38172566],
       [-0.70508499],
       [-0.18098398],
       [ 0.07414526],
       [ 0.30834894]]) (truncated) 
inducing_chol: array([[[ 6.28431127e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.75459892e-01,  4.33749626e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 8.74836944e-03, -5.62725522e-01,  7.51614626e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-5.73641005e-04,  9.09136950e-04, -2.45611894e-04, ...,
          8.43092327e-01,  0.00000000e+00,  0.00000000e+00],
        [-7.02903266e-05,  1.25101750e-03, -2.18829356e-04, ...,
         -2.01820474e-01,  9.19871650e-01,  0.00000000e+00],
        [ 6.63605083e-04,  1.00330102e-03,  9.19911007e-06, ...,
         -8.22264104e-02, -7.43233079e-02,  9.79662879e-01]]]) 
&#39;predict&#39;: 0.090 seconds
total run time : 10.57 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
18 / 100
current local expert:
           x          y        t         lon        lat
17 -150000.0 -1520000.0  19363.0 -174.364059 -76.289999
&#39;local_data_select&#39;: 0.003 seconds
number obs: 177
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.610 seconds
&#39;get_parameters&#39;: 0.019 seconds
parameters:
lengthscales: array([28.68614812, 27.37768859,  1.88695125]) 
kernel_variance: 0.04492795317923836
likelihood_variance: 0.0006127373482312143
inducing_points: array([[  -24.26384136,  -155.56413484, 19359.49451389],
       [  -23.92394843,  -156.1517927 , 19359.49452546],
       [  -23.58391719,  -156.73932379, 19359.49453704],
       [  -23.2437492 ,  -157.32672868, 19359.49456019],
       [  -22.90344184,  -157.91400845, 19359.49457176]]) (truncated) 
inducing_mean: array([[-0.30628792],
       [ 0.25788721],
       [ 0.3351787 ],
       [ 0.32699861],
       [ 0.26182431]]) (truncated) 
inducing_chol: array([[[ 7.66456625e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.43872063e-01,  4.83359273e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.40065815e-02, -4.39647832e-01,  8.53152852e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.77329036e-03, -1.99369709e-04, -1.57582490e-03, ...,
          9.17628994e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.60750679e-03, -1.48614881e-04, -6.09462481e-03, ...,
         -1.04612105e-01,  9.64178551e-01,  0.00000000e+00],
        [ 4.58989694e-03, -7.04318723e-05, -6.93983969e-04, ...,
         -3.41764674e-02, -3.22469721e-02,  9.93161421e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 9.72 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
19 / 100
current local expert:
           x          y        t         lon        lat
18 -130000.0 -1520000.0  19363.0 -175.111599 -76.306549
&#39;local_data_select&#39;: 0.004 seconds
number obs: 167
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.066 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.597 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([18.71622524, 19.90862514,  1.90366931]) 
kernel_variance: 0.05323600424951526
likelihood_variance: 0.0005537007479177185
inducing_points: array([[-1.82616727e+01, -1.44093084e+02,  1.93625098e+04],
       [-1.78689437e+01, -1.44647912e+02,  1.93625098e+04],
       [-1.74760875e+01, -1.45202606e+02,  1.93625098e+04],
       [-1.70830971e+01, -1.45757176e+02,  1.93625099e+04],
       [-1.66899827e+01, -1.46311602e+02,  1.93625099e+04]]) (truncated) 
inducing_mean: array([[0.38871376],
       [0.03340657],
       [0.26930523],
       [0.25794977],
       [0.10050457]]) (truncated) 
inducing_chol: array([[[ 6.89447203e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.70798334e-01,  4.17035759e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 2.72797101e-02, -5.71048154e-01,  7.20359193e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.54782462e-03,  1.09105880e-03, -4.96537591e-03, ...,
          7.96286928e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.51131536e-03,  8.82674484e-04, -3.50420175e-03, ...,
         -2.56571305e-01,  8.88716733e-01,  0.00000000e+00],
        [ 2.65507221e-03,  1.80598597e-05, -7.48973556e-04, ...,
         -9.70284032e-02, -9.52131329e-02,  9.74091186e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 10.66 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
20 / 100
current local expert:
           x          y        t         lon        lat
19 -110000.0 -1520000.0  19363.0 -175.860811 -76.320751
&#39;local_data_select&#39;: 0.003 seconds
number obs: 151
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 6.611 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([24.08350011, 25.40937934,  4.66527307]) 
kernel_variance: 0.08135876993880016
likelihood_variance: 0.0011597508092150788
inducing_points: array([[-1.74760875e+01, -1.45202606e+02,  1.93625098e+04],
       [-1.70830971e+01, -1.45757176e+02,  1.93625099e+04],
       [-1.66899827e+01, -1.46311602e+02,  1.93625099e+04],
       [-1.62967383e+01, -1.46865902e+02,  1.93625099e+04],
       [-1.59033656e+01, -1.47420064e+02,  1.93625099e+04]]) (truncated) 
inducing_mean: array([[0.15504743],
       [0.50153947],
       [0.32356659],
       [0.17879693],
       [0.04101149]]) (truncated) 
inducing_chol: array([[[ 0.05676073,  0.        ,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.30577036,  0.4438401 ,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.03253008, -0.49921908,  0.77883171, ...,  0.        ,
          0.        ,  0.        ],
        ...,
        [ 0.00263007, -0.00401649, -0.0030433 , ...,  0.88879495,
          0.        ,  0.        ],
        [ 0.00129187,  0.00427322, -0.0178231 , ..., -0.13576729,
          0.94943062,  0.        ],
        [ 0.00270829,  0.00479966, -0.00836571, ..., -0.05177787,
         -0.04279747,  0.98912756]]]) 
&#39;predict&#39;: 0.096 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 8.29 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
21 / 100
current local expert:
           x          y        t         lon        lat
20 -290000.0 -1500000.0  19363.0 -169.057815 -76.286455
&#39;local_data_select&#39;: 0.004 seconds
number obs: 185
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.908 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([28.29754182, 40.71340975,  6.98650356]) 
kernel_variance: 0.035971713973565536
likelihood_variance: 0.00047595336305658695
inducing_points: array([[  -38.52347124,  -148.40719391, 19359.77070602],
       [  -37.97008687,  -148.01337268, 19359.77071759],
       [  -37.41675972,  -147.61936721, 19359.77072917],
       [  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231]]) (truncated) 
inducing_mean: array([[ 0.14023885],
       [-0.22307353],
       [-0.32353203],
       [-0.40049485],
       [-0.43145774]]) (truncated) 
inducing_chol: array([[[ 6.65887914e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.67186035e-01,  4.59907067e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.55328016e-02, -5.08746874e-01,  7.99150031e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-6.12395119e-03,  3.48657182e-03, -2.02071246e-04, ...,
          9.48700717e-01,  0.00000000e+00,  0.00000000e+00],
        [-6.69389606e-03,  8.70559062e-03, -7.17999122e-04, ...,
         -6.59842308e-02,  9.75855865e-01,  0.00000000e+00],
        [-1.96713228e-03, -3.27720427e-03,  1.38552996e-03, ...,
         -2.59374149e-02, -2.22967503e-02,  9.93974012e-01]]]) 
&#39;predict&#39;: 0.098 seconds
total run time : 8.98 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
22 / 100
current local expert:
           x          y        t         lon        lat
21 -270000.0 -1500000.0  19363.0 -169.796026 -76.319567
&#39;local_data_select&#39;: 0.003 seconds
number obs: 194
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.769 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([22.04924809, 40.38996968,  5.95332956]) 
kernel_variance: 0.03996363713657863
likelihood_variance: 0.000382533370496177
inducing_points: array([[  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861]]) (truncated) 
inducing_mean: array([[ 0.0800431 ],
       [-0.49569607],
       [-0.41893696],
       [-0.33345409],
       [-0.15712417]]) (truncated) 
inducing_chol: array([[[ 6.31813137e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.48876290e-01,  4.32774985e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.55384121e-02, -5.26632475e-01,  7.66727220e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.51507415e-04, -1.12418085e-02,  1.17040641e-02, ...,
          9.16035388e-01,  0.00000000e+00,  0.00000000e+00],
        [ 3.76036314e-03, -1.21317243e-02,  2.13927985e-02, ...,
         -1.07180441e-01,  9.60588270e-01,  0.00000000e+00],
        [ 5.09439011e-04, -1.34939548e-02,  4.74895153e-03, ...,
         -4.23592248e-02, -3.63810470e-02,  9.90385593e-01]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 8.87 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
23 / 100
current local expert:
           x          y        t         lon        lat
22 -250000.0 -1500000.0  19363.0 -170.537678 -76.350383
&#39;local_data_select&#39;: 0.004 seconds
number obs: 204
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.077 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.744 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([37.6439583 , 42.66662889,  4.46689848]) 
kernel_variance: 0.04004871076675657
likelihood_variance: 0.0003705634435116368
inducing_points: array([[  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648]]) (truncated) 
inducing_mean: array([[-0.1400723 ],
       [ 0.11884088],
       [ 0.1459989 ],
       [ 0.18337726],
       [ 0.21676129]]) (truncated) 
inducing_chol: array([[[ 5.54155535e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.73742886e-01,  4.47999210e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.11170381e-02, -5.28875251e-01,  7.93004988e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 9.43668525e-04,  4.13470797e-03, -3.62037425e-03, ...,
          9.40307347e-01,  0.00000000e+00,  0.00000000e+00],
        [ 5.60387415e-03,  8.75500091e-03, -6.60452325e-03, ...,
         -7.74011228e-02,  9.72446986e-01,  0.00000000e+00],
        [-1.70478270e-03, -5.50189707e-03, -6.38648107e-03, ...,
         -3.20186019e-02, -2.71267498e-02,  9.93295407e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 8.85 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
24 / 100
current local expert:
           x          y        t         lon       lat
23 -230000.0 -1500000.0  19363.0 -171.282543 -76.37889
&#39;local_data_select&#39;: 0.004 seconds
number obs: 198
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.523 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([38.52939807, 32.72716768,  1.95020774]) 
kernel_variance: 0.027621414408713504
likelihood_variance: 0.00023461382330145747
inducing_points: array([[  -30.69556014,  -144.37483449, 19359.49429398],
       [  -30.35830177,  -144.96485556, 19359.49430556],
       [  -30.02090064,  -145.55476258, 19359.49431713],
       [  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028]]) (truncated) 
inducing_mean: array([[-0.35000684],
       [ 0.24906233],
       [ 0.11188268],
       [-0.01033981],
       [-0.14621914]]) (truncated) 
inducing_chol: array([[[ 5.59435524e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.74759477e-01,  4.50931853e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.76977105e-02, -5.47880943e-01,  7.76234727e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.47542260e-03,  5.95514879e-04, -3.10062464e-04, ...,
          9.06105674e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.16335411e-03,  1.54059766e-03, -4.18641227e-04, ...,
         -1.23678953e-01,  9.56266276e-01,  0.00000000e+00],
        [ 1.65874040e-03,  8.14617117e-04, -3.88295474e-04, ...,
         -4.65194111e-02, -4.27068755e-02,  9.91068374e-01]]]) 
&#39;predict&#39;: 0.090 seconds
total run time : 10.63 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
25 / 100
current local expert:
           x          y        t        lon        lat
24 -210000.0 -1500000.0  19363.0 -172.03039 -76.405073
&#39;local_data_select&#39;: 0.003 seconds
number obs: 195
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.448 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([36.92371429, 30.45191302,  2.07565051]) 
kernel_variance: 0.02823461403523643
likelihood_variance: 0.00020091124121375344
inducing_points: array([[  -29.6833598 ,  -146.14454247, 19359.4943287 ],
       [  -29.3456853 ,  -146.73419051, 19359.49434028],
       [  -29.00787179,  -147.32371602, 19359.49435185],
       [  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ]]) (truncated) 
inducing_mean: array([[-0.27134713],
       [-0.14741355],
       [-0.16521479],
       [-0.24128868],
       [-0.25858165]]) (truncated) 
inducing_chol: array([[[ 5.20511114e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.68657551e-01,  4.31643533e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.12065087e-03, -5.65182084e-01,  7.58093562e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.46268495e-03,  8.22805868e-05,  1.91267446e-02, ...,
          8.77484055e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.63761573e-03, -3.50727261e-04,  6.88942551e-03, ...,
         -1.59155782e-01,  9.39100691e-01,  0.00000000e+00],
        [ 3.38528941e-03,  3.44105483e-03, -4.43468888e-03, ...,
         -6.66965556e-02, -5.91796241e-02,  9.85122345e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 10.58 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
26 / 100
current local expert:
           x          y        t         lon        lat
25 -190000.0 -1500000.0  19363.0 -172.780979 -76.428918
&#39;local_data_select&#39;: 0.003 seconds
number obs: 189
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 10.691 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([33.37785243, 17.73887719,  0.85677123]) 
kernel_variance: 0.015575742533897102
likelihood_variance: 0.00019913201601805288
inducing_points: array([[  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657],
       [  -27.65520599,  -149.68061327, 19359.49439815],
       [  -27.31668417,  -150.26954128, 19359.49440972]]) (truncated) 
inducing_mean: array([[-0.38569439],
       [-0.31401492],
       [-0.14096759],
       [-0.25287039],
       [-0.28301843]]) (truncated) 
inducing_chol: array([[[ 7.71334467e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.92239015e-01,  4.52013159e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 6.43982317e-03, -5.68820714e-01,  7.36601396e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.09602323e-03, -3.81157374e-03,  2.09849854e-05, ...,
          8.14869675e-01,  0.00000000e+00,  0.00000000e+00],
        [-3.89146227e-03,  1.02728107e-04, -2.03513998e-05, ...,
         -2.45336034e-01,  8.98298020e-01,  0.00000000e+00],
        [ 6.19432869e-03,  2.38708382e-03,  7.34484494e-06, ...,
         -9.74074862e-02, -9.71052094e-02,  9.73561319e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 11.81 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
27 / 100
current local expert:
           x          y        t         lon        lat
26 -170000.0 -1500000.0  19363.0 -173.534068 -76.450414
&#39;local_data_select&#39;: 0.004 seconds
number obs: 195
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.067 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.163 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([16.04780978, 17.64522068,  1.43534339]) 
kernel_variance: 0.03244737424829076
likelihood_variance: 0.00045815466595037016
inducing_points: array([[  -26.63924648,  -151.44698932, 19359.49443287],
       [  -26.30031521,  -152.0355292 , 19359.49444444],
       [  -25.96125032,  -152.62394236, 19359.49445602],
       [  -25.6220425 ,  -153.21223323, 19359.49446759],
       [  -25.28269626,  -153.80040091, 19359.49447917]]) (truncated) 
inducing_mean: array([[-0.32031828],
       [-0.57550075],
       [-0.1474681 ],
       [ 0.03050515],
       [ 0.18376105]]) (truncated) 
inducing_chol: array([[[ 8.17631873e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.94207231e-01,  4.41278505e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 2.32561771e-02, -5.68893478e-01,  7.24783888e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.21830294e-02,  9.51374713e-04,  9.64808427e-04, ...,
          7.90333964e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.20005801e-02, -1.79911779e-04,  4.15512104e-03, ...,
         -2.71261456e-01,  8.82922593e-01,  0.00000000e+00],
        [ 4.12523100e-03, -9.64726719e-05,  1.29053744e-03, ...,
         -1.01996430e-01, -1.00882159e-01,  9.68518309e-01]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 10.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
28 / 100
current local expert:
           x          y        t         lon        lat
27 -150000.0 -1500000.0  19363.0 -174.289407 -76.469549
&#39;local_data_select&#39;: 0.004 seconds
number obs: 176
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.998 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([22.82495649, 23.03907743,  3.13146179]) 
kernel_variance: 0.06603115981826695
likelihood_variance: 0.0007255941557796899
inducing_points: array([[-1.98313360e+01, -1.41872383e+02,  1.93625098e+04],
       [-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04],
       [-1.82616727e+01, -1.44093084e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[ 0.33141937],
       [-0.21370796],
       [-0.01119197],
       [-0.0043236 ],
       [ 0.03475477]]) (truncated) 
inducing_chol: array([[[ 0.06809584,  0.        ,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.36179669,  0.43065601,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.00476556, -0.53970596,  0.7544963 , ...,  0.        ,
          0.        ,  0.        ],
        ...,
        [-0.01438045, -0.00838032,  0.00261329, ...,  0.8617308 ,
          0.        ,  0.        ],
        [-0.00822781,  0.00401304, -0.0054146 , ..., -0.17621366,
          0.93239929,  0.        ],
        [-0.00466194,  0.01909799,  0.00288995, ..., -0.06516698,
         -0.05894378,  0.98485311]]]) 
&#39;predict&#39;: 0.101 seconds
total run time : 9.15 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
29 / 100
current local expert:
           x          y        t         lon        lat
28 -130000.0 -1500000.0  19363.0 -175.046743 -76.486315
&#39;local_data_select&#39;: 0.004 seconds
number obs: 171
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.078 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.044 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([23.05495595, 21.05017663,  2.22610963]) 
kernel_variance: 0.05192554862597087
likelihood_variance: 0.0006143052139922231
inducing_points: array([[-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04],
       [-1.82616727e+01, -1.44093084e+02,  1.93625098e+04],
       [-1.78689437e+01, -1.44647912e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[ 0.40610845],
       [-0.16920058],
       [ 0.08461129],
       [ 0.10441471],
       [ 0.16356897]]) (truncated) 
inducing_chol: array([[[ 7.32751717e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.76934737e-01,  4.33031503e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.35798102e-04, -5.54336705e-01,  7.49367392e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.15162353e-03, -7.04492546e-04,  1.37243835e-04, ...,
          8.43333638e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.32017488e-03, -1.43449656e-03, -2.76052649e-05, ...,
         -1.97491848e-01,  9.17931566e-01,  0.00000000e+00],
        [-1.98406303e-03,  4.55428493e-03,  6.26180347e-04, ...,
         -8.13538244e-02, -7.30475540e-02,  9.80826728e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 10.23 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
30 / 100
current local expert:
           x          y        t         lon        lat
29 -110000.0 -1500000.0  19363.0 -175.805817 -76.500701
&#39;local_data_select&#39;: 0.004 seconds
number obs: 158
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.033 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([21.10277918, 18.44234964,  1.91103377]) 
kernel_variance: 0.047738345344226794
likelihood_variance: 0.0006074798573043041
inducing_points: array([[-1.82616727e+01, -1.44093084e+02,  1.93625098e+04],
       [-1.78689437e+01, -1.44647912e+02,  1.93625098e+04],
       [-1.74760875e+01, -1.45202606e+02,  1.93625098e+04],
       [-1.70830971e+01, -1.45757176e+02,  1.93625099e+04],
       [-1.66899827e+01, -1.46311602e+02,  1.93625099e+04]]) (truncated) 
inducing_mean: array([[0.39922928],
       [0.03281142],
       [0.25350708],
       [0.28225059],
       [0.16280069]]) (truncated) 
inducing_chol: array([[[ 7.41893869e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.79501717e-01,  4.32295179e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 1.12708608e-02, -5.63043572e-01,  7.33326881e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.03350241e-03, -1.38232942e-03,  2.65734382e-04, ...,
          8.18307878e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.72757804e-03, -1.20491039e-03,  4.99133023e-05, ...,
         -2.41069229e-01,  9.02474058e-01,  0.00000000e+00],
        [ 3.17390212e-03, -4.85809326e-04,  1.04263864e-03, ...,
         -8.66085717e-02, -8.68192972e-02,  9.78419336e-01]]]) 
&#39;predict&#39;: 0.098 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 10.92 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
31 / 100
current local expert:
           x          y        t         lon        lat
30 -290000.0 -1480000.0  19363.0 -168.913587 -76.463567
&#39;local_data_select&#39;: 0.004 seconds
number obs: 196
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.077 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.585 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([28.61468088, 41.49658458,  5.6884567 ]) 
kernel_variance: 0.03173171019616425
likelihood_variance: 0.00043219002067622055
inducing_points: array([[  -38.52347124,  -148.40719391, 19359.77070602],
       [  -37.97008687,  -148.01337268, 19359.77071759],
       [  -37.41675972,  -147.61936721, 19359.77072917],
       [  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231]]) (truncated) 
inducing_mean: array([[ 0.16297328],
       [-0.3391605 ],
       [-0.34048556],
       [-0.39953498],
       [-0.43222243]]) (truncated) 
inducing_chol: array([[[ 6.76404024e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.75780596e-01,  4.65451354e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.36580371e-02, -5.12801249e-01,  7.99760144e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.96336023e-04, -3.00138737e-03,  3.79728484e-03, ...,
          9.46697962e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.10757790e-03,  1.55719473e-03, -1.21664892e-03, ...,
         -6.84490677e-02,  9.75973852e-01,  0.00000000e+00],
        [-1.47603404e-03, -8.48951269e-04,  5.19708302e-04, ...,
         -3.11046484e-02, -2.32381470e-02,  9.93690414e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 9.76 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
32 / 100
current local expert:
           x          y        t         lon        lat
31 -270000.0 -1480000.0  19363.0 -169.661089 -76.497103
&#39;local_data_select&#39;: 0.003 seconds
number obs: 218
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.078 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.805 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([30.61073137, 38.93797988,  6.67642013]) 
kernel_variance: 0.041866699229385365
likelihood_variance: 0.0004977023280769576
inducing_points: array([[  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704]]) (truncated) 
inducing_mean: array([[ 0.07365178],
       [-0.44795476],
       [-0.38735261],
       [-0.37398612],
       [-0.26857342]]) (truncated) 
inducing_chol: array([[[ 6.32860326e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.63463765e-01,  4.53700677e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.26108664e-02, -5.07127013e-01,  8.00383438e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-5.86681898e-03,  4.16375174e-04,  2.29026140e-03, ...,
          9.51976396e-01,  0.00000000e+00,  0.00000000e+00],
        [-6.53956937e-03, -4.20429727e-03, -1.17477765e-03, ...,
         -6.50039417e-02,  9.78354231e-01,  0.00000000e+00],
        [ 3.63784847e-03,  1.08135313e-03,  1.62148655e-03, ...,
         -2.26624355e-02, -2.27434498e-02,  9.94387728e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 8.97 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
33 / 100
current local expert:
           x          y        t         lon        lat
32 -250000.0 -1480000.0  19363.0 -170.412167 -76.528318
&#39;local_data_select&#39;: 0.004 seconds
number obs: 228
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.788 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([41.27743678, 40.17057801,  4.09569204]) 
kernel_variance: 0.03378867802991638
likelihood_variance: 0.0003881104655895967
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[-0.13627563],
       [-0.01243082],
       [ 0.08635288],
       [ 0.11697903],
       [ 0.14008446]]) (truncated) 
inducing_chol: array([[[ 0.0585766 ,  0.        ,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.38618024,  0.47322186,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.05925041, -0.51519518,  0.8016365 , ...,  0.        ,
          0.        ,  0.        ],
        ...,
        [ 0.00394376,  0.00265259, -0.00315258, ...,  0.95610102,
          0.        ,  0.        ],
        [-0.00100317,  0.00748135, -0.00663426, ..., -0.0566453 ,
          0.97991428,  0.        ],
        [-0.00385394, -0.00633452,  0.00150508, ..., -0.02632802,
         -0.02041227,  0.99445531]]]) 
&#39;predict&#39;: 0.093 seconds
total run time : 8.96 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
34 / 100
current local expert:
           x          y        t         lon        lat
33 -230000.0 -1480000.0  19363.0 -171.166585 -76.557194
&#39;local_data_select&#39;: 0.004 seconds
number obs: 219
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.485 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([39.17489874, 34.45699231,  1.72519123]) 
kernel_variance: 0.022373466421093727
likelihood_variance: 0.00021144783195843977
inducing_points: array([[  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ]]) (truncated) 
inducing_mean: array([[-0.1510764 ],
       [ 0.56033725],
       [ 0.16333843],
       [ 0.00543717],
       [-0.10882423]]) (truncated) 
inducing_chol: array([[[ 5.46195878e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.73965452e-01,  4.75572591e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.57320469e-02, -5.42863001e-01,  7.78460155e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.10446230e-03,  4.29347714e-04,  5.64466535e-04, ...,
          9.20123116e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.88003964e-03, -1.94939921e-04, -1.72855508e-03, ...,
         -1.04734560e-01,  9.62119873e-01,  0.00000000e+00],
        [ 9.73557729e-04,  1.07969250e-03, -5.53301350e-04, ...,
         -5.00060057e-02, -3.78122918e-02,  9.88170868e-01]]]) 
&#39;predict&#39;: 0.103 seconds
total run time : 10.68 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
35 / 100
current local expert:
           x          y        t         lon        lat
34 -210000.0 -1480000.0  19363.0 -171.924104 -76.583718
&#39;local_data_select&#39;: 0.003 seconds
number obs: 219
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.065 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 10.950 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([36.41083295, 19.34320641,  1.12157563]) 
kernel_variance: 0.01423082408080272
likelihood_variance: 0.00018567847969624352
inducing_points: array([[  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ]]) (truncated) 
inducing_mean: array([[-0.12033307],
       [ 0.28337557],
       [ 0.00232408],
       [ 0.00959944],
       [ 0.01273668]]) (truncated) 
inducing_chol: array([[[ 6.99926401e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.11253029e-01,  5.29513422e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-9.45571013e-02, -4.05136025e-01,  8.70219437e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.24308714e-05,  7.17432507e-04, -1.20097345e-03, ...,
          8.35034666e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.68362613e-05,  5.38943920e-04, -2.08203561e-03, ...,
         -2.10831548e-01,  9.12455314e-01,  0.00000000e+00],
        [-3.71608985e-04,  5.97432944e-04, -2.37739687e-04, ...,
         -8.92425449e-02, -8.11441158e-02,  9.73631784e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 12.12 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
36 / 100
current local expert:
           x          y        t         lon        lat
35 -190000.0 -1480000.0  19363.0 -172.684475 -76.607875
&#39;local_data_select&#39;: 0.004 seconds
number obs: 226
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.531 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([33.03699455, 30.04462111,  1.64401126]) 
kernel_variance: 0.037848830376186186
likelihood_variance: 0.0004926936158926915
inducing_points: array([[  -28.66991789,  -147.91311885, 19359.49436343],
       [  -28.33181871,  -148.50241007, 19359.494375  ],
       [  -27.99358235,  -149.09157273, 19359.49438657],
       [  -27.65520599,  -149.68061327, 19359.49439815],
       [  -27.31668417,  -150.26954128, 19359.49440972]]) (truncated) 
inducing_mean: array([[-0.24286746],
       [-0.29925949],
       [-0.17059849],
       [-0.18581886],
       [-0.17160659]]) (truncated) 
inducing_chol: array([[[ 6.68349375e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.91069622e-01,  4.58714527e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.33678676e-02, -5.13215026e-01,  7.99887365e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.02505875e-03,  2.12382173e-03, -3.18449349e-03, ...,
          9.18698460e-01,  0.00000000e+00,  0.00000000e+00],
        [-8.58733498e-03, -3.62211442e-05, -2.25433945e-03, ...,
         -1.02056570e-01,  9.63233557e-01,  0.00000000e+00],
        [-1.88977093e-03, -3.39075877e-04,  9.88936438e-03, ...,
         -4.10467990e-02, -3.34830103e-02,  9.91410179e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 8.74 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
37 / 100
current local expert:
           x          y        t         lon        lat
36 -170000.0 -1480000.0  19363.0 -173.447445 -76.629653
&#39;local_data_select&#39;: 0.004 seconds
number obs: 203
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.078 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.365 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([19.1562981 , 15.2024721 ,  1.81864115]) 
kernel_variance: 0.03784706230491989
likelihood_variance: 0.00040863432457377037
inducing_points: array([[  -21.398933  ,  -139.64955766, 19362.5097338 ],
       [  -21.00722743,  -140.20546318, 19362.50974537],
       [  -20.61539263,  -140.76123627, 19362.50975694],
       [  -20.22343054,  -141.31687362, 19362.50976852],
       [  -19.83133601,  -141.87238345, 19362.50978009]]) (truncated) 
inducing_mean: array([[0.10479935],
       [0.88306661],
       [0.25777034],
       [0.16061038],
       [0.0825075 ]]) (truncated) 
inducing_chol: array([[[ 7.19143128e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.52957171e-01,  4.12909260e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 2.48041370e-02, -5.70368009e-01,  6.92083923e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-6.43279356e-05, -6.91889227e-04,  1.01016482e-04, ...,
          7.41621005e-01,  0.00000000e+00,  0.00000000e+00],
        [-7.81582476e-05, -2.53719917e-03, -1.51841176e-04, ...,
         -3.44427231e-01,  8.30428380e-01,  0.00000000e+00],
        [ 4.44203020e-03, -1.14359450e-03,  2.96155870e-05, ...,
         -1.27085854e-01, -1.52092408e-01,  9.54725789e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 10.59 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
38 / 100
current local expert:
           x          y        t         lon       lat
37 -150000.0 -1480000.0  19363.0 -174.212757 -76.64904
&#39;local_data_select&#39;: 0.004 seconds
number obs: 192
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.076 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.796 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([21.88541074, 16.16778992,  1.80657132]) 
kernel_variance: 0.04289979409424686
likelihood_variance: 0.0005012505676670953
inducing_points: array([[  -21.00722743,  -140.20546318, 19362.50974537],
       [  -20.61539263,  -140.76123627, 19362.50975694],
       [  -20.22343054,  -141.31687362, 19362.50976852],
       [  -19.83133601,  -141.87238345, 19362.50978009],
       [  -19.43911227,  -142.42775968, 19362.50979167]]) (truncated) 
inducing_mean: array([[ 0.18271761],
       [ 0.78018232],
       [ 0.16674797],
       [ 0.09069179],
       [-0.02781432]]) (truncated) 
inducing_chol: array([[[ 7.37294200e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.52991175e-01,  4.23760491e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 7.75537521e-04, -5.59771458e-01,  7.13092695e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.71361034e-03, -5.03106864e-03, -7.68948799e-03, ...,
          7.83808403e-01,  0.00000000e+00,  0.00000000e+00],
        [-7.42002032e-03, -6.73176366e-03, -1.24463135e-02, ...,
         -2.84588705e-01,  8.77461286e-01,  0.00000000e+00],
        [-5.45139009e-03, -1.97526024e-03,  6.15235574e-04, ...,
         -9.66272161e-02, -1.05932654e-01,  9.71985913e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 10.00 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
39 / 100
current local expert:
           x          y        t         lon        lat
38 -130000.0 -1480000.0  19363.0 -174.980146 -76.666027
&#39;local_data_select&#39;: 0.004 seconds
number obs: 166
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.293 seconds
&#39;get_parameters&#39;: 0.017 seconds
parameters:
lengthscales: array([24.52051895, 21.24087466,  4.24359323]) 
kernel_variance: 0.07333757579416302
likelihood_variance: 0.0009456137370011471
inducing_points: array([[-2.02234305e+01, -1.41316874e+02,  1.93625098e+04],
       [-1.98313360e+01, -1.41872383e+02,  1.93625098e+04],
       [-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[ 0.26497387],
       [-0.00463758],
       [-0.02119044],
       [-0.0610467 ],
       [-0.06865191]]) (truncated) 
inducing_chol: array([[[ 7.29977406e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.46895222e-01,  4.38231851e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.59615508e-02, -5.24513520e-01,  7.60143035e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 6.79445259e-03,  9.84450695e-03, -3.29426522e-03, ...,
          8.67249325e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.45725524e-03,  1.32835331e-02, -1.39416694e-03, ...,
         -1.66772317e-01,  9.37760789e-01,  0.00000000e+00],
        [ 2.66686559e-03,  1.37692377e-02, -5.99455713e-04, ...,
         -6.18133078e-02, -5.16271457e-02,  9.86598241e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 8.51 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
40 / 100
current local expert:
           x          y        t         lon        lat
39 -110000.0 -1480000.0  19363.0 -175.749345 -76.680603
&#39;local_data_select&#39;: 0.003 seconds
number obs: 162
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.975 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([24.40281145, 17.95459502,  2.0830886 ]) 
kernel_variance: 0.05142324282847865
likelihood_variance: 0.0006043336862983344
inducing_points: array([[-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04],
       [-1.82616727e+01, -1.44093084e+02,  1.93625098e+04],
       [-1.78689437e+01, -1.44647912e+02,  1.93625098e+04],
       [-1.74760875e+01, -1.45202606e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[ 0.39815142],
       [-0.1070497 ],
       [ 0.08258009],
       [ 0.14235721],
       [ 0.24545998]]) (truncated) 
inducing_chol: array([[[ 7.25833053e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.70035363e-01,  4.26438284e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 7.43565716e-03, -5.65575774e-01,  7.30732713e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.50117971e-03, -1.11900205e-03, -7.95322497e-04, ...,
          8.17701886e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.60360334e-03, -9.93717994e-04, -1.21265806e-03, ...,
         -2.24799016e-01,  9.06457056e-01,  0.00000000e+00],
        [ 3.49977787e-04, -5.46127594e-04, -3.36816520e-03, ...,
         -8.73869069e-02, -7.82875778e-02,  9.77063847e-01]]]) 
&#39;predict&#39;: 0.095 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 11.08 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
41 / 100
current local expert:
           x          y        t         lon        lat
40 -290000.0 -1460000.0  19363.0 -168.765556 -76.640555
&#39;local_data_select&#39;: 0.004 seconds
number obs: 213
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.043 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([32.84221296, 43.00946484,  5.97863023]) 
kernel_variance: 0.03473521875878302
likelihood_variance: 0.00042437969352780247
inducing_points: array([[  -38.52347124,  -148.40719391, 19359.77070602],
       [  -37.97008687,  -148.01337268, 19359.77071759],
       [  -37.41675972,  -147.61936721, 19359.77072917],
       [  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231]]) (truncated) 
inducing_mean: array([[ 0.14536668],
       [-0.33639473],
       [-0.34531389],
       [-0.40448184],
       [-0.43021238]]) (truncated) 
inducing_chol: array([[[ 6.32643627e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.74757549e-01,  4.65670283e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.72558044e-02, -5.07914088e-01,  8.03229067e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.86056783e-03, -4.74865536e-03, -1.61426116e-03, ...,
          9.47263353e-01,  0.00000000e+00,  0.00000000e+00],
        [ 3.65514235e-03, -6.52451394e-03, -3.02770535e-03, ...,
         -6.60430272e-02,  9.75907342e-01,  0.00000000e+00],
        [-9.34153440e-04,  4.17376155e-03,  3.71775719e-04, ...,
         -3.21867021e-02, -2.32107551e-02,  9.93215842e-01]]]) 
&#39;predict&#39;: 0.103 seconds
total run time : 9.31 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
42 / 100
current local expert:
           x          y        t         lon        lat
41 -270000.0 -1460000.0  19363.0 -169.522576 -76.674528
&#39;local_data_select&#39;: 0.004 seconds
number obs: 227
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.079 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.725 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([39.45499079, 38.46265156,  5.34276394]) 
kernel_variance: 0.036859421798598954
likelihood_variance: 0.0004961603427010179
inducing_points: array([[  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704]]) (truncated) 
inducing_mean: array([[ 0.06850467],
       [-0.55179384],
       [-0.40351936],
       [-0.36778935],
       [-0.26476944]]) (truncated) 
inducing_chol: array([[[ 6.35527810e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.77457374e-01,  4.72112880e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-5.97200938e-02, -5.00780568e-01,  8.10634549e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.87869371e-03, -3.46643736e-04, -2.02576831e-03, ...,
          9.54293620e-01,  0.00000000e+00,  0.00000000e+00],
        [ 6.42886282e-03,  9.32388181e-04, -4.82436732e-04, ...,
         -5.75674450e-02,  9.79722269e-01,  0.00000000e+00],
        [-4.43805060e-03, -1.40903012e-03, -9.82755002e-04, ...,
         -2.76866354e-02, -1.95475134e-02,  9.94399952e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 8.99 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
43 / 100
current local expert:
           x          y        t         lon        lat
42 -250000.0 -1460000.0  19363.0 -170.283314 -76.706151
&#39;local_data_select&#39;: 0.003 seconds
number obs: 237
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.930 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([42.15843768, 39.3740278 ,  4.17311129]) 
kernel_variance: 0.033741015236204826
likelihood_variance: 0.0004936302413293965
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[-0.13770858],
       [ 0.0517345 ],
       [ 0.07266563],
       [ 0.0906137 ],
       [ 0.11454931]]) (truncated) 
inducing_chol: array([[[ 6.35384314e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.93195256e-01,  4.85027078e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.96387739e-02, -5.01616778e-01,  8.11324273e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.00654679e-03,  2.52587022e-04,  1.42265810e-03, ...,
          9.63943742e-01,  0.00000000e+00,  0.00000000e+00],
        [ 6.25236380e-04, -2.37008563e-04, -1.02583538e-03, ...,
         -4.65804961e-02,  9.83665487e-01,  0.00000000e+00],
        [ 1.33633055e-04, -7.23329295e-04, -1.67418680e-03, ...,
         -2.09184638e-02, -1.61558098e-02,  9.95469794e-01]]]) 
&#39;predict&#39;: 0.134 seconds
total run time : 9.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
44 / 100
current local expert:
           x          y        t         lon        lat
43 -230000.0 -1460000.0  19363.0 -171.047527 -76.735406
&#39;local_data_select&#39;: 0.004 seconds
number obs: 249
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.079 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 12.368 seconds
&#39;get_parameters&#39;: 0.017 seconds
parameters:
lengthscales: array([31.21373729, 18.9527579 ,  1.37071843]) 
kernel_variance: 0.013794369451848152
likelihood_variance: 0.0001955642779619556
inducing_points: array([[  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963]]) (truncated) 
inducing_mean: array([[-0.22688695],
       [ 0.43441082],
       [ 0.26885817],
       [ 0.19254735],
       [ 0.07072985]]) (truncated) 
inducing_chol: array([[[ 7.24099027e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.85393441e-01,  4.73487701e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.86927353e-02, -5.43181615e-01,  7.67029987e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.58908083e-04, -7.22444901e-04,  3.04270535e-03, ...,
          8.36470727e-01,  0.00000000e+00,  0.00000000e+00],
        [-2.88168477e-04, -5.89784630e-04,  4.22554700e-03, ...,
         -2.13569148e-01,  9.10969634e-01,  0.00000000e+00],
        [-4.69827277e-04,  7.59345304e-04, -1.48278719e-03, ...,
         -8.96185820e-02, -8.30893596e-02,  9.75747097e-01]]]) 
&#39;predict&#39;: 0.104 seconds
total run time : 13.71 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
45 / 100
current local expert:
           x          y        t         lon       lat
44 -210000.0 -1460000.0  19363.0 -171.814964 -76.76228
&#39;local_data_select&#39;: 0.004 seconds
number obs: 252
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 10.081 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([35.50616557, 30.72348274,  1.35864693]) 
kernel_variance: 0.018935606928205576
likelihood_variance: 0.00021608304035649074
inducing_points: array([[  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593]]) (truncated) 
inducing_mean: array([[-0.10071248],
       [ 0.37574345],
       [-0.07657574],
       [-0.22872394],
       [-0.28651953]]) (truncated) 
inducing_chol: array([[[ 6.19012501e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.64460150e-01,  4.79152988e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.51641073e-02, -5.37286889e-01,  7.78243040e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 5.38084546e-04,  1.33114778e-03, -1.13878256e-03, ...,
          9.06443948e-01,  0.00000000e+00,  0.00000000e+00],
        [ 9.98992232e-04, -1.00454118e-03,  6.05423442e-05, ...,
         -1.21871849e-01,  9.55767396e-01,  0.00000000e+00],
        [ 8.78503040e-05, -9.36400800e-03,  1.98062198e-03, ...,
         -5.19618416e-02, -4.46240338e-02,  9.87898075e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 11.37 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
46 / 100
current local expert:
           x          y        t        lon        lat
45 -190000.0 -1460000.0  19363.0 -172.58537 -76.786757
&#39;local_data_select&#39;: 0.004 seconds
number obs: 244
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.077 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.558 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([38.24323255, 29.97556774,  1.41095453]) 
kernel_variance: 0.028855113880305056
likelihood_variance: 0.0004575254689136492
inducing_points: array([[  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694]]) (truncated) 
inducing_mean: array([[-0.10685508],
       [ 0.17230176],
       [-0.06673701],
       [-0.08881902],
       [-0.05829098]]) (truncated) 
inducing_chol: array([[[ 6.77957994e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.59764005e-01,  4.78325333e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.86608664e-02, -4.93746006e-01,  8.13522971e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.38059695e-04,  3.07931434e-03, -2.30149631e-03, ...,
          9.41774977e-01,  0.00000000e+00,  0.00000000e+00],
        [ 5.86236902e-05,  1.98612520e-03,  4.16443622e-03, ...,
         -7.36707462e-02,  9.73996445e-01,  0.00000000e+00],
        [ 5.20799344e-04,  3.15622360e-03, -7.54749653e-03, ...,
         -3.67538223e-02, -2.39426891e-02,  9.93459134e-01]]]) 
&#39;predict&#39;: 0.104 seconds
total run time : 9.87 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
47 / 100
current local expert:
           x          y        t         lon        lat
46 -170000.0 -1460000.0  19363.0 -173.358481 -76.808824
&#39;local_data_select&#39;: 0.004 seconds
number obs: 219
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.297 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([28.30247072, 21.47859415,  1.97408653]) 
kernel_variance: 0.04895170015107574
likelihood_variance: 0.0005009209050238216
inducing_points: array([[  -22.57329154,  -137.98101807, 19362.50969907],
       [  -22.18196958,  -138.53732704, 19362.50971065],
       [  -21.79051999,  -139.0935035 , 19362.50972222],
       [  -21.398933  ,  -139.64955766, 19362.5097338 ],
       [  -21.00722743,  -140.20546318, 19362.50974537]]) (truncated) 
inducing_mean: array([[0.05709844],
       [0.52079805],
       [0.29634993],
       [0.33596618],
       [0.34300473]]) (truncated) 
inducing_chol: array([[[ 6.53806480e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.65728883e-01,  4.29230302e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 2.00444200e-03, -5.37021802e-01,  7.55241731e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-7.10266936e-04,  2.12212729e-04,  7.17149458e-03, ...,
          8.50161206e-01,  0.00000000e+00,  0.00000000e+00],
        [-2.27768061e-03, -9.31064234e-04,  6.61186138e-03, ...,
         -1.84667766e-01,  9.26610635e-01,  0.00000000e+00],
        [-4.59274991e-03,  6.01310762e-04,  4.78934009e-03, ...,
         -6.93646374e-02, -6.13658330e-02,  9.83688496e-01]]]) 
&#39;predict&#39;: 0.103 seconds
total run time : 9.60 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
48 / 100
current local expert:
           x          y        t         lon       lat
47 -150000.0 -1460000.0  19363.0 -174.134029 -76.82847
&#39;local_data_select&#39;: 0.004 seconds
number obs: 202
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.080 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.958 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([30.55050235, 17.20497197,  1.7224858 ]) 
kernel_variance: 0.04278425242153232
likelihood_variance: 0.0004995018575429509
inducing_points: array([[  -21.79051999,  -139.0935035 , 19362.50972222],
       [  -21.398933  ,  -139.64955766, 19362.5097338 ],
       [  -21.00722743,  -140.20546318, 19362.50974537],
       [  -20.61539263,  -140.76123627, 19362.50975694],
       [  -20.22343054,  -141.31687362, 19362.50976852]]) (truncated) 
inducing_mean: array([[0.07284885],
       [0.76799551],
       [0.33943283],
       [0.26918488],
       [0.17359925]]) (truncated) 
inducing_chol: array([[[ 7.22590581e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.63585809e-01,  4.26582827e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 3.65536460e-03, -5.49202069e-01,  7.32696752e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.00447069e-02,  1.64106443e-03,  2.30986823e-03, ...,
          8.27225223e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.84840301e-03,  1.01035843e-03,  1.97603952e-03, ...,
         -2.27278301e-01,  9.06774543e-01,  0.00000000e+00],
        [ 1.81222953e-02,  9.17800046e-04,  1.32746630e-03, ...,
         -8.50884739e-02, -8.15620943e-02,  9.75796158e-01]]]) 
&#39;predict&#39;: 0.107 seconds
total run time : 10.34 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
49 / 100
current local expert:
           x          y        t        lon        lat
48 -130000.0 -1460000.0  19363.0 -174.91174 -76.845684
&#39;local_data_select&#39;: 0.003 seconds
number obs: 180
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.547 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([26.19560181, 13.11075476,  1.57097682]) 
kernel_variance: 0.03670787738927762
likelihood_variance: 0.0004777418267910862
inducing_points: array([[  -21.00722743,  -140.20546318, 19362.50974537],
       [  -20.61539263,  -140.76123627, 19362.50975694],
       [  -20.22343054,  -141.31687362, 19362.50976852],
       [  -19.83133601,  -141.87238345, 19362.50978009],
       [  -19.43911227,  -142.42775968, 19362.50979167]]) (truncated) 
inducing_mean: array([[0.19390041],
       [0.72149641],
       [0.19485552],
       [0.13605391],
       [0.01908123]]) (truncated) 
inducing_chol: array([[[ 7.85155436e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.55259581e-01,  4.25599691e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 1.80206274e-02, -5.66307343e-01,  6.97517032e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.67051062e-03, -1.12651520e-03,  3.71141655e-04, ...,
          7.68476096e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.32309524e-03, -3.01915958e-04,  5.93943555e-05, ...,
         -3.02226529e-01,  8.64966482e-01,  0.00000000e+00],
        [-1.45169093e-03,  4.60898068e-05, -1.30800145e-03, ...,
         -1.08604329e-01, -1.17431470e-01,  9.64924806e-01]]]) 
&#39;predict&#39;: 0.103 seconds
total run time : 10.88 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
50 / 100
current local expert:
           x          y        t         lon        lat
49 -110000.0 -1460000.0  19363.0 -175.691335 -76.860456
&#39;local_data_select&#39;: 0.004 seconds
number obs: 162
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.070 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.553 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([22.91287276, 16.69712131,  2.61094503]) 
kernel_variance: 0.05702991370098324
likelihood_variance: 0.0006274299337395779
inducing_points: array([[-1.98313360e+01, -1.41872383e+02,  1.93625098e+04],
       [-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04],
       [-1.82616727e+01, -1.44093084e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[ 0.34396326],
       [ 0.06092462],
       [-0.03959631],
       [-0.05794898],
       [-0.03601833]]) (truncated) 
inducing_chol: array([[[ 7.08807760e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.47063647e-01,  4.17617673e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.87292303e-04, -5.63478106e-01,  7.13586243e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.24046406e-02, -5.22274540e-03, -7.26828424e-03, ...,
          8.02721804e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.76263917e-02, -6.45192412e-03,  4.92756048e-04, ...,
         -2.55702953e-01,  8.95604894e-01,  0.00000000e+00],
        [ 1.89199844e-02,  4.91592503e-03, -3.85631259e-03, ...,
         -8.60301199e-02, -8.86152135e-02,  9.76981501e-01]]]) 
&#39;predict&#39;: 0.098 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 10.90 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
51 / 100
current local expert:
           x          y        t         lon        lat
50 -290000.0 -1440000.0  19363.0 -168.613571 -76.817416
&#39;local_data_select&#39;: 0.004 seconds
number obs: 220
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.076 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.224 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([36.85996214, 45.74862228,  5.39075755]) 
kernel_variance: 0.026448424380628218
likelihood_variance: 0.0004153851764060428
inducing_points: array([[  -37.97008687,  -148.01337268, 19359.77071759],
       [  -37.41675972,  -147.61936721, 19359.77072917],
       [  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389]]) (truncated) 
inducing_mean: array([[ 0.14716012],
       [-0.61280698],
       [-0.44796324],
       [-0.45253479],
       [-0.44741242]]) (truncated) 
inducing_chol: array([[[ 6.73076192e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.88667560e-01,  4.98067462e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.95707220e-02, -5.00711147e-01,  8.08011543e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.02105647e-03,  8.23876714e-04,  3.88701499e-04, ...,
          9.66125717e-01,  0.00000000e+00,  0.00000000e+00],
        [-2.12652515e-03,  9.26137622e-04,  1.00978188e-03, ...,
         -4.32933153e-02,  9.84537456e-01,  0.00000000e+00],
        [-4.35175632e-03,  1.24038905e-03, -2.49283568e-05, ...,
         -2.12273225e-02, -1.56113570e-02,  9.95517018e-01]]]) 
&#39;predict&#39;: 0.091 seconds
total run time : 9.54 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
52 / 100
current local expert:
           x          y        t         lon        lat
51 -270000.0 -1440000.0  19363.0 -169.380345 -76.851837
&#39;local_data_select&#39;: 0.003 seconds
number obs: 235
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.515 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([42.18509703, 37.83216547,  5.30795754]) 
kernel_variance: 0.034308618390613846
likelihood_variance: 0.0004657784591460262
inducing_points: array([[  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861]]) (truncated) 
inducing_mean: array([[ 0.03793309],
       [-0.63517826],
       [-0.3497716 ],
       [-0.23356095],
       [-0.09871096]]) (truncated) 
inducing_chol: array([[[ 6.15445658e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.78456582e-01,  4.77220141e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.20800225e-02, -5.01885363e-01,  8.07571199e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.97468250e-03, -1.84148303e-03, -3.27534801e-04, ...,
          9.51746559e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.50289307e-03,  6.51945017e-03, -1.47827008e-04, ...,
         -5.96588300e-02,  9.78725271e-01,  0.00000000e+00],
        [ 6.06837241e-03,  4.16527148e-03, -1.54101286e-04, ...,
         -2.83991927e-02, -2.02730924e-02,  9.94221432e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 8.82 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
53 / 100
current local expert:
           x          y        t         lon        lat
52 -250000.0 -1440000.0  19363.0 -170.150985 -76.883879
&#39;local_data_select&#39;: 0.004 seconds
number obs: 246
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.771 seconds
&#39;get_parameters&#39;: 0.018 seconds
parameters:
lengthscales: array([35.61559672, 42.08442365,  1.37214716]) 
kernel_variance: 0.01727256496161606
likelihood_variance: 0.0003490143808818078
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[-0.17216066],
       [ 0.0880925 ],
       [ 0.05712009],
       [ 0.07736106],
       [ 0.10747452]]) (truncated) 
inducing_chol: array([[[ 7.55780372e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.10916242e-01,  5.27051772e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.87666842e-02, -4.96029301e-01,  8.04382402e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.21286727e-04,  5.22135610e-07,  1.35496208e-04, ...,
          9.60437856e-01,  0.00000000e+00,  0.00000000e+00],
        [-8.06092792e-04,  2.44696693e-04,  2.11255591e-04, ...,
         -5.04667649e-02,  9.82118695e-01,  0.00000000e+00],
        [ 2.50799476e-04,  3.49641876e-06, -2.65211995e-04, ...,
         -2.29289513e-02, -1.84649825e-02,  9.95154375e-01]]]) 
&#39;predict&#39;: 0.109 seconds
total run time : 11.21 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
54 / 100
current local expert:
           x          y        t         lon        lat
53 -230000.0 -1440000.0  19363.0 -170.925242 -76.913525
&#39;local_data_select&#39;: 0.004 seconds
number obs: 263
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 11.009 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([34.03512413, 28.17978379,  1.33814704]) 
kernel_variance: 0.015508621659176727
likelihood_variance: 0.00019686851019051334
inducing_points: array([[  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963]]) (truncated) 
inducing_mean: array([[-0.20330294],
       [ 0.42264629],
       [ 0.24824151],
       [ 0.17222824],
       [ 0.06926177]]) (truncated) 
inducing_chol: array([[[ 6.51795005e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.92273468e-01,  4.88059779e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.51436659e-02, -5.37130491e-01,  7.76036775e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.80553838e-03,  7.48084384e-05, -3.58234963e-03, ...,
          9.04850588e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.79225136e-03,  7.25830228e-06, -8.90034460e-05, ...,
         -1.23383849e-01,  9.53231891e-01,  0.00000000e+00],
        [ 1.48458858e-03, -5.35021509e-05,  7.72785081e-04, ...,
         -5.79039449e-02, -4.60069831e-02,  9.86642203e-01]]]) 
&#39;predict&#39;: 0.091 seconds
total run time : 12.35 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
55 / 100
current local expert:
           x          y        t         lon        lat
54 -210000.0 -1440000.0  19363.0 -171.702855 -76.940758
&#39;local_data_select&#39;: 0.003 seconds
number obs: 271
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.076 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 10.767 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([36.62953036, 25.45431099,  1.08352721]) 
kernel_variance: 0.014387548261115218
likelihood_variance: 0.00020534906359713484
inducing_points: array([[  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435]]) (truncated) 
inducing_mean: array([[-0.09361118],
       [ 0.22558816],
       [-0.03432553],
       [-0.10109198],
       [-0.16826159]]) (truncated) 
inducing_chol: array([[[ 6.82097177e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.81564519e-01,  4.95741759e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.15808453e-02, -5.33720037e-01,  7.76892335e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-7.67397464e-04,  1.88210968e-06, -2.81388550e-04, ...,
          8.86639059e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.66978346e-04, -5.75845636e-04,  7.85370329e-06, ...,
         -1.43156219e-01,  9.42547928e-01,  0.00000000e+00],
        [ 1.71196328e-03, -6.95801096e-04,  9.87147568e-05, ...,
         -7.06686613e-02, -5.54484755e-02,  9.83087994e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 12.11 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
56 / 100
current local expert:
           x          y        t         lon        lat
55 -190000.0 -1440000.0  19363.0 -172.483558 -76.965564
&#39;local_data_select&#39;: 0.003 seconds
number obs: 256
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.159 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([37.99802732, 27.52277771,  1.35949091]) 
kernel_variance: 0.02677117976944278
likelihood_variance: 0.0004513151349808543
inducing_points: array([[  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222]]) (truncated) 
inducing_mean: array([[-0.04223386],
       [-0.17013477],
       [-0.0690686 ],
       [-0.0425001 ],
       [-0.02586642]]) (truncated) 
inducing_chol: array([[[ 7.40138556e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.07499632e-01,  4.90489534e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-5.37617849e-02, -4.97121250e-01,  8.11456707e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 7.74812652e-03, -6.55349124e-04,  2.01347250e-03, ...,
          9.34601208e-01,  0.00000000e+00,  0.00000000e+00],
        [ 6.57144514e-03, -6.38827675e-04,  2.56576478e-03, ...,
         -8.27382247e-02,  9.71584161e-01,  0.00000000e+00],
        [ 4.87414699e-03, -2.07376499e-04,  1.52052490e-03, ...,
         -3.47840956e-02, -2.63260937e-02,  9.92941883e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 9.51 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
57 / 100
current local expert:
           x          y        t         lon        lat
56 -170000.0 -1440000.0  19363.0 -173.267079 -76.987929
&#39;local_data_select&#39;: 0.004 seconds
number obs: 236
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.365 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([42.34142721, 16.66505293,  1.02282442]) 
kernel_variance: 0.02144326972725131
likelihood_variance: 0.00048488988669736973
inducing_points: array([[  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009]]) (truncated) 
inducing_mean: array([[-0.05866242],
       [-0.23137864],
       [-0.06449579],
       [-0.0313398 ],
       [-0.0622643 ]]) (truncated) 
inducing_chol: array([[[ 8.85431037e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.12024401e-01,  4.96644006e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.94362176e-02, -4.97112457e-01,  8.01928793e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 6.05352197e-03, -5.16327851e-04,  2.28830363e-03, ...,
          8.54481956e-01,  0.00000000e+00,  0.00000000e+00],
        [ 8.29297074e-03,  1.72201752e-03,  8.65858208e-04, ...,
         -1.83920571e-01,  9.26654192e-01,  0.00000000e+00],
        [ 5.32591812e-03,  1.38133071e-03, -5.39058558e-04, ...,
         -7.39693656e-02, -6.52761361e-02,  9.82746164e-01]]]) 
&#39;predict&#39;: 0.098 seconds
total run time : 10.76 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
58 / 100
current local expert:
           x          y        t         lon       lat
57 -150000.0 -1440000.0  19363.0 -174.053137 -77.00784
&#39;local_data_select&#39;: 0.004 seconds
number obs: 209
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.758 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([36.25799125, 15.9032023 ,  1.58661537]) 
kernel_variance: 0.038876251823065644
likelihood_variance: 0.0004550587269391556
inducing_points: array([[  -22.57329154,  -137.98101807, 19362.50969907],
       [  -22.18196958,  -138.53732704, 19362.50971065],
       [  -21.79051999,  -139.0935035 , 19362.50972222],
       [  -21.398933  ,  -139.64955766, 19362.5097338 ],
       [  -21.00722743,  -140.20546318, 19362.50974537]]) (truncated) 
inducing_mean: array([[0.06253746],
       [0.39133549],
       [0.30259354],
       [0.36746861],
       [0.3922511 ]]) (truncated) 
inducing_chol: array([[[ 7.50252491e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.67446369e-01,  4.29035648e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [ 9.34108457e-03, -5.54736155e-01,  7.26071156e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 7.63903484e-04, -4.46864923e-04,  1.99895187e-03, ...,
          8.46273130e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.83707012e-04, -5.46984809e-04,  8.07233341e-04, ...,
         -1.95858238e-01,  9.24697447e-01,  0.00000000e+00],
        [ 1.17478690e-03, -9.91557769e-05, -1.99455559e-03, ...,
         -7.21062235e-02, -6.61817516e-02,  9.82734593e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 10.15 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
59 / 100
current local expert:
           x          y        t         lon        lat
58 -130000.0 -1440000.0  19363.0 -174.841448 -77.025287
&#39;local_data_select&#39;: 0.004 seconds
number obs: 199
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.434 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([34.66490027, 17.92899053,  1.72129846]) 
kernel_variance: 0.0455111570043285
likelihood_variance: 0.0005332195242198836
inducing_points: array([[  -21.398933  ,  -139.64955766, 19362.5097338 ],
       [  -21.00722743,  -140.20546318, 19362.50974537],
       [  -20.61539263,  -140.76123627, 19362.50975694],
       [  -20.22343054,  -141.31687362, 19362.50976852],
       [  -19.83133601,  -141.87238345, 19362.50978009]]) (truncated) 
inducing_mean: array([[0.12972877],
       [0.77016491],
       [0.3070269 ],
       [0.2053063 ],
       [0.10942014]]) (truncated) 
inducing_chol: array([[[ 7.07515769e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.58489159e-01,  4.30374611e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.48024159e-03, -5.42518304e-01,  7.41958762e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.08813617e-04, -6.15183732e-03, -8.80519853e-05, ...,
          8.63625688e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.21385102e-03, -4.48501839e-03, -2.69301427e-04, ...,
         -1.71427150e-01,  9.34842058e-01,  0.00000000e+00],
        [-5.73923821e-03, -1.67367765e-03, -2.95849198e-04, ...,
         -6.67287962e-02, -5.64853582e-02,  9.84871404e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 9.82 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
60 / 100
current local expert:
           x          y        t         lon        lat
59 -110000.0 -1440000.0  19363.0 -175.631723 -77.040261
&#39;local_data_select&#39;: 0.004 seconds
number obs: 172
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.604 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([ 9.04760901, 11.05731039,  4.19914438]) 
kernel_variance: 3.074890503899973
likelihood_variance: 1.9426269857888705
inducing_points: array([[-2.02234305e+01, -1.41316874e+02,  1.93625098e+04],
       [-1.98313360e+01, -1.41872383e+02,  1.93625098e+04],
       [-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04],
       [-1.86542710e+01, -1.43538123e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[2.27418526],
       [1.99314659],
       [2.04754726],
       [1.97020972],
       [1.92371236]]) (truncated) 
inducing_chol: array([[[ 2.89866758e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.00535376e-01,  7.12878259e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.99104880e-01, -3.35119153e-01,  8.58894644e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-5.25383803e-03,  2.75605872e-03, -9.25280032e-04, ...,
          9.65418477e-01,  0.00000000e+00,  0.00000000e+00],
        [-2.56588905e-03,  9.29269887e-04, -1.55780756e-03, ...,
         -4.61741585e-02,  9.85004414e-01,  0.00000000e+00],
        [-4.28093342e-04,  5.84667514e-04,  1.34037784e-04, ...,
         -1.48465244e-02, -1.25805796e-02,  9.96967258e-01]]]) 
&#39;predict&#39;: 0.092 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 6.06 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
61 / 100
current local expert:
           x          y        t         lon        lat
60 -290000.0 -1420000.0  19363.0 -168.457474 -76.994148
&#39;local_data_select&#39;: 0.004 seconds
number obs: 214
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.054 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([40.56899954, 43.74592863,  5.19514713]) 
kernel_variance: 0.027272420689110146
likelihood_variance: 0.00040988128113073096
inducing_points: array([[  -36.86349665,  -147.22518539, 19359.77074074],
       [  -36.31031724,  -146.83083762, 19359.77075231],
       [  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704]]) (truncated) 
inducing_mean: array([[ 0.08951805],
       [-0.76582809],
       [-0.46370835],
       [-0.36912222],
       [-0.25044177]]) (truncated) 
inducing_chol: array([[[ 6.49959809e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.88432672e-01,  4.96340389e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.02506776e-02, -5.06400960e-01,  8.03128324e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.23118006e-03,  2.06586854e-03, -2.87658556e-03, ...,
          9.63792906e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.45169232e-03,  4.65441337e-04, -1.92891167e-03, ...,
         -4.63908086e-02,  9.83626892e-01,  0.00000000e+00],
        [ 2.30897228e-03, -5.42148664e-04, -2.14478913e-03, ...,
         -2.04713933e-02, -1.67101814e-02,  9.95653281e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 9.46 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
62 / 100
current local expert:
           x          y        t         lon        lat
61 -270000.0 -1420000.0  19363.0 -169.234244 -77.029029
&#39;local_data_select&#39;: 0.004 seconds
number obs: 229
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.811 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([42.76329693, 38.37120205,  5.09818183]) 
kernel_variance: 0.031383564668347956
likelihood_variance: 0.00044746844698485643
inducing_points: array([[  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019]]) (truncated) 
inducing_mean: array([[-0.04516945],
       [-0.39417479],
       [-0.22536126],
       [-0.12135432],
       [-0.00575476]]) (truncated) 
inducing_chol: array([[[ 6.31426480e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.88351491e-01,  4.82706291e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.46729442e-02, -5.07256532e-01,  8.03792383e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.41815510e-03, -1.39350351e-03,  3.31555880e-05, ...,
          9.58246117e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.16177675e-03,  2.28425105e-03, -7.78972538e-04, ...,
         -5.36054909e-02,  9.81639875e-01,  0.00000000e+00],
        [ 2.99077145e-04, -2.40676794e-04, -1.37161871e-03, ...,
         -2.44817789e-02, -1.79998170e-02,  9.95060363e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 9.19 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
63 / 100
current local expert:
           x          y        t        lon        lat
62 -250000.0 -1420000.0  19363.0 -170.01504 -77.061502
&#39;local_data_select&#39;: 0.004 seconds
number obs: 254
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.076 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.618 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([37.02998298, 41.26932589,  1.359319  ]) 
kernel_variance: 0.018430895123099214
likelihood_variance: 0.00033824871353767825
inducing_points: array([[  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491]]) (truncated) 
inducing_mean: array([[-0.19482569],
       [ 0.2421075 ],
       [ 0.1329106 ],
       [ 0.11946417],
       [ 0.13587115]]) (truncated) 
inducing_chol: array([[[ 7.14184290e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.04759091e-01,  5.20883396e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.57009797e-02, -5.00410255e-01,  8.01258733e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 6.17068318e-05,  1.19598631e-04, -4.20180417e-05, ...,
          9.64574305e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.48039053e-04, -2.78039142e-05, -2.22290393e-05, ...,
         -4.58486670e-02,  9.84672782e-01,  0.00000000e+00],
        [-7.03890714e-05,  3.57526769e-04, -8.69242921e-06, ...,
         -2.06840463e-02, -1.54409400e-02,  9.95797358e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 11.03 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
64 / 100
current local expert:
           x          y        t       lon        lat
63 -230000.0 -1420000.0  19363.0 -170.7996 -77.091548
&#39;local_data_select&#39;: 0.004 seconds
number obs: 270
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.053 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([39.7059695 , 40.95829391,  1.30424662]) 
kernel_variance: 0.015940842407960964
likelihood_variance: 0.00019594907929954876
inducing_points: array([[  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963]]) (truncated) 
inducing_mean: array([[-0.17407558],
       [ 0.36834168],
       [ 0.2309811 ],
       [ 0.16451266],
       [ 0.08424481]]) (truncated) 
inducing_chol: array([[[ 6.21260912e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.92115039e-01,  5.14188955e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.57042266e-02, -5.30124782e-01,  7.72183631e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-9.98566328e-04, -5.97176085e-04, -2.83847304e-03, ...,
          9.45648189e-01,  0.00000000e+00,  0.00000000e+00],
        [-3.34997585e-03, -5.09862716e-05, -4.27959992e-04, ...,
         -7.23651424e-02,  9.74549410e-01,  0.00000000e+00],
        [-4.75302151e-04,  1.73468447e-04, -8.92870843e-04, ...,
         -3.32364767e-02, -2.69379541e-02,  9.92657520e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 10.46 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
65 / 100
current local expert:
           x          y        t         lon       lat
64 -210000.0 -1420000.0  19363.0 -171.587655 -77.11915
&#39;local_data_select&#39;: 0.004 seconds
number obs: 274
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 9.524 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([44.94777229, 27.50852398,  1.22885341]) 
kernel_variance: 0.014756484077376454
likelihood_variance: 0.00019535593086191582
inducing_points: array([[  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435]]) (truncated) 
inducing_mean: array([[-0.10042543],
       [ 0.3001085 ],
       [-0.04220459],
       [-0.13365048],
       [-0.20285292]]) (truncated) 
inducing_chol: array([[[ 6.28993790e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.70293356e-01,  5.07165649e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.70234543e-02, -5.33240765e-01,  7.74358587e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-5.68496597e-03, -1.45260573e-04,  5.96654069e-05, ...,
          9.08506863e-01,  0.00000000e+00,  0.00000000e+00],
        [-9.70588259e-04, -2.38323022e-04, -5.80211117e-05, ...,
         -1.16494751e-01,  9.57297457e-01,  0.00000000e+00],
        [ 4.66782210e-03, -1.64238925e-04,  8.17214163e-05, ...,
         -4.94674876e-02, -4.14508591e-02,  9.89720599e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 10.94 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
66 / 100
current local expert:
           x          y        t         lon        lat
65 -190000.0 -1420000.0  19363.0 -172.378929 -77.144294
&#39;local_data_select&#39;: 0.004 seconds
number obs: 265
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.215 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([38.91837566, 20.77289453,  1.54381121]) 
kernel_variance: 0.02835031106483836
likelihood_variance: 0.0003691738245900048
inducing_points: array([[  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222]]) (truncated) 
inducing_mean: array([[-0.04476258],
       [-0.15078503],
       [-0.07041236],
       [-0.04181942],
       [-0.02179442]]) (truncated) 
inducing_chol: array([[[ 7.11142660e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.89693503e-01,  4.64869487e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.09925549e-02, -5.15844676e-01,  7.90807299e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.11437523e-03, -5.79074493e-04,  3.69040968e-04, ...,
          8.69872705e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.53555478e-03, -5.62560485e-04,  1.60774067e-03, ...,
         -1.61998993e-01,  9.37441215e-01,  0.00000000e+00],
        [ 3.66174422e-03,  9.27747477e-04, -2.00007238e-03, ...,
         -6.94221610e-02, -5.52738455e-02,  9.84319292e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 9.65 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
67 / 100
current local expert:
           x          y        t         lon        lat
66 -170000.0 -1420000.0  19363.0 -173.173138 -77.166964
&#39;local_data_select&#39;: 0.003 seconds
number obs: 245
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.127 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([44.72680927, 33.00743839,  1.26155709]) 
kernel_variance: 0.024885437470239784
likelihood_variance: 0.0005150982527413027
inducing_points: array([[  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852]]) (truncated) 
inducing_mean: array([[-0.06830706],
       [-0.18055596],
       [-0.11813925],
       [-0.10300835],
       [-0.09189243]]) (truncated) 
inducing_chol: array([[[ 7.47168345e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.14139523e-01,  5.17068313e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.54447538e-02, -4.80955300e-01,  8.20353651e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.54828046e-04, -1.55207934e-04,  7.16882666e-05, ...,
          9.65255859e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.74407180e-04,  3.02889974e-04,  7.48661140e-05, ...,
         -4.47120376e-02,  9.84940928e-01,  0.00000000e+00],
        [ 8.66287361e-05, -2.19602091e-04,  1.04162532e-04, ...,
         -2.09994843e-02, -1.50805128e-02,  9.95767316e-01]]]) 
&#39;predict&#39;: 0.105 seconds
total run time : 9.60 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
68 / 100
current local expert:
           x          y        t         lon        lat
67 -150000.0 -1420000.0  19363.0 -173.969991 -77.187149
&#39;local_data_select&#39;: 0.004 seconds
number obs: 227
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.068 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.937 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([40.34260769, 23.11450107,  1.41908011]) 
kernel_variance: 0.035196552076142806
likelihood_variance: 0.0005556232998939318
inducing_points: array([[  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009],
       [  -23.05702017,  -137.31578196, 19359.77104167],
       [  -22.50577519,  -136.91721909, 19359.77105324],
       [  -21.9546141 ,  -136.51849131, 19359.77106481]]) (truncated) 
inducing_mean: array([[-0.07074779],
       [-0.17499942],
       [-0.18419225],
       [-0.1854762 ],
       [-0.13079257]]) (truncated) 
inducing_chol: array([[[ 7.45405551e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.03042878e-01,  4.74977760e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.95897987e-02, -4.99881333e-01,  8.10116752e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 9.54929324e-05,  9.78344336e-05, -1.10621271e-04, ...,
          9.22483311e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.39832449e-03, -3.26552896e-04, -5.83898933e-05, ...,
         -9.84616098e-02,  9.64514519e-01,  0.00000000e+00],
        [-1.80450221e-03,  4.12951317e-04,  7.93783214e-06, ...,
         -3.80230784e-02, -3.29861039e-02,  9.91959865e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 9.44 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
69 / 100
current local expert:
           x          y        t         lon        lat
68 -130000.0 -1420000.0  19363.0 -174.769193 -77.204836
&#39;local_data_select&#39;: 0.004 seconds
number obs: 211
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.084 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.104 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([3.469532  , 3.5208564 , 2.74300773]) 
kernel_variance: 1.9262044417638104
likelihood_variance: 1.5625612887002278
inducing_points: array([[-2.03016128e+01, -1.35321312e+02,  1.93597711e+04],
       [-1.97507697e+01, -1.34921916e+02,  1.93597711e+04],
       [-1.91999964e+01, -1.34522346e+02,  1.93597711e+04],
       [-1.86493112e+01, -1.34122616e+02,  1.93597711e+04],
       [-1.80987116e+01, -1.33722723e+02,  1.93597711e+04]]) (truncated) 
inducing_mean: array([[0.77594683],
       [0.88953334],
       [0.95688344],
       [1.06282733],
       [1.18770303]]) (truncated) 
inducing_chol: array([[[ 5.25776377e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.66533516e-01,  7.44735051e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.71896861e-01, -3.52160202e-01,  7.86543769e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.41477974e-03, -4.01476170e-04, -3.93407251e-05, ...,
          8.31503871e-01,  0.00000000e+00,  0.00000000e+00],
        [-8.27742279e-04, -5.52807802e-04, -1.09890542e-04, ...,
         -2.44549258e-01,  8.76126953e-01,  0.00000000e+00],
        [-5.65528222e-04, -3.74437160e-04, -1.12054228e-04, ...,
         -7.28210925e-02, -1.25625464e-01,  9.62091102e-01]]]) 
&#39;predict&#39;: 0.101 seconds
total run time : 4.56 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
70 / 100
current local expert:
           x          y        t         lon        lat
69 -110000.0 -1420000.0  19363.0 -175.570441 -77.220016
&#39;local_data_select&#39;: 0.004 seconds
number obs: 186
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.377 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([ 8.93274578, 11.50877909,  5.01737446]) 
kernel_variance: 3.2039533504442463
likelihood_variance: 1.9847519971757617
inducing_points: array([[-2.06153926e+01, -1.40761236e+02,  1.93625098e+04],
       [-2.02234305e+01, -1.41316874e+02,  1.93625098e+04],
       [-1.98313360e+01, -1.41872383e+02,  1.93625098e+04],
       [-1.94391123e+01, -1.42427760e+02,  1.93625098e+04],
       [-1.90467568e+01, -1.42983007e+02,  1.93625098e+04]]) (truncated) 
inducing_mean: array([[2.59493272],
       [2.1074584 ],
       [2.48825097],
       [2.42213852],
       [2.40964978]]) (truncated) 
inducing_chol: array([[[ 2.75983922e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.09747124e-01,  7.17084845e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.75813453e-01, -3.31628427e-01,  8.64307502e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 4.15913293e-03,  7.55133875e-04, -5.20664981e-04, ...,
          9.64270821e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.55892555e-04,  3.35301899e-04, -1.58337211e-04, ...,
         -4.86869353e-02,  9.85376816e-01,  0.00000000e+00],
        [ 1.29350272e-03, -4.76683166e-04, -1.68236735e-04, ...,
         -1.40198339e-02, -1.26228377e-02,  9.97214255e-01]]]) 
&#39;predict&#39;: 0.091 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 5.86 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
71 / 100
current local expert:
           x          y        t         lon        lat
70 -290000.0 -1400000.0  19363.0 -168.297099 -77.170746
&#39;local_data_select&#39;: 0.004 seconds
number obs: 216
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.595 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([41.94676326, 41.13783119,  5.94931554]) 
kernel_variance: 0.029123443777657916
likelihood_variance: 0.00042018714303705646
inducing_points: array([[  -35.75721965,  -146.43632699, 19359.77076389],
       [  -35.20419443,  -146.04164233, 19359.77077546],
       [  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019]]) (truncated) 
inducing_mean: array([[-0.03908344],
       [-0.41173029],
       [-0.23247271],
       [-0.12903955],
       [-0.01683821]]) (truncated) 
inducing_chol: array([[[ 6.15549584e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.89873375e-01,  4.87283707e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.61268663e-02, -5.07228244e-01,  8.00082896e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-9.15437243e-03,  3.14849174e-04, -7.34897869e-03, ...,
          9.61516460e-01,  0.00000000e+00,  0.00000000e+00],
        [-3.14215325e-03,  1.09685669e-05, -9.13515073e-03, ...,
         -4.97918259e-02,  9.82272422e-01,  0.00000000e+00],
        [-3.81510921e-03, -3.04041000e-04, -7.55898185e-03, ...,
         -2.45579060e-02, -1.79660569e-02,  9.94852317e-01]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 9.07 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
72 / 100
current local expert:
           x          y        t         lon      lat
71 -270000.0 -1400000.0  19363.0 -169.084118 -77.2061
&#39;local_data_select&#39;: 0.004 seconds
number obs: 234
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.821 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([42.92203392, 41.20290624,  3.56692564]) 
kernel_variance: 0.027675077948827287
likelihood_variance: 0.0003659727609193688
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[-0.14770889],
       [ 0.04230442],
       [ 0.05548944],
       [ 0.08659532],
       [ 0.12171385]]) (truncated) 
inducing_chol: array([[[ 6.04867538e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.96422433e-01,  4.89999686e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-6.11889179e-02, -5.04270074e-01,  8.00178468e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.02439519e-04, -2.98087390e-04, -2.06771636e-04, ...,
          9.58420253e-01,  0.00000000e+00,  0.00000000e+00],
        [ 5.94721118e-04, -1.64951056e-04,  1.19734750e-03, ...,
         -5.36769815e-02,  9.80801636e-01,  0.00000000e+00],
        [ 2.01534188e-04, -2.24733513e-04, -2.37610897e-03, ...,
         -2.61556253e-02, -1.94551619e-02,  9.94514430e-01]]]) 
&#39;predict&#39;: 0.099 seconds
total run time : 9.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
73 / 100
current local expert:
           x          y        t         lon        lat
72 -250000.0 -1400000.0  19363.0 -169.875328 -77.239015
&#39;local_data_select&#39;: 0.004 seconds
number obs: 263
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.742 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([35.48704347, 37.26257735,  1.94371905]) 
kernel_variance: 0.025346487261003768
likelihood_variance: 0.0003098964480575301
inducing_points: array([[  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648]]) (truncated) 
inducing_mean: array([[-0.14735851],
       [ 0.17741686],
       [ 0.08528045],
       [ 0.114834  ],
       [ 0.13751011]]) (truncated) 
inducing_chol: array([[[ 6.31936879e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.88526500e-01,  4.77605103e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.78957570e-02, -5.13661264e-01,  7.94556906e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 6.04442944e-03, -5.38373609e-05,  1.31162909e-03, ...,
          9.38372190e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.55228730e-03,  1.22881467e-04,  1.79385264e-03, ...,
         -7.79008701e-02,  9.71770937e-01,  0.00000000e+00],
        [ 3.84789482e-03,  3.54445715e-04,  4.95443723e-04, ...,
         -3.70415133e-02, -2.77848597e-02,  9.92122588e-01]]]) 
&#39;predict&#39;: 0.101 seconds
total run time : 10.22 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
74 / 100
current local expert:
           x          y        t        lon        lat
73 -230000.0 -1400000.0  19363.0 -170.67046 -77.269472
&#39;local_data_select&#39;: 0.004 seconds
number obs: 272
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.551 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([43.89492752, 42.06569198,  1.21796624]) 
kernel_variance: 0.016452268224634043
likelihood_variance: 0.00019624143837553845
inducing_points: array([[  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ]]) (truncated) 
inducing_mean: array([[-0.15137595],
       [ 0.34649546],
       [ 0.16861349],
       [ 0.07326235],
       [-0.00394323]]) (truncated) 
inducing_chol: array([[[ 5.84120801e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.85578489e-01,  5.21346197e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.52234243e-02, -5.24106645e-01,  7.69287303e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.92533044e-03,  5.53016172e-04, -2.04562604e-03, ...,
          9.50855719e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.37825095e-04,  1.23820335e-03, -1.49977455e-03, ...,
         -6.62841184e-02,  9.77331656e-01,  0.00000000e+00],
        [ 9.39857765e-04,  1.50127924e-03,  5.37813663e-04, ...,
         -2.79738517e-02, -2.40411682e-02,  9.93834368e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 10.04 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
75 / 100
current local expert:
           x          y        t         lon        lat
74 -210000.0 -1400000.0  19363.0 -171.469234 -77.297454
&#39;local_data_select&#39;: 0.004 seconds
number obs: 259
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.629 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([46.08511334, 38.77444056,  1.31766899]) 
kernel_variance: 0.01720663274995409
likelihood_variance: 0.00020066970356124334
inducing_points: array([[  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593]]) (truncated) 
inducing_mean: array([[-0.07063899],
       [-0.01283315],
       [-0.0199582 ],
       [-0.07099384],
       [-0.11523415]]) (truncated) 
inducing_chol: array([[[ 6.03853229e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.96311050e-01,  5.17706611e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-7.33478418e-02, -5.33878855e-01,  7.70178231e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 9.42552613e-04, -1.63649398e-03,  2.67962259e-04, ...,
          9.43567218e-01,  0.00000000e+00,  0.00000000e+00],
        [ 8.24103995e-04, -1.07397041e-03, -3.30376949e-04, ...,
         -7.41671031e-02,  9.73759317e-01,  0.00000000e+00],
        [-2.53305265e-04,  2.94017842e-04,  9.66528429e-04, ...,
         -3.46803505e-02, -2.73406270e-02,  9.92344672e-01]]]) 
&#39;predict&#39;: 0.090 seconds
total run time : 10.11 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
76 / 100
current local expert:
           x          y        t         lon        lat
75 -190000.0 -1400000.0  19363.0 -172.271363 -77.322945
&#39;local_data_select&#39;: 0.004 seconds
number obs: 259
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 8.613 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([44.03807904, 25.06083894,  1.30684315]) 
kernel_variance: 0.019434924606271234
likelihood_variance: 0.000262972224244391
inducing_points: array([[  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222]]) (truncated) 
inducing_mean: array([[-0.04589181],
       [-0.1860651 ],
       [-0.10492292],
       [-0.06470971],
       [-0.0379934 ]]) (truncated) 
inducing_chol: array([[[ 6.78853478e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.97981332e-01,  4.91496046e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-5.46509607e-02, -5.19738540e-01,  7.90024660e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 3.97921647e-04, -4.04560252e-03,  2.61882630e-03, ...,
          8.99408012e-01,  0.00000000e+00,  0.00000000e+00],
        [ 2.65029030e-04,  5.86039444e-05,  1.10538867e-03, ...,
         -1.25988527e-01,  9.51830300e-01,  0.00000000e+00],
        [ 1.58774710e-04,  8.62613516e-04,  3.62019704e-04, ...,
         -6.30751386e-02, -4.60898188e-02,  9.85802653e-01]]]) 
&#39;predict&#39;: 0.088 seconds
total run time : 10.10 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
77 / 100
current local expert:
           x          y        t         lon       lat
76 -170000.0 -1400000.0  19363.0 -173.076551 -77.34593
&#39;local_data_select&#39;: 0.003 seconds
number obs: 253
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.070 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.279 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([7.11232957, 7.54133071, 4.57014584]) 
kernel_variance: 2.750891203138449
likelihood_variance: 1.8532898150380426
inducing_points: array([[  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694]]) (truncated) 
inducing_mean: array([[1.43617115],
       [1.57663872],
       [1.64232681],
       [1.69942473],
       [1.76850797]]) (truncated) 
inducing_chol: array([[[ 4.02069286e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.05368993e-01,  7.45429920e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.79426701e-01, -3.31971633e-01,  8.53920326e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.59143125e-03,  9.74553624e-04,  1.93459055e-03, ...,
          9.33687598e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.40805511e-03,  2.03777595e-03,  7.34238150e-04, ...,
         -1.03875648e-01,  9.66585445e-01,  0.00000000e+00],
        [-3.31481164e-05,  8.85081542e-04,  6.00212852e-04, ...,
         -2.80407689e-02, -2.84070305e-02,  9.93581486e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 4.79 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
78 / 100
current local expert:
           x          y        t         lon        lat
77 -150000.0 -1400000.0  19363.0 -173.884496 -77.366396
&#39;local_data_select&#39;: 0.003 seconds
number obs: 245
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.050 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([5.36160761, 5.42440744, 3.75298675]) 
kernel_variance: 2.362731118221965
likelihood_variance: 1.7187862293634575
inducing_points: array([[  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009],
       [  -23.05702017,  -137.31578196, 19359.77104167],
       [  -22.50577519,  -136.91721909, 19359.77105324]]) (truncated) 
inducing_mean: array([[1.29593572],
       [1.42733104],
       [1.49654867],
       [1.54435373],
       [1.59919957]]) (truncated) 
inducing_chol: array([[[ 4.48353875e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.00894189e-01,  7.49205355e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.75488987e-01, -3.35763201e-01,  8.31637677e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.44445965e-03, -2.84257329e-03, -2.23109042e-03, ...,
          8.84594741e-01,  0.00000000e+00,  0.00000000e+00],
        [-3.14258416e-03, -2.27565727e-03, -1.46846103e-03, ...,
         -1.78571904e-01,  9.29211480e-01,  0.00000000e+00],
        [-1.89814342e-03, -6.48831186e-04, -5.06114954e-04, ...,
         -4.86092954e-02, -6.90116563e-02,  9.84772024e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 4.57 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
79 / 100
current local expert:
           x          y        t        lon       lat
78 -130000.0 -1400000.0  19363.0 -174.69489 -77.38433
&#39;local_data_select&#39;: 0.004 seconds
number obs: 226
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.901 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([ 9.82265885, 38.60796243,  4.1072831 ]) 
kernel_variance: 7.037582699973442
likelihood_variance: 3.2234959138849364
inducing_points: array([[  -22.50577519,  -136.91721909, 19359.77105324],
       [  -21.9546141 ,  -136.51849131, 19359.77106481],
       [  -21.40353523,  -136.11960012, 19359.77107639],
       [  -20.85252591,  -135.72053396, 19359.77108796],
       [  -20.30161285,  -135.32131202, 19359.77109954]]) (truncated) 
inducing_mean: array([[6.80448341],
       [6.71329543],
       [6.55376158],
       [6.54318973],
       [6.48008416]]) (truncated) 
inducing_chol: array([[[ 3.02933953e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.31293566e-01,  6.91672562e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.63497435e-01, -3.50047738e-01,  8.64279732e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-5.72698828e-04,  2.86603630e-04,  3.03135583e-05, ...,
          9.79315703e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.23909163e-03, -5.90781499e-04, -3.97730256e-04, ...,
         -2.54894297e-02,  9.90995405e-01,  0.00000000e+00],
        [-8.73063113e-04, -1.32180459e-03, -1.35442126e-04, ...,
         -1.00733812e-02, -7.42209285e-03,  9.98067389e-01]]]) 
&#39;predict&#39;: 0.098 seconds
total run time : 6.43 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
80 / 100
current local expert:
           x          y        t         lon        lat
79 -110000.0 -1400000.0  19363.0 -175.507419 -77.399722
&#39;local_data_select&#39;: 0.004 seconds
number obs: 185
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 5.542 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([ 9.77290822, 32.99166888,  4.55540098]) 
kernel_variance: 8.247826311126046
likelihood_variance: 3.62643674341724
inducing_points: array([[-1.91999964e+01, -1.34522346e+02,  1.93597711e+04],
       [-1.86493112e+01, -1.34122616e+02,  1.93597711e+04],
       [-1.80987116e+01, -1.33722723e+02,  1.93597711e+04],
       [-1.75481997e+01, -1.33322666e+02,  1.93597712e+04],
       [-1.69977647e+01, -1.32922444e+02,  1.93597712e+04]]) (truncated) 
inducing_mean: array([[8.11107393],
       [7.8505566 ],
       [7.47465106],
       [7.32853147],
       [7.16786314]]) (truncated) 
inducing_chol: array([[[ 2.65958912e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.10293280e-01,  6.66927184e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.58918322e-01, -3.51148279e-01,  8.62439548e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.83995520e-04,  1.49515667e-03, -6.22135416e-04, ...,
          9.73947288e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.29582926e-03,  1.17440870e-03,  7.92252587e-04, ...,
         -3.17348196e-02,  9.88829377e-01,  0.00000000e+00],
        [-7.91178921e-04, -5.20811830e-04,  1.34489709e-04, ...,
         -1.11381209e-02, -8.99180667e-03,  9.97831155e-01]]]) 
&#39;predict&#39;: 0.093 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 8.15 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
81 / 100
current local expert:
           x          y        t         lon        lat
80 -290000.0 -1380000.0  19363.0 -168.132268 -77.347208
&#39;local_data_select&#39;: 0.004 seconds
number obs: 219
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 7.735 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([45.95705049, 41.25566136,  4.72069147]) 
kernel_variance: 0.024143277994514975
likelihood_variance: 0.0004124782475750899
inducing_points: array([[  -34.65124878,  -145.64679105, 19359.77078704],
       [  -34.09837803,  -145.25176902, 19359.77079861],
       [  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333]]) (truncated) 
inducing_mean: array([[-0.16481412],
       [ 0.12012413],
       [ 0.06838094],
       [ 0.07590799],
       [ 0.10350503]]) (truncated) 
inducing_chol: array([[[ 6.43733166e-02,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.12797537e-01,  5.11522321e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-8.21470219e-02, -5.08407163e-01,  7.98597030e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-9.32801552e-04, -8.94702318e-03,  5.14543351e-03, ...,
          9.65471468e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.69369737e-04, -9.64857667e-03,  3.79322664e-03, ...,
         -4.47871526e-02,  9.84015342e-01,  0.00000000e+00],
        [-3.22072574e-03, -5.80294372e-03,  3.96828099e-03, ...,
         -2.24029596e-02, -1.64560796e-02,  9.95179928e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 9.27 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
82 / 100
current local expert:
           x          y        t         lon        lat
81 -270000.0 -1380000.0  19363.0 -168.929797 -77.383048
&#39;local_data_select&#39;: 0.004 seconds
number obs: 244
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.068 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.123 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([4.38914877, 5.56137602, 3.65807261]) 
kernel_variance: 2.254698226869774
likelihood_variance: 1.6424522763671807
inducing_points: array([[  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648]]) (truncated) 
inducing_mean: array([[0.50105758],
       [0.6348127 ],
       [0.69512393],
       [0.77042719],
       [0.84285825]]) (truncated) 
inducing_chol: array([[[ 4.55280878e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.22755569e-01,  7.14547679e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.99101322e-01, -4.08456698e-01,  7.75412648e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.45506832e-03, -8.35014713e-04, -1.30671501e-03, ...,
          8.94815592e-01,  0.00000000e+00,  0.00000000e+00],
        [ 6.69466659e-05, -1.34628732e-03, -4.28396062e-04, ...,
         -1.58563379e-01,  9.38378681e-01,  0.00000000e+00],
        [-1.35947961e-03, -9.25922381e-04,  1.63897327e-04, ...,
         -4.01371017e-02, -6.11462465e-02,  9.86293658e-01]]]) 
&#39;predict&#39;: 0.092 seconds
total run time : 4.66 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
83 / 100
current local expert:
           x          y        t         lon        lat
82 -250000.0 -1380000.0  19363.0 -169.731694 -77.416417
&#39;local_data_select&#39;: 0.004 seconds
number obs: 255
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.073 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.690 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([ 5.23396125, 16.17424374,  7.08075292]) 
kernel_variance: 4.2247589781227415
likelihood_variance: 2.2746763058407296
inducing_points: array([[  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963]]) (truncated) 
inducing_mean: array([[3.3515499 ],
       [3.49122954],
       [3.53850409],
       [3.57639391],
       [3.60648533]]) (truncated) 
inducing_chol: array([[[ 2.71469062e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.09441052e-01,  6.26400984e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.66369165e-01, -4.24127498e-01,  7.80137083e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.10721338e-03,  1.81664742e-03,  8.69493337e-04, ...,
          9.62198696e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.35053947e-04, -3.48737802e-04,  1.25983534e-04, ...,
         -4.89526575e-02,  9.81942433e-01,  0.00000000e+00],
        [-1.22418187e-04, -5.61097437e-04,  7.11729119e-05, ...,
         -1.74248755e-02, -1.51002322e-02,  9.96010188e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 5.25 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
84 / 100
current local expert:
           x          y        t         lon        lat
83 -230000.0 -1380000.0  19363.0 -170.537678 -77.447297
&#39;local_data_select&#39;: 0.004 seconds
number obs: 259
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.068 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.834 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([ 5.2652019 , 15.8234664 ,  7.28824963]) 
kernel_variance: 4.539109413124675
likelihood_variance: 2.39846443226615
inducing_points: array([[  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278]]) (truncated) 
inducing_mean: array([[3.80214274],
       [3.88042935],
       [3.88724482],
       [3.91653971],
       [3.95453071]]) (truncated) 
inducing_chol: array([[[ 2.40831086e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.23908016e-01,  6.92122154e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.44193164e-01, -3.44701186e-01,  8.27386939e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 7.32254713e-04,  1.76779250e-04, -1.30381430e-03, ...,
          9.64152505e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.91690557e-03,  2.51828480e-03, -1.89470985e-03, ...,
         -4.57369813e-02,  9.82808745e-01,  0.00000000e+00],
        [ 1.96052762e-04,  2.52899099e-04,  2.97159128e-04, ...,
         -1.69356279e-02, -1.41374689e-02,  9.96194647e-01]]]) 
&#39;predict&#39;: 0.092 seconds
total run time : 5.36 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
85 / 100
current local expert:
           x          y        t         lon       lat
84 -210000.0 -1380000.0  19363.0 -171.347458 -77.47567
&#39;local_data_select&#39;: 0.003 seconds
number obs: 258
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.344 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([8.40373637, 9.70052604, 5.31519318]) 
kernel_variance: 3.130715200301656
likelihood_variance: 1.9269868413255329
inducing_points: array([[  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ]]) (truncated) 
inducing_mean: array([[2.21060634],
       [2.25477042],
       [2.26125316],
       [2.28544621],
       [2.31771095]]) (truncated) 
inducing_chol: array([[[ 3.66932226e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.17587742e-01,  7.39036789e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.77944113e-01, -3.29263163e-01,  8.64356439e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 9.97438428e-04,  4.22927412e-03,  2.55715785e-04, ...,
          9.63005710e-01,  0.00000000e+00,  0.00000000e+00],
        [ 8.23940734e-04,  2.71252254e-03,  3.07720396e-04, ...,
         -5.38504973e-02,  9.84360690e-01,  0.00000000e+00],
        [-2.73417372e-04,  7.35689803e-04,  6.89403746e-06, ...,
         -1.27162245e-02, -1.31860803e-02,  9.97160565e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 4.91 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
86 / 100
current local expert:
           x          y        t         lon        lat
85 -190000.0 -1380000.0  19363.0 -172.160737 -77.501518
&#39;local_data_select&#39;: 0.003 seconds
number obs: 246
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.065 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.488 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([11.00877158, 13.91119256,  5.69557589]) 
kernel_variance: 3.807857638684614
likelihood_variance: 2.173848954827734
inducing_points: array([[  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ]]) (truncated) 
inducing_mean: array([[3.29490786],
       [3.33014141],
       [3.3328991 ],
       [3.36297802],
       [3.37553243]]) (truncated) 
inducing_chol: array([[[ 3.21536687e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.17794315e-01,  7.22457179e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.70757679e-01, -3.16251014e-01,  8.81464997e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 6.85699185e-04, -9.41168319e-04,  6.25287843e-04, ...,
          9.77563758e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.49669577e-03, -1.61202227e-03,  5.27849398e-04, ...,
         -2.75788722e-02,  9.90437488e-01,  0.00000000e+00],
        [ 2.11652985e-03, -1.02703435e-03,  1.47274725e-04, ...,
         -9.48293273e-03, -7.65497674e-03,  9.98106572e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 5.09 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
87 / 100
current local expert:
           x          y        t         lon        lat
86 -170000.0 -1380000.0  19363.0 -172.977206 -77.524826
&#39;local_data_select&#39;: 0.004 seconds
number obs: 246
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.068 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.113 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([10.50816984, 24.03822857,  4.56971673]) 
kernel_variance: 5.217396426120452
likelihood_variance: 2.651939642776794
inducing_points: array([[  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852]]) (truncated) 
inducing_mean: array([[4.94910945],
       [4.93449897],
       [4.85950204],
       [4.90361999],
       [4.92178745]]) (truncated) 
inducing_chol: array([[[ 3.11226485e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.28387877e-01,  7.11624384e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.65759527e-01, -3.21241429e-01,  8.79111557e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.54547611e-03, -7.02460856e-04, -9.10191740e-04, ...,
          9.80469339e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.07116255e-04,  8.61524822e-05, -9.58767572e-04, ...,
         -2.35501853e-02,  9.92150736e-01,  0.00000000e+00],
        [ 1.25635889e-03, -1.64014830e-04, -1.18936421e-04, ...,
         -8.11488239e-03, -6.17236152e-03,  9.98517413e-01]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 5.71 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
88 / 100
current local expert:
           x          y        t         lon       lat
87 -150000.0 -1380000.0  19363.0 -173.796552 -77.54558
&#39;local_data_select&#39;: 0.004 seconds
number obs: 245
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.780 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([10.21146027, 35.41008611,  3.77467675]) 
kernel_variance: 6.611884477261794
likelihood_variance: 3.10039697452275
inducing_points: array([[  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009],
       [  -23.05702017,  -137.31578196, 19359.77104167],
       [  -22.50577519,  -136.91721909, 19359.77105324]]) (truncated) 
inducing_mean: array([[6.34811927],
       [6.30581075],
       [6.19227838],
       [6.17520616],
       [6.15782259]]) (truncated) 
inducing_chol: array([[[ 3.10831911e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.36372944e-01,  7.02129896e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.61065806e-01, -3.36140108e-01,  8.71909076e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.16494049e-03,  5.08582634e-04, -1.00963015e-04, ...,
          9.79883940e-01,  0.00000000e+00,  0.00000000e+00],
        [-4.18124215e-04, -8.61877279e-04, -1.25210459e-04, ...,
         -2.42790665e-02,  9.91719943e-01,  0.00000000e+00],
        [ 2.65978315e-04, -9.64231173e-04, -6.98083213e-05, ...,
         -8.49218833e-03, -6.60029484e-03,  9.98359977e-01]]]) 
&#39;predict&#39;: 0.091 seconds
total run time : 6.34 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
89 / 100
current local expert:
           x          y        t         lon        lat
88 -130000.0 -1380000.0  19363.0 -174.618453 -77.563768
&#39;local_data_select&#39;: 0.003 seconds
number obs: 230
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.162 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([10.18812847, 26.64976287,  3.71167846]) 
kernel_variance: 5.370441717819708
likelihood_variance: 2.708258774956534
inducing_points: array([[  -22.50577519,  -136.91721909, 19359.77105324],
       [  -21.9546141 ,  -136.51849131, 19359.77106481],
       [  -21.40353523,  -136.11960012, 19359.77107639],
       [  -20.85252591,  -135.72053396, 19359.77108796],
       [  -20.30161285,  -135.32131202, 19359.77109954]]) (truncated) 
inducing_mean: array([[5.37709317],
       [5.28967508],
       [5.2245591 ],
       [5.20330571],
       [5.14510402]]) (truncated) 
inducing_chol: array([[[ 3.11472199e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.34778724e-01,  6.93544475e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.74268728e-01, -3.43327564e-01,  8.67445717e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-3.76913373e-04,  4.15730475e-03, -7.45553965e-04, ...,
          9.78996701e-01,  0.00000000e+00,  0.00000000e+00],
        [-5.95456523e-04,  1.97490239e-03,  8.15774310e-05, ...,
         -2.54407593e-02,  9.91345769e-01,  0.00000000e+00],
        [-6.55622491e-04,  1.21361588e-04,  8.41369621e-04, ...,
         -8.99963221e-03, -6.92574545e-03,  9.98307964e-01]]]) 
&#39;predict&#39;: 0.095 seconds
total run time : 5.77 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
90 / 100
current local expert:
           x          y        t         lon        lat
89 -110000.0 -1380000.0  19363.0 -175.442581 -77.579379
&#39;local_data_select&#39;: 0.004 seconds
number obs: 197
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.551 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([10.1683026 , 31.63960847,  3.63298359]) 
kernel_variance: 6.426878424073902
likelihood_variance: 3.0729203990037455
inducing_points: array([[-2.03016128e+01, -1.35321312e+02,  1.93597711e+04],
       [-1.97507697e+01, -1.34921916e+02,  1.93597711e+04],
       [-1.91999964e+01, -1.34522346e+02,  1.93597711e+04],
       [-1.86493112e+01, -1.34122616e+02,  1.93597711e+04],
       [-1.80987116e+01, -1.33722723e+02,  1.93597711e+04]]) (truncated) 
inducing_mean: array([[6.59566861],
       [6.33940052],
       [6.04980189],
       [5.93989734],
       [5.82561141]]) (truncated) 
inducing_chol: array([[[ 2.94370236e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.44415351e-01,  6.87209559e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.65611839e-01, -3.45664244e-01,  8.68768633e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.52609026e-03,  8.86153265e-05, -2.62243454e-04, ...,
          9.78637145e-01,  0.00000000e+00,  0.00000000e+00],
        [ 7.89796294e-04, -2.17646309e-04, -2.59769563e-04, ...,
         -2.57833246e-02,  9.91247655e-01,  0.00000000e+00],
        [-3.34639995e-04, -3.85133096e-04, -4.86988921e-05, ...,
         -9.08378873e-03, -6.87691769e-03,  9.98291062e-01]]]) 
&#39;predict&#39;: 0.093 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 7.16 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
91 / 100
current local expert:
           x          y        t         lon       lat
90 -290000.0 -1360000.0  19363.0 -167.962798 -77.52353
&#39;local_data_select&#39;: 0.004 seconds
number obs: 225
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.407 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([ 5.04986514, 13.39631643,  6.12901144]) 
kernel_variance: 3.402494847709076
likelihood_variance: 2.038298165361259
inducing_points: array([[  -33.54558187,  -144.85657719, 19359.77081019],
       [  -32.99285384,  -144.46120922, 19359.77082176],
       [  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648]]) (truncated) 
inducing_mean: array([[2.41176844],
       [2.48267042],
       [2.53001021],
       [2.59142244],
       [2.65892028]]) (truncated) 
inducing_chol: array([[[ 3.61098547e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.34082868e-01,  6.62726258e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.95259023e-01, -4.41248443e-01,  7.69867542e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-7.54224712e-04, -7.00832777e-05,  1.01705619e-03, ...,
          9.67508224e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.13241873e-03, -6.93168949e-04,  7.62620461e-04, ...,
         -4.81666130e-02,  9.80515093e-01,  0.00000000e+00],
        [-4.64211738e-04, -2.29587077e-04, -3.90521474e-04, ...,
         -1.60802826e-02, -1.70670615e-02,  9.95283839e-01]]]) 
&#39;predict&#39;: 0.092 seconds
total run time : 5.00 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
92 / 100
current local expert:
           x          y        t         lon        lat
91 -270000.0 -1360000.0  19363.0 -168.771108 -77.559868
&#39;local_data_select&#39;: 0.003 seconds
number obs: 243
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.074 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.176 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([ 5.68500125, 19.00226878,  7.97483223]) 
kernel_variance: 5.5582930273574025
likelihood_variance: 2.7034588641822728
inducing_points: array([[  -32.44020552,  -144.06567437, 19359.77083333],
       [  -31.88763421,  -143.66997142, 19359.77084491],
       [  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963]]) (truncated) 
inducing_mean: array([[5.17311129],
       [5.22868242],
       [5.21836459],
       [5.25463061],
       [5.27573149]]) (truncated) 
inducing_chol: array([[[ 2.43511454e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-3.68075536e-01,  6.18334037e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.61367791e-01, -4.07001843e-01,  7.93497560e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-1.56015584e-03,  9.67212478e-04,  6.18673154e-04, ...,
          9.84701595e-01,  0.00000000e+00,  0.00000000e+00],
        [-9.78538226e-04,  4.23880974e-04,  6.14145031e-04, ...,
         -2.24450148e-02,  9.89986668e-01,  0.00000000e+00],
        [-6.39650014e-04, -4.20311350e-05,  9.32380394e-05, ...,
         -8.93642929e-03, -8.71365787e-03,  9.97377338e-01]]]) 
&#39;predict&#39;: 0.093 seconds
total run time : 5.79 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
93 / 100
current local expert:
           x          y        t         lon        lat
92 -250000.0 -1360000.0  19363.0 -169.583972 -77.593705
&#39;local_data_select&#39;: 0.003 seconds
number obs: 251
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.071 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.313 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([ 4.31351752, 12.09750273,  5.76173272]) 
kernel_variance: 3.228308923276346
likelihood_variance: 1.9993698026020863
inducing_points: array([[  -31.33513525,  -143.27409485, 19359.77085648],
       [  -30.7827185 ,  -142.87805453, 19359.77086806],
       [  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278]]) (truncated) 
inducing_mean: array([[2.39323228],
       [2.48080495],
       [2.52569902],
       [2.57858954],
       [2.61765564]]) (truncated) 
inducing_chol: array([[[ 2.77758104e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-2.15598002e-01,  7.15387365e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.36727189e-01, -3.30238659e-01,  8.27163225e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 8.14597083e-04, -5.28014190e-04,  2.36337323e-04, ...,
          9.63669078e-01,  0.00000000e+00,  0.00000000e+00],
        [ 4.08281295e-04, -1.92157705e-04,  1.82742189e-04, ...,
         -5.56898876e-02,  9.78890997e-01,  0.00000000e+00],
        [-7.66504747e-05, -3.89656610e-05, -2.95666868e-04, ...,
         -2.03242667e-02, -1.80151830e-02,  9.94257916e-01]]]) 
&#39;predict&#39;: 0.096 seconds
total run time : 4.95 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
94 / 100
current local expert:
           x          y        t         lon       lat
93 -230000.0 -1360000.0  19363.0 -170.401097 -77.62502
&#39;local_data_select&#39;: 0.004 seconds
number obs: 240
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.072 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 2.976 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([4.4654221 , 5.0315708 , 3.45603555]) 
kernel_variance: 2.1821027530241155
likelihood_variance: 1.667046755260864
inducing_points: array([[  -30.23038008,  -142.4818456 , 19359.77087963],
       [  -29.67811764,  -142.08546725, 19359.7708912 ],
       [  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593]]) (truncated) 
inducing_mean: array([[1.10325873],
       [1.16851119],
       [1.21410283],
       [1.25553401],
       [1.30522687]]) (truncated) 
inducing_chol: array([[[ 0.48898471,  0.        ,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.38739683,  0.76239701,  0.        , ...,  0.        ,
          0.        ,  0.        ],
        [-0.16876016, -0.32724035,  0.82661911, ...,  0.        ,
          0.        ,  0.        ],
        ...,
        [-0.00209255,  0.00182603,  0.00373519, ...,  0.95197434,
          0.        ,  0.        ],
        [-0.00193851,  0.00113234,  0.00249756, ..., -0.11163543,
          0.91769043,  0.        ],
        [-0.00130189,  0.00101802,  0.0018582 , ..., -0.03325274,
         -0.08565435,  0.97691238]]]) 
&#39;predict&#39;: 0.102 seconds
total run time : 4.58 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
95 / 100
current local expert:
           x          y        t         lon        lat
94 -210000.0 -1360000.0  19363.0 -171.222183 -77.653794
&#39;local_data_select&#39;: 0.004 seconds
number obs: 239
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.069 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.355 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([10.26505499, 11.87791812,  5.98911511]) 
kernel_variance: 3.5361503066687807
likelihood_variance: 2.0936070021507174
inducing_points: array([[  -29.12594563,  -141.68892915, 19359.77090278],
       [  -28.57382945,  -141.29220733, 19359.77091435],
       [  -28.02178732,  -140.89531485, 19359.77092593],
       [  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065]]) (truncated) 
inducing_mean: array([[3.06962116],
       [3.10462795],
       [3.09573018],
       [3.10793417],
       [3.13666357]]) (truncated) 
inducing_chol: array([[[ 3.44200431e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.24461941e-01,  7.30650583e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.71478667e-01, -3.19750143e-01,  8.76888712e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.32295262e-03,  4.08347559e-03,  3.33152296e-04, ...,
          9.91124930e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.67769934e-03,  2.65525245e-03,  9.07710470e-05, ...,
         -1.11048779e-02,  9.95839111e-01,  0.00000000e+00],
        [-3.90177932e-04,  6.85002879e-04, -9.47589231e-05, ...,
         -3.93378722e-03, -3.61660521e-03,  9.99017190e-01]]]) 
&#39;predict&#39;: 0.090 seconds
total run time : 4.95 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
96 / 100
current local expert:
           x          y        t         lon        lat
95 -190000.0 -1360000.0  19363.0 -172.046918 -77.680009
&#39;local_data_select&#39;: 0.004 seconds
number obs: 241
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.077 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.057 seconds
&#39;get_parameters&#39;: 0.015 seconds
parameters:
lengthscales: array([14.03309211, 13.43174658,  6.17559831]) 
kernel_variance: 5.10522328358083
likelihood_variance: 2.6068451425794157
inducing_points: array([[  -27.46982421,  -140.49825494, 19359.7709375 ],
       [  -26.91793757,  -140.10102596, 19359.77096065],
       [  -26.36614175,  -139.70363532, 19359.77097222],
       [  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537]]) (truncated) 
inducing_mean: array([[5.14548975],
       [5.10051311],
       [4.97936615],
       [4.97434808],
       [4.97796303]]) (truncated) 
inducing_chol: array([[[ 2.98222964e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.13400977e-01,  7.10612030e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.63969694e-01, -3.13783970e-01,  8.87669154e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-4.84923616e-04,  4.06514495e-05, -3.65661826e-04, ...,
          9.84073964e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.12344397e-04,  2.07747100e-05,  2.01968562e-04, ...,
         -1.92644960e-02,  9.93404016e-01,  0.00000000e+00],
        [ 2.54536715e-04, -7.27211677e-04,  3.02814436e-04, ...,
         -7.10512203e-03, -5.29301157e-03,  9.98659948e-01]]]) 
&#39;predict&#39;: 0.097 seconds
total run time : 5.73 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
97 / 100
current local expert:
           x          y        t         lon       lat
96 -170000.0 -1360000.0  19363.0 -172.874984 -77.70365
&#39;local_data_select&#39;: 0.004 seconds
number obs: 236
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.065 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 3.296 seconds
&#39;get_parameters&#39;: 0.014 seconds
parameters:
lengthscales: array([10.61922937, 11.33007478,  5.26282762]) 
kernel_variance: 3.410542860647168
likelihood_variance: 2.0604555364079733
inducing_points: array([[  -25.81442515,  -139.30607998, 19359.7709838 ],
       [  -25.2627888 ,  -138.90835715, 19359.77099537],
       [  -24.71122053,  -138.51045943, 19359.77100694],
       [  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009]]) (truncated) 
inducing_mean: array([[3.04094423],
       [3.06879093],
       [3.08024635],
       [3.11799021],
       [3.17970853]]) (truncated) 
inducing_chol: array([[[ 3.38704663e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.09872170e-01,  7.31390312e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.71207212e-01, -3.17849613e-01,  8.78111004e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [-2.75202487e-03,  4.00901514e-04, -3.56494613e-04, ...,
          9.73268904e-01,  0.00000000e+00,  0.00000000e+00],
        [-1.19284698e-03,  3.40948230e-04, -2.62082340e-05, ...,
         -3.54995860e-02,  9.88918800e-01,  0.00000000e+00],
        [-6.41795934e-04,  3.02306024e-04,  2.21544819e-04, ...,
         -1.16647721e-02, -8.56814375e-03,  9.97632925e-01]]]) 
&#39;predict&#39;: 0.091 seconds
total run time : 4.92 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
98 / 100
current local expert:
           x          y        t         lon        lat
97 -150000.0 -1360000.0  19363.0 -173.706052 -77.724701
&#39;local_data_select&#39;: 0.004 seconds
number obs: 229
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.067 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.865 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([10.99460014, 35.69278859,  3.77383348]) 
kernel_variance: 6.971215129242499
likelihood_variance: 3.227592315095001
inducing_points: array([[  -24.1597378 ,  -138.11239762, 19359.77101852],
       [  -23.60833831,  -137.71417241, 19359.77103009],
       [  -23.05702017,  -137.31578196, 19359.77104167],
       [  -22.50577519,  -136.91721909, 19359.77105324],
       [  -21.9546141 ,  -136.51849131, 19359.77106481]]) (truncated) 
inducing_mean: array([[6.87331079],
       [6.80692127],
       [6.65137242],
       [6.65182716],
       [6.65764048]]) (truncated) 
inducing_chol: array([[[ 3.00890987e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.46502847e-01,  6.94376265e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.65714452e-01, -3.37778364e-01,  8.75158243e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.06914206e-03, -1.44079761e-03, -2.22310975e-03, ...,
          9.81011104e-01,  0.00000000e+00,  0.00000000e+00],
        [ 6.20188534e-04, -7.52901913e-04, -1.47537965e-03, ...,
         -2.27424811e-02,  9.92341341e-01,  0.00000000e+00],
        [ 1.27452972e-04,  9.21724362e-05,  8.22716830e-05, ...,
         -7.64190362e-03, -6.06467965e-03,  9.98565497e-01]]]) 
&#39;predict&#39;: 0.100 seconds
total run time : 6.51 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
99 / 100
current local expert:
           x          y        t         lon       lat
98 -130000.0 -1360000.0  19363.0 -174.539787 -77.74315
&#39;local_data_select&#39;: 0.005 seconds
number obs: 213
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.064 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 4.960 seconds
&#39;get_parameters&#39;: 0.016 seconds
parameters:
lengthscales: array([10.66671541, 32.42471482,  3.8789655 ]) 
kernel_variance: 7.2594356430959
likelihood_variance: 3.3328357551588565
inducing_points: array([[  -22.50577519,  -136.91721909, 19359.77105324],
       [  -21.9546141 ,  -136.51849131, 19359.77106481],
       [  -21.40353523,  -136.11960012, 19359.77107639],
       [  -20.85252591,  -135.72053396, 19359.77108796],
       [  -20.30161285,  -135.32131202, 19359.77109954]]) (truncated) 
inducing_mean: array([[7.34133522],
       [7.22621942],
       [7.07571933],
       [7.04919412],
       [6.98023815]]) (truncated) 
inducing_chol: array([[[ 2.92867484e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.49865828e-01,  6.84808140e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.60990918e-01, -3.49543960e-01,  8.67750668e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 1.16853476e-04,  1.11185385e-03, -4.14875620e-04, ...,
          9.79925775e-01,  0.00000000e+00,  0.00000000e+00],
        [ 1.43830448e-03,  1.10748215e-03, -2.45838426e-04, ...,
         -2.42597783e-02,  9.91745475e-01,  0.00000000e+00],
        [-2.85437716e-04,  2.18616296e-04,  5.83505205e-05, ...,
         -8.70813350e-03, -6.66936095e-03,  9.98398179e-01]]]) 
&#39;predict&#39;: 0.094 seconds
total run time : 6.61 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
100 / 100
current local expert:
           x          y        t         lon        lat
99 -110000.0 -1360000.0  19363.0 -175.375849 -77.758986
&#39;local_data_select&#39;: 0.004 seconds
number obs: 193
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
setting inducing points to data points...
&#39;__init__&#39;: 0.075 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
setting parameter inducing_points to be untrainable
inducing_points is not detected as a hyperparameter. Skipping...
objective did not improve stopping
&#39;optimise_parameters&#39;: 6.006 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([10.9432727 , 14.98715338,  4.5266547 ]) 
kernel_variance: 9.275839676387367
likelihood_variance: 3.9939812573442963
inducing_points: array([[-2.08525259e+01, -1.35720534e+02,  1.93597711e+04],
       [-2.03016128e+01, -1.35321312e+02,  1.93597711e+04],
       [-1.97507697e+01, -1.34921916e+02,  1.93597711e+04],
       [-1.91999964e+01, -1.34522346e+02,  1.93597711e+04],
       [-1.86493112e+01, -1.34122616e+02,  1.93597711e+04]]) (truncated) 
inducing_mean: array([[9.66301873],
       [9.41425763],
       [9.10829183],
       [9.00181181],
       [8.89140742]]) (truncated) 
inducing_chol: array([[[ 2.82125845e-01,  0.00000000e+00,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-4.56642478e-01,  6.62170745e-01,  0.00000000e+00, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        [-1.70808565e-01, -3.73194500e-01,  8.52000951e-01, ...,
          0.00000000e+00,  0.00000000e+00,  0.00000000e+00],
        ...,
        [ 2.69255604e-03,  8.37391527e-04,  1.13281195e-03, ...,
          9.71623336e-01,  0.00000000e+00,  0.00000000e+00],
        [ 3.68527089e-03,  1.00299869e-03,  3.10353014e-04, ...,
         -3.40079716e-02,  9.88044560e-01,  0.00000000e+00],
        [ 2.15653344e-03,  5.38249234e-04,  1.59844397e-04, ...,
         -1.32279353e-02, -9.55451136e-03,  9.97546809e-01]]]) 
&#39;predict&#39;: 0.085 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
inducing_points
inducing_mean
inducing_chol
total run time : 8.82 seconds
&#39;run&#39;: 836.336 seconds
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract, store in dict</span>
<span class="n">dfs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">get_results_from_h5file</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tables in results file: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reading in results
getting all tables
merging on expert location data
table: &#39;oi_config&#39; does not have all coords_col: [&#39;x&#39;, &#39;y&#39;, &#39;t&#39;] in columns, not merging on expert_locations
tables in results file: [&#39;expert_locs&#39;, &#39;inducing_chol&#39;, &#39;inducing_mean&#39;, &#39;inducing_points&#39;, &#39;kernel_variance&#39;, &#39;lengthscales&#39;, &#39;likelihood_variance&#39;, &#39;oi_config&#39;, &#39;preds&#39;, &#39;run_details&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>dict_keys([&#39;expert_locs&#39;, &#39;inducing_chol&#39;, &#39;inducing_mean&#39;, &#39;inducing_points&#39;, &#39;kernel_variance&#39;, &#39;lengthscales&#39;, &#39;likelihood_variance&#39;, &#39;oi_config&#39;, &#39;preds&#39;, &#39;run_details&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dfs</span><span class="p">[</span><span class="s1">&#39;lengthscales&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-f85b9f78-928d-41a3-a048-b442b3b18a6d" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>_dim_0</th>
      <th>lengthscales</th>
      <th>lon</th>
      <th>lat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-280000.0</td>
      <td>-1530000.0</td>
      <td>19363.0</td>
      <td>0</td>
      <td>22.605468</td>
      <td>-169.629258</td>
      <td>-76.037090</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-280000.0</td>
      <td>-1530000.0</td>
      <td>19363.0</td>
      <td>1</td>
      <td>17.291273</td>
      <td>-169.629258</td>
      <td>-76.037090</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-280000.0</td>
      <td>-1530000.0</td>
      <td>19363.0</td>
      <td>2</td>
      <td>7.905736</td>
      <td>-169.629258</td>
      <td>-76.037090</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-240000.0</td>
      <td>-1530000.0</td>
      <td>19363.0</td>
      <td>0</td>
      <td>26.630315</td>
      <td>-171.085073</td>
      <td>-76.097564</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-240000.0</td>
      <td>-1530000.0</td>
      <td>19363.0</td>
      <td>1</td>
      <td>21.315793</td>
      <td>-171.085073</td>
      <td>-76.097564</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>70</th>
      <td>-160000.0</td>
      <td>-1370000.0</td>
      <td>19363.0</td>
      <td>1</td>
      <td>25.497599</td>
      <td>-173.338698</td>
      <td>-77.625020</td>
    </tr>
    <tr>
      <th>71</th>
      <td>-160000.0</td>
      <td>-1370000.0</td>
      <td>19363.0</td>
      <td>2</td>
      <td>8.289115</td>
      <td>-173.338698</td>
      <td>-77.625020</td>
    </tr>
    <tr>
      <th>72</th>
      <td>-120000.0</td>
      <td>-1370000.0</td>
      <td>19363.0</td>
      <td>0</td>
      <td>21.214836</td>
      <td>-174.994167</td>
      <td>-77.661652</td>
    </tr>
    <tr>
      <th>73</th>
      <td>-120000.0</td>
      <td>-1370000.0</td>
      <td>19363.0</td>
      <td>1</td>
      <td>17.804343</td>
      <td>-174.994167</td>
      <td>-77.661652</td>
    </tr>
    <tr>
      <th>74</th>
      <td>-120000.0</td>
      <td>-1370000.0</td>
      <td>19363.0</td>
      <td>2</td>
      <td>7.811067</td>
      <td>-174.994167</td>
      <td>-77.661652</td>
    </tr>
  </tbody>
</table>
<p>75 rows × 7 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f85b9f78-928d-41a3-a048-b442b3b18a6d')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f85b9f78-928d-41a3-a048-b442b3b18a6d button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f85b9f78-928d-41a3-a048-b442b3b18a6d');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-ed4c5586-4de5-48e7-a00b-cbbc6dc1d223">
  <button class="colab-df-quickchart" onclick="quickchart('df-ed4c5586-4de5-48e7-a00b-cbbc6dc1d223')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-ed4c5586-4de5-48e7-a00b-cbbc6dc1d223 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;preds&quot;</span><span class="p">]</span>
<span class="n">preds_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="c1"># multiple local experts may make predictions at the same prediction location (pred_loc).</span>
<span class="c1"># - for each prediction at a given location, take we weighted combination</span>
<span class="c1"># - weights being a function of the distance to each local expert that made a prediction at a given location.</span>

<span class="n">plt_data</span> <span class="o">=</span> <span class="n">glue_local_predictions_2d</span><span class="p">(</span><span class="n">preds_df</span><span class="o">=</span><span class="n">preds_data</span><span class="p">,</span>
                                     <span class="n">pred_loc_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pred_loc_x&quot;</span><span class="p">,</span> <span class="s2">&quot;pred_loc_y&quot;</span><span class="p">],</span>
                                     <span class="n">xprt_loc_cols</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">],</span>
                                     <span class="n">vars_to_glue</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f*&quot;</span><span class="p">,</span> <span class="s2">&quot;f*_var&quot;</span><span class="p">],</span>
                                     <span class="n">inference_radius</span><span class="o">=</span><span class="n">inference_radius</span><span class="p">)</span>

<span class="n">plt_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9fbf96b1-54a4-46a6-beae-2c025c229536" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred_loc_x</th>
      <th>pred_loc_y</th>
      <th>f*</th>
      <th>f*_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-297500.0</td>
      <td>-1547500.0</td>
      <td>0.082482</td>
      <td>0.005691</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-297500.0</td>
      <td>-1542500.0</td>
      <td>0.081341</td>
      <td>0.005828</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-297500.0</td>
      <td>-1537500.0</td>
      <td>0.079630</td>
      <td>0.005984</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-297500.0</td>
      <td>-1532500.0</td>
      <td>0.077376</td>
      <td>0.006161</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-297500.0</td>
      <td>-1527500.0</td>
      <td>0.074534</td>
      <td>0.006374</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9fbf96b1-54a4-46a6-beae-2c025c229536')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9fbf96b1-54a4-46a6-beae-2c025c229536 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9fbf96b1-54a4-46a6-beae-2c025c229536');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3722bb39-e6a5-45a0-baaf-55b96afa4fbb">
  <button class="colab-df-quickchart" onclick="quickchart('df-3722bb39-e6a5-45a0-baaf-55b96afa4fbb')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3722bb39-e6a5-45a0-baaf-55b96afa4fbb button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#inference 50 radius 100 loc 20km</span>
<span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span><span class="n">y_Eddy</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">))</span>
    <span class="c1">#ax.scatter(eloc[&#39;lon&#39;],eloc[&#39;lat&#39;],s=1,color=&#39;r&#39;,transform=ccrs.PlateCarree())</span>
    <span class="c1">#ax.scatter(ploc[&#39;lon&#39;],ploc[&#39;lat&#39;],s=1,color=&#39;b&#39;,transform=ccrs.PlateCarree())</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-83-9edd7b7919e0&gt;:2: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  eddylon,eddylat = EASE2toWGS84_New(x_Eddy,y_Eddy,lat_0=-90)
&lt;ipython-input-83-9edd7b7919e0&gt;:3: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  eloc[&#39;lon&#39;],eloc[&#39;lat&#39;] = EASE2toWGS84_New(eloc[&#39;x&#39;],eloc[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-83-9edd7b7919e0&gt;:4: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  ploc[&#39;lon&#39;],ploc[&#39;lat&#39;] = EASE2toWGS84_New(ploc[&#39;x&#39;],ploc[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-83-9edd7b7919e0&gt;:5: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  df[&#39;lon&#39;],df[&#39;lat&#39;] = EASE2toWGS84_New(df[&#39;x&#39;],df[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-83-9edd7b7919e0&gt;:6: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  plt_data[&#39;lon&#39;],plt_data[&#39;lat&#39;] = EASE2toWGS84_New(plt_data[&#39;pred_loc_x&#39;],plt_data[&#39;pred_loc_y&#39;],lat_0=-90)
</pre></div>
</div>
<img alt="_images/2740d621e484c6a94a69c09f9d386ff97dbc9d2ca889b00ac130acae5b4b5d7b.png" src="_images/2740d621e484c6a94a69c09f9d386ff97dbc9d2ca889b00ac130acae5b4b5d7b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#inference 100 radius 300 loc 40km</span>
<span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span><span class="n">y_Eddy</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">))</span>
    <span class="c1">#ax.scatter(eloc[&#39;lon&#39;],eloc[&#39;lat&#39;],s=1,color=&#39;r&#39;,transform=ccrs.PlateCarree())</span>
    <span class="c1">#ax.scatter(ploc[&#39;lon&#39;],ploc[&#39;lat&#39;],s=1,color=&#39;b&#39;,transform=ccrs.PlateCarree())</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ipython-input-47-265660360240&gt;:1: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  eddylon,eddylat = EASE2toWGS84_New(x_Eddy,y_Eddy,lat_0=-90)
&lt;ipython-input-47-265660360240&gt;:2: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  eloc[&#39;lon&#39;],eloc[&#39;lat&#39;] = EASE2toWGS84_New(eloc[&#39;x&#39;],eloc[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-47-265660360240&gt;:3: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  ploc[&#39;lon&#39;],ploc[&#39;lat&#39;] = EASE2toWGS84_New(ploc[&#39;x&#39;],ploc[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-47-265660360240&gt;:4: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  df[&#39;lon&#39;],df[&#39;lat&#39;] = EASE2toWGS84_New(df[&#39;x&#39;],df[&#39;y&#39;],lat_0=-90)
&lt;ipython-input-47-265660360240&gt;:5: DeprecationWarning: Call to deprecated function (or staticmethod) EASE2toWGS84_New. (This function will be removed in future versions. Use `EASE2toWGS84` instead.)
  plt_data[&#39;lon&#39;],plt_data[&#39;lat&#39;] = EASE2toWGS84_New(plt_data[&#39;pred_loc_x&#39;],plt_data[&#39;pred_loc_y&#39;],lat_0=-90)
</pre></div>
</div>
<img alt="_images/e4c647cc35aa6d62b4b512b4b0e0ed582f97c84689ca7c34d43879524440922b.png" src="_images/e4c647cc35aa6d62b4b512b4b0e0ed582f97c84689ca7c34d43879524440922b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">x_Eddy</span><span class="p">,</span><span class="n">y_Eddy</span><span class="p">,</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">eloc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">ploc</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>
<span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">EASE2toWGS84_New</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">],</span><span class="n">lat_0</span><span class="o">=-</span><span class="mi">90</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">140</span><span class="p">,</span> <span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="o">-</span><span class="mi">67</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="mf">0.8</span><span class="p">))</span>
    <span class="c1">#ax.scatter(eloc[&#39;lon&#39;],eloc[&#39;lat&#39;],s=1,color=&#39;r&#39;,transform=ccrs.PlateCarree())</span>
    <span class="c1">#ax.scatter(ploc[&#39;lon&#39;],ploc[&#39;lat&#39;],s=1,color=&#39;b&#39;,transform=ccrs.PlateCarree())</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">eddylon</span><span class="p">,</span><span class="n">eddylat</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">wspace</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d8bdc3a552483614753bc1b528f4c23543de8284a18d43599f47bea55bc4f6cd.png" src="_images/d8bdc3a552483614753bc1b528f4c23543de8284a18d43599f47bea55bc4f6cd.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1600, 4)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">y_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">z_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="s1">&#39;C&#39;</span><span class="p">)</span>
<span class="n">v_grid</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">plt_data</span><span class="p">[</span><span class="s1">&#39;f*_var&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#inference 50 radius 100 loc 20km</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span><span class="n">y_grid</span><span class="p">,</span><span class="n">z_grid</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7fa28498f970&gt;
</pre></div>
</div>
<img alt="_images/385a752a89f093f0ba34c9dd8454ce38474195c71e0e41676c90236efdb0eab0.png" src="_images/385a752a89f093f0ba34c9dd8454ce38474195c71e0e41676c90236efdb0eab0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#inference 100 radius 300 loc 40km</span>
<span class="n">plt</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span><span class="n">y_grid</span><span class="p">,</span><span class="n">z_grid</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x7fa4d154ef50&gt;
</pre></div>
</div>
<img alt="_images/d9eead25a48604f8888a828c802a0285cb702e0048fbb674a2042965cabb55c1.png" src="_images/d9eead25a48604f8888a828c802a0285cb702e0048fbb674a2042965cabb55c1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;obs&#39;</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># &#39;obs&#39; as both color and size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">300000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100000.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1550000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1350000.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>  <span class="c1"># Add colorbar to show the mapping of &#39;obs&#39; values to colors</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/80b5e5669363aa03168d7ba040ae578e8f9a0fe5f7e2a8187469f18ee2e3057a.png" src="_images/80b5e5669363aa03168d7ba040ae578e8f9a0fe5f7e2a8187469f18ee2e3057a.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">all_data_df</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">19358.786713</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span><span class="c1">#, vmin=0, vmax=0.2)  # &#39;obs&#39; as both color and size</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">((</span><span class="o">-</span><span class="mf">300000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">100000.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mf">1550000.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1350000.0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>  <span class="c1"># Add colorbar to show the mapping of &#39;obs&#39; values to colors</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3974fbb6d6d677a1484cefe7a95bbf3ea605c73c072cbf08617f9ad1d551b623.png" src="_images/3974fbb6d6d677a1484cefe7a95bbf3ea605c73c072cbf08617f9ad1d551b623.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter_2_Intro_to_GPSat.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction to GPSat</p>
      </div>
    </a>
    <a class="right-next"
       href="Chapter_2_GPSat_along_track-2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Along track interpolation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fetching-data">Fetching data</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-product-selection">Step 1: Product Selection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-defining-the-region-of-interest">Step 2: Defining the Region of Interest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-initiating-the-search">Step 3: Initiating the Search</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sla-interpolation">SLA Interpolation</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michel Tsamados/Weibin Chen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>