

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Along track interpolation &#8212; GEOL0069 Guide Book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Chapter_2_GPSat_along_track-2';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Explainable AI" href="ExplainableAI.html" />
    <link rel="prev" title="Interpolation of Sea Level Anomaly using GPSat" href="Chapter_2_SLA_GPSat_William.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to GEOL0069 AI for Earth Observation
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3APreparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AIRIS.html">Introduction to Intelligently Reinforced Image Segmentation (IRIS)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 2</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AML.html">Introduction to AI/Machine Learning</a></li>

<li class="toctree-l1"><a class="reference internal" href="Chapter_1_Sea_ice_and_Lead_Classification.html">Sea-ice and Lead Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_1_AI_Algorithms.html">AI/Machine Learning Implementation</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 3</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter%201%3AFetching_Data.html">Data Fetching</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_1_rollout_3.html">Roll-out on a Full Image</a></li>





</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 4</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Data_Colocating_S2_S3_3.html">Colocating Sentinel-3 OLCI/SRAL and Sentinal-2 Optical Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Unsupervised_Learning_Methods_2.html">Unsupervised Learning</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 5</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Regression.html">Regression Techniques for Predictive Analysis</a></li>

<li class="toctree-l1"><a class="reference internal" href="Creating_training_data_fromS3_S2-2.html">Creating Training Data from Sentinel-2 and Sentinel-3 OLCI Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1_Regression_Part2_2425.html">Application of Regression Techniques in Satellite Imagery Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 6</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3AColocating_data.html">Colocate Sentinel-2 and Sentinel-3 Imagery</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter1%3ARegression_Part2.html">Application of Regression Techniques in Satellite Imagery Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="References1.html">References</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 7</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter2_IntrotoGaussianProcesses.html">Introduction to Gaussian Processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chapter_2_Intro_to_GPSat.html">Introduction to GPSat</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 8</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Chapter_2_SLA_GPSat_William.html">Interpolation of Sea Level Anomaly using GPSat</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Along track interpolation</a></li>




</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Week 9</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="ExplainableAI.html">Explainable AI</a></li>
<li class="toctree-l1"><a class="reference internal" href="ExplainableAI_Part2.html">Explainable AI Part 2</a></li>


</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter_2_GPSat_along_track-2.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Chapter_2_GPSat_along_track-2.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Along track interpolation</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Along track interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-profile-for-interpolation">Select profile for interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-expert-locations-at-200-km">Generate expert locations at 200 km</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-along-track">Interpolate along-track</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="along-track-interpolation">
<h1>Along track interpolation<a class="headerlink" href="#along-track-interpolation" title="Permalink to this heading">#</a></h1>
<p>! pip install cartopy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">google.colab</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">except</span><span class="p">:</span>
    <span class="n">IN_COLAB</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># TODO: allow for mounting of gdrive</span>
<span class="c1"># TODO: allow for checking out a branch</span>

<span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">os</span>
    <span class="kn">import</span> <span class="nn">re</span>

    <span class="c1"># change to working directory</span>
    <span class="n">work_dir</span> <span class="o">=</span> <span class="s2">&quot;/content&quot;</span>

    <span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">work_dir</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;workspace directory: </span><span class="si">{</span><span class="n">work_dir</span><span class="si">}</span><span class="s2"> does not exist&quot;</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">work_dir</span><span class="p">)</span>

    <span class="c1"># clone repository</span>
    <span class="o">!</span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/CPOMUCL/GPSat.git

    <span class="n">repo_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">work_dir</span><span class="p">,</span> <span class="s2">&quot;GPSat&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;changing directory to: </span><span class="si">{</span><span class="n">repo_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">repo_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cloning into &#39;GPSat&#39;...
remote: Enumerating objects: 2667, done.
remote: Counting objects: 100% (329/329), done.
remote: Compressing objects: 100% (115/115), done.
remote: Total 2667 (delta 212), reused 320 (delta 210), pack-reused 2338
Receiving objects: 100% (2667/2667), 56.65 MiB | 21.18 MiB/s, done.
Resolving deltas: 100% (1824/1824), done.
Updating files: 100% (125/125), done.
changing directory to: /content/GPSat
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements.txt
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ignoring gpflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Ignoring tensorflow: markers &#39;platform_system == &quot;Windows&quot;&#39; don&#39;t match your environment
Ignoring tensorflow: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;x86_64&quot;&#39; don&#39;t match your environment
Ignoring tensorflow-macos: markers &#39;platform_system == &quot;Darwin&quot; and platform_machine == &quot;arm64&quot;&#39; don&#39;t match your environment
Collecting setuptools&gt;=68.2.2 (from -r requirements.txt (line 1))
  Downloading setuptools-69.1.1-py3-none-any.whl (819 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">819.3/819.3 kB</span> <span class=" -Color -Color-Red">11.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: astropy&gt;=5.1.1 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 2)) (5.3.4)
Requirement already satisfied: chardet&gt;=4.0.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 3)) (5.2.0)
Requirement already satisfied: pandas==1.5.3 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 4)) (1.5.3)
Collecting gpflow&gt;=2.9.0 (from -r requirements.txt (line 10))
  Downloading gpflow-2.9.1-py3-none-any.whl (380 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">380.6/380.6 kB</span> <span class=" -Color -Color-Red">16.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: tensorflow[and-cuda]&gt;=2.14.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 12)) (2.15.0)
Collecting gpytorch==1.10 (from -r requirements.txt (line 19))
  Downloading gpytorch-1.10-py3-none-any.whl (255 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">255.2/255.2 kB</span> <span class=" -Color -Color-Red">16.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: matplotlib&gt;=3.6.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 20)) (3.7.1)
Requirement already satisfied: scipy&gt;=1.9.3 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 21)) (1.11.4)
Requirement already satisfied: tables&gt;=3.7.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 22)) (3.8.0)
Collecting netCDF4==1.6.2 (from -r requirements.txt (line 23))
  Downloading netCDF4-1.6.2-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (5.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">5.1/5.1 MB</span> <span class=" -Color -Color-Red">29.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: xarray&gt;=2022.10.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 24)) (2023.7.0)
Requirement already satisfied: gast&gt;=0.4.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 25)) (0.5.4)
Requirement already satisfied: pyproj&gt;=3.4.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 26)) (3.6.1)
Requirement already satisfied: seaborn&gt;=0.11.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 27)) (0.13.1)
Collecting jupyter==1.0.0 (from -r requirements.txt (line 28))
  Downloading jupyter-1.0.0-py2.py3-none-any.whl (2.7 kB)
Requirement already satisfied: scikit-learn==1.2.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 29)) (1.2.2)
Requirement already satisfied: numba&gt;=0.56.4 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 30)) (0.58.1)
Collecting numpy&lt;=1.23.5 (from -r requirements.txt (line 31))
  Downloading numpy-1.23.5-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (17.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">17.1/17.1 MB</span> <span class=" -Color -Color-Red">34.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: pytest&gt;=7.2.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 32)) (7.4.4)
Collecting dataclasses-json==0.5.7 (from -r requirements.txt (line 33))
  Downloading dataclasses_json-0.5.7-py3-none-any.whl (25 kB)
Collecting global-land-mask==1.0.0 (from -r requirements.txt (line 34))
  Downloading global_land_mask-1.0.0-py3-none-any.whl (1.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.8/1.8 MB</span> <span class=" -Color -Color-Red">56.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: cartopy==0.22.0 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 35)) (0.22.0)
Requirement already satisfied: Sphinx&gt;=5.0.2 in /usr/local/lib/python3.10/dist-packages (from -r requirements.txt (line 38)) (5.0.2)
Collecting nbsphinx&gt;=0.9.3 (from -r requirements.txt (line 39))
  Downloading nbsphinx-0.9.3-py3-none-any.whl (31 kB)
Collecting numpydoc&gt;=1.6.0 (from -r requirements.txt (line 40))
  Downloading numpydoc-1.6.0-py3-none-any.whl (61 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">61.7/61.7 kB</span> <span class=" -Color -Color-Red">8.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting sphinxemoji&gt;=0.2.0 (from -r requirements.txt (line 41))
  Downloading sphinxemoji-0.3.1-py3-none-any.whl (46 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">46.1/46.1 kB</span> <span class=" -Color -Color-Red">5.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting sphinx-rtd-theme&gt;=1.3.0 (from -r requirements.txt (line 42))
  Downloading sphinx_rtd_theme-2.0.0-py2.py3-none-any.whl (2.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">2.8/2.8 MB</span> <span class=" -Color -Color-Red">41.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: python-dateutil&gt;=2.8.1 in /usr/local/lib/python3.10/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 4)) (2.8.2)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas==1.5.3-&gt;-r requirements.txt (line 4)) (2023.4)
Collecting linear-operator&gt;=0.4.0 (from gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading linear_operator-0.5.2-py3-none-any.whl (175 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">175.6/175.6 kB</span> <span class=" -Color -Color-Red">20.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting cftime (from netCDF4==1.6.2-&gt;-r requirements.txt (line 23))
  Downloading cftime-1.6.3-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.3/1.3 MB</span> <span class=" -Color -Color-Red">61.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: notebook in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.5.5)
Collecting qtconsole (from jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading qtconsole-5.5.1-py3-none-any.whl (123 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">123.4/123.4 kB</span> <span class=" -Color -Color-Red">17.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: jupyter-console in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.0)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.5.4)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (5.5.6)
Requirement already satisfied: ipywidgets in /usr/local/lib/python3.10/dist-packages (from jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (7.7.1)
Requirement already satisfied: joblib&gt;=1.1.1 in /usr/local/lib/python3.10/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 29)) (1.3.2)
Requirement already satisfied: threadpoolctl&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from scikit-learn==1.2.2-&gt;-r requirements.txt (line 29)) (3.3.0)
Collecting marshmallow&lt;4.0.0,&gt;=3.3.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading marshmallow-3.21.1-py3-none-any.whl (49 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">49.4/49.4 kB</span> <span class=" -Color -Color-Red">6.3 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting marshmallow-enum&lt;2.0.0,&gt;=1.5.1 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading marshmallow_enum-1.5.1-py2.py3-none-any.whl (4.2 kB)
Collecting typing-inspect&gt;=0.4.0 (from dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading typing_inspect-0.9.0-py3-none-any.whl (8.8 kB)
Requirement already satisfied: shapely&gt;=1.7 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (2.0.3)
Requirement already satisfied: packaging&gt;=20 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (23.2)
Requirement already satisfied: pyshp&gt;=2.1 in /usr/local/lib/python3.10/dist-packages (from cartopy==0.22.0-&gt;-r requirements.txt (line 35)) (2.3.1)
Requirement already satisfied: pyerfa&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 2)) (2.0.1.1)
Requirement already satisfied: PyYAML&gt;=3.13 in /usr/local/lib/python3.10/dist-packages (from astropy&gt;=5.1.1-&gt;-r requirements.txt (line 2)) (6.0.1)
Collecting check-shapes&gt;=1.0.0 (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading check_shapes-1.1.1-py3-none-any.whl (45 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">45.8/45.8 kB</span> <span class=" -Color -Color-Red">5.8 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting deprecated (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading Deprecated-1.2.14-py2.py3-none-any.whl (9.6 kB)
Requirement already satisfied: multipledispatch&gt;=0.6 in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (1.0.0)
Requirement already satisfied: tabulate in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.9.0)
Requirement already satisfied: tensorflow-probability&gt;=0.12.0 in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.23.0)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.10/dist-packages (from gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (4.10.0)
Requirement already satisfied: absl-py&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.4.0)
Requirement already satisfied: astunparse&gt;=1.6.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.6.3)
Requirement already satisfied: flatbuffers&gt;=23.5.26 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (23.5.26)
Requirement already satisfied: google-pasta&gt;=0.1.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.2.0)
Requirement already satisfied: h5py&gt;=2.9.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.9.0)
Requirement already satisfied: libclang&gt;=13.0.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (16.0.6)
Requirement already satisfied: ml-dtypes~=0.2.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.2.0)
Requirement already satisfied: opt-einsum&gt;=2.3.2 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.3.0)
Requirement already satisfied: protobuf!=4.21.0,!=4.21.1,!=4.21.2,!=4.21.3,!=4.21.4,!=4.21.5,&lt;5.0.0dev,&gt;=3.20.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.20.3)
Requirement already satisfied: six&gt;=1.12.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.16.0)
Requirement already satisfied: termcolor&gt;=1.1.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.4.0)
Requirement already satisfied: wrapt&lt;1.15,&gt;=1.11.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.14.1)
Requirement already satisfied: tensorflow-io-gcs-filesystem&gt;=0.23.1 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.36.0)
Requirement already satisfied: grpcio&lt;2.0,&gt;=1.24.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.62.0)
Requirement already satisfied: tensorboard&lt;2.16,&gt;=2.15 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.2)
Requirement already satisfied: tensorflow-estimator&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.0)
Requirement already satisfied: keras&lt;2.16,&gt;=2.15.0 in /usr/local/lib/python3.10/dist-packages (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.15.0)
Collecting nvidia-cublas-cu12==12.2.5.6 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cublas_cu12-12.2.5.6-py3-none-manylinux1_x86_64.whl (417.8 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">417.8/417.8 MB</span> <span class=" -Color -Color-Red">2.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-cupti-cu12==12.2.142 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_cupti_cu12-12.2.142-py3-none-manylinux1_x86_64.whl (13.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">13.9/13.9 MB</span> <span class=" -Color -Color-Red">88.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-nvcc-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_nvcc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (21.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">21.3/21.3 MB</span> <span class=" -Color -Color-Red">76.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-nvrtc-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_nvrtc_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (23.4 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">23.4/23.4 MB</span> <span class=" -Color -Color-Red">72.9 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cuda-runtime-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cuda_runtime_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (845 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">845.8/845.8 kB</span> <span class=" -Color -Color-Red">71.5 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cudnn-cu12==8.9.4.25 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cudnn_cu12-8.9.4.25-py3-none-manylinux1_x86_64.whl (720.1 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">720.1/720.1 MB</span> <span class=" -Color -Color-Red">2.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cufft-cu12==11.0.8.103 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cufft_cu12-11.0.8.103-py3-none-manylinux1_x86_64.whl (98.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">98.6/98.6 MB</span> <span class=" -Color -Color-Red">9.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-curand-cu12==10.3.3.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_curand_cu12-10.3.3.141-py3-none-manylinux1_x86_64.whl (56.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">56.5/56.5 MB</span> <span class=" -Color -Color-Red">10.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cusolver-cu12==11.5.2.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cusolver_cu12-11.5.2.141-py3-none-manylinux1_x86_64.whl (124.9 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">124.9/124.9 MB</span> <span class=" -Color -Color-Red">8.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-cusparse-cu12==12.1.2.141 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_cusparse_cu12-12.1.2.141-py3-none-manylinux1_x86_64.whl (195.3 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">195.3/195.3 MB</span> <span class=" -Color -Color-Red">6.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-nccl-cu12==2.16.5 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_nccl_cu12-2.16.5-py3-none-manylinux1_x86_64.whl (188.7 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">188.7/188.7 MB</span> <span class=" -Color -Color-Red">6.6 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting nvidia-nvjitlink-cu12==12.2.140 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading nvidia_nvjitlink_cu12-12.2.140-py3-none-manylinux1_x86_64.whl (20.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">20.2/20.2 MB</span> <span class=" -Color -Color-Red">84.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting tensorrt==8.6.1.post1 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading tensorrt-8.6.1.post1.tar.gz (18 kB)
  Preparing metadata (setup.py) ... ?25l?25hdone
Collecting tensorrt-bindings==8.6.1 (from tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12))
  Downloading tensorrt_bindings-8.6.1-cp310-none-manylinux_2_17_x86_64.whl (979 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">979.4/979.4 kB</span> <span class=" -Color -Color-Red">65.1 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hINFO: pip is looking at multiple versions of tensorflow[and-cuda] to determine which version is compatible with other requirements. This could take a while.
Collecting tensorflow[and-cuda]&gt;=2.14.0 (from -r requirements.txt (line 12))
  Downloading tensorflow-2.15.0.post1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (475.2 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">475.2/475.2 MB</span> <span class=" -Color -Color-Red">3.4 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (1.2.0)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (4.49.0)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (1.4.5)
Requirement already satisfied: pillow&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (9.4.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&gt;=3.6.2-&gt;-r requirements.txt (line 20)) (3.1.1)
Requirement already satisfied: cython&gt;=0.29.21 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (3.0.9)
Requirement already satisfied: numexpr&gt;=2.6.2 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (2.9.0)
Requirement already satisfied: blosc2~=2.0.0 in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (2.0.0)
Requirement already satisfied: py-cpuinfo in /usr/local/lib/python3.10/dist-packages (from tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (9.0.0)
Requirement already satisfied: certifi in /usr/local/lib/python3.10/dist-packages (from pyproj&gt;=3.4.0-&gt;-r requirements.txt (line 26)) (2024.2.2)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&gt;=0.56.4-&gt;-r requirements.txt (line 30)) (0.41.1)
Requirement already satisfied: iniconfig in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (2.0.0)
Requirement already satisfied: pluggy&lt;2.0,&gt;=0.12 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (1.4.0)
Requirement already satisfied: exceptiongroup&gt;=1.0.0rc8 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (1.2.0)
Requirement already satisfied: tomli&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from pytest&gt;=7.2.0-&gt;-r requirements.txt (line 32)) (2.0.1)
Requirement already satisfied: sphinxcontrib-applehelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.8)
Requirement already satisfied: sphinxcontrib-devhelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.6)
Requirement already satisfied: sphinxcontrib-jsmath in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.1)
Requirement already satisfied: sphinxcontrib-htmlhelp&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.0.5)
Requirement already satisfied: sphinxcontrib-serializinghtml&gt;=1.1.5 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.1.10)
Requirement already satisfied: sphinxcontrib-qthelp in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.0.7)
Requirement already satisfied: Jinja2&gt;=2.3 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.1.3)
Requirement already satisfied: Pygments&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.16.1)
Requirement already satisfied: docutils&lt;0.19,&gt;=0.14 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (0.18.1)
Requirement already satisfied: snowballstemmer&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.2.0)
Requirement already satisfied: babel&gt;=1.3 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.14.0)
Requirement already satisfied: alabaster&lt;0.8,&gt;=0.7 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (0.7.16)
Requirement already satisfied: imagesize in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (1.4.1)
Requirement already satisfied: requests&gt;=2.5.0 in /usr/local/lib/python3.10/dist-packages (from Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.31.0)
Requirement already satisfied: traitlets&gt;=5 in /usr/local/lib/python3.10/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (5.7.1)
Requirement already satisfied: nbformat in /usr/local/lib/python3.10/dist-packages (from nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (5.9.2)
Collecting sphinxcontrib-jquery&lt;5,&gt;=4 (from sphinx-rtd-theme&gt;=1.3.0-&gt;-r requirements.txt (line 42))
  Downloading sphinxcontrib_jquery-4.1-py2.py3-none-any.whl (121 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">121.1/121.1 kB</span> <span class=" -Color -Color-Red">15.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: wheel&lt;1.0,&gt;=0.23.0 in /usr/local/lib/python3.10/dist-packages (from astunparse&gt;=1.6.0-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.42.0)
Requirement already satisfied: msgpack in /usr/local/lib/python3.10/dist-packages (from blosc2~=2.0.0-&gt;tables&gt;=3.7.0-&gt;-r requirements.txt (line 22)) (1.0.8)
Collecting dropstackframe&gt;=0.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading dropstackframe-0.1.0-py3-none-any.whl (4.5 kB)
Collecting lark&lt;2.0.0,&gt;=1.1.0 (from check-shapes&gt;=1.0.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10))
  Downloading lark-1.1.9-py3-none-any.whl (111 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">111.7/111.7 kB</span> <span class=" -Color -Color-Red">15.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from Jinja2&gt;=2.3-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.1.5)
Requirement already satisfied: torch&gt;=1.11 in /usr/local/lib/python3.10/dist-packages (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2.1.0+cu121)
Collecting jaxtyping&gt;=0.2.9 (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading jaxtyping-0.2.28-py3-none-any.whl (40 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">40.7/40.7 kB</span> <span class=" -Color -Color-Red">5.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hCollecting typeguard~=2.13.3 (from linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19))
  Downloading typeguard-2.13.3-py3-none-any.whl (17 kB)
Requirement already satisfied: lxml in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.9.4)
Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.12.3)
Requirement already satisfied: bleach in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.1)
Requirement already satisfied: entrypoints&gt;=0.2.2 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.4)
Requirement already satisfied: jupyter-core&gt;=4.7 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (5.7.1)
Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.3.0)
Requirement already satisfied: mistune&lt;2,&gt;=0.8.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.8.4)
Requirement already satisfied: nbclient&gt;=0.5.0 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.9.0)
Requirement already satisfied: pandocfilters&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.5.1)
Requirement already satisfied: tinycss2 in /usr/local/lib/python3.10/dist-packages (from nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.2.1)
Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.10/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (2.19.1)
Requirement already satisfied: jsonschema&gt;=2.6 in /usr/local/lib/python3.10/dist-packages (from nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (4.19.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (3.6)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&gt;=2.5.0-&gt;Sphinx&gt;=5.0.2-&gt;-r requirements.txt (line 38)) (2.0.7)
Requirement already satisfied: google-auth&lt;3,&gt;=1.6.3 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (2.27.0)
Requirement already satisfied: google-auth-oauthlib&lt;2,&gt;=0.5 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.2.0)
Requirement already satisfied: markdown&gt;=2.6.8 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.5.2)
Requirement already satisfied: tensorboard-data-server&lt;0.8.0,&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.7.2)
Requirement already satisfied: werkzeug&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.0.1)
Requirement already satisfied: decorator in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (4.4.2)
Requirement already satisfied: cloudpickle&gt;=1.3 in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (2.2.1)
Requirement already satisfied: dm-tree in /usr/local/lib/python3.10/dist-packages (from tensorflow-probability&gt;=0.12.0-&gt;gpflow&gt;=2.9.0-&gt;-r requirements.txt (line 10)) (0.1.8)
Collecting mypy-extensions&gt;=0.3.0 (from typing-inspect&gt;=0.4.0-&gt;dataclasses-json==0.5.7-&gt;-r requirements.txt (line 33))
  Downloading mypy_extensions-1.0.0-py3-none-any.whl (4.7 kB)
Requirement already satisfied: ipython-genutils in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.0)
Requirement already satisfied: ipython&gt;=5.0.0 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (7.34.0)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.1.12)
Requirement already satisfied: tornado&gt;=4.2 in /usr/local/lib/python3.10/dist-packages (from ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (6.3.3)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.6.6)
Requirement already satisfied: jupyterlab-widgets&gt;=1.0.0 in /usr/local/lib/python3.10/dist-packages (from ipywidgets-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.0.10)
Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.0.43)
Requirement already satisfied: pyzmq&lt;25,&gt;=17 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (23.2.1)
Requirement already satisfied: argon2-cffi in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (23.1.0)
Requirement already satisfied: nest-asyncio&gt;=1.5 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.6.0)
Requirement already satisfied: Send2Trash&gt;=1.8.0 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.8.2)
Requirement already satisfied: terminado&gt;=0.8.3 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.18.0)
Requirement already satisfied: prometheus-client in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.20.0)
Requirement already satisfied: nbclassic&gt;=0.4.7 in /usr/local/lib/python3.10/dist-packages (from notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.0.0)
Collecting qtpy&gt;=2.4.0 (from qtconsole-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading QtPy-2.4.1-py3-none-any.whl (93 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">93.5/93.5 kB</span> <span class=" -Color -Color-Red">13.2 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: cachetools&lt;6.0,&gt;=2.0.0 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (5.3.3)
Requirement already satisfied: pyasn1-modules&gt;=0.2.1 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.3.0)
Requirement already satisfied: rsa&lt;5,&gt;=3.1.4 in /usr/local/lib/python3.10/dist-packages (from google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (4.9)
Requirement already satisfied: requests-oauthlib&gt;=0.7.0 in /usr/local/lib/python3.10/dist-packages (from google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (1.3.1)
Collecting jedi&gt;=0.16 (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28))
  Downloading jedi-0.19.1-py2.py3-none-any.whl (1.6 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">1.6/1.6 MB</span> <span class=" -Color -Color-Red">85.0 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25hRequirement already satisfied: pickleshare in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.5)
Requirement already satisfied: backcall in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.0)
Requirement already satisfied: matplotlib-inline in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.1.6)
Requirement already satisfied: pexpect&gt;4.3 in /usr/local/lib/python3.10/dist-packages (from ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.9.0)
Requirement already satisfied: attrs&gt;=22.2.0 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (23.2.0)
Requirement already satisfied: jsonschema-specifications&gt;=2023.03.6 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (2023.12.1)
Requirement already satisfied: referencing&gt;=0.28.4 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (0.33.0)
Requirement already satisfied: rpds-py&gt;=0.7.1 in /usr/local/lib/python3.10/dist-packages (from jsonschema&gt;=2.6-&gt;nbformat-&gt;nbsphinx&gt;=0.9.3-&gt;-r requirements.txt (line 39)) (0.18.0)
Requirement already satisfied: platformdirs&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from jupyter-core&gt;=4.7-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (4.2.0)
Requirement already satisfied: jupyter-server&gt;=1.8 in /usr/local/lib/python3.10/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.24.0)
Requirement already satisfied: notebook-shim&gt;=0.2.3 in /usr/local/lib/python3.10/dist-packages (from nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.4)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.10/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,&lt;3.1.0,&gt;=2.0.0-&gt;jupyter-console-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.2.13)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.10/dist-packages (from terminado&gt;=0.8.3-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.7.0)
Requirement already satisfied: filelock in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (3.13.1)
Requirement already satisfied: sympy in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (1.12)
Requirement already satisfied: networkx in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (3.2.1)
Requirement already satisfied: fsspec in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2023.6.0)
Requirement already satisfied: triton==2.1.0 in /usr/local/lib/python3.10/dist-packages (from torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (2.1.0)
Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (21.2.0)
Requirement already satisfied: soupsieve&gt;1.2 in /usr/local/lib/python3.10/dist-packages (from beautifulsoup4-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (2.5)
Requirement already satisfied: webencodings in /usr/local/lib/python3.10/dist-packages (from bleach-&gt;nbconvert-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.5.1)
Requirement already satisfied: parso&lt;0.9.0,&gt;=0.8.3 in /usr/local/lib/python3.10/dist-packages (from jedi&gt;=0.16-&gt;ipython&gt;=5.0.0-&gt;ipykernel-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (0.8.3)
Requirement already satisfied: anyio&lt;4,&gt;=3.1.0 in /usr/local/lib/python3.10/dist-packages (from jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (3.7.1)
Requirement already satisfied: websocket-client in /usr/local/lib/python3.10/dist-packages (from jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.7.0)
Requirement already satisfied: pyasn1&lt;0.6.0,&gt;=0.4.6 in /usr/local/lib/python3.10/dist-packages (from pyasn1-modules&gt;=0.2.1-&gt;google-auth&lt;3,&gt;=1.6.3-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (0.5.1)
Requirement already satisfied: oauthlib&gt;=3.0.0 in /usr/local/lib/python3.10/dist-packages (from requests-oauthlib&gt;=0.7.0-&gt;google-auth-oauthlib&lt;2,&gt;=0.5-&gt;tensorboard&lt;2.16,&gt;=2.15-&gt;tensorflow[and-cuda]&gt;=2.14.0-&gt;-r requirements.txt (line 12)) (3.2.2)
Requirement already satisfied: cffi&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.16.0)
Requirement already satisfied: mpmath&gt;=0.19 in /usr/local/lib/python3.10/dist-packages (from sympy-&gt;torch&gt;=1.11-&gt;linear-operator&gt;=0.4.0-&gt;gpytorch==1.10-&gt;-r requirements.txt (line 19)) (1.3.0)
Requirement already satisfied: sniffio&gt;=1.1 in /usr/local/lib/python3.10/dist-packages (from anyio&lt;4,&gt;=3.1.0-&gt;jupyter-server&gt;=1.8-&gt;nbclassic&gt;=0.4.7-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (1.3.1)
Requirement already satisfied: pycparser in /usr/local/lib/python3.10/dist-packages (from cffi&gt;=1.0.1-&gt;argon2-cffi-bindings-&gt;argon2-cffi-&gt;notebook-&gt;jupyter==1.0.0-&gt;-r requirements.txt (line 28)) (2.21)
Installing collected packages: global-land-mask, typeguard, setuptools, qtpy, nvidia-nvjitlink-cu12, nvidia-nccl-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cuda-runtime-cu12, nvidia-cuda-nvrtc-cu12, nvidia-cuda-nvcc-cu12, nvidia-cuda-cupti-cu12, nvidia-cublas-cu12, numpy, mypy-extensions, marshmallow, lark, jedi, dropstackframe, deprecated, typing-inspect, nvidia-cusparse-cu12, nvidia-cudnn-cu12, marshmallow-enum, jaxtyping, check-shapes, cftime, sphinxemoji, sphinxcontrib-jquery, nvidia-cusolver-cu12, numpydoc, netCDF4, linear-operator, dataclasses-json, sphinx-rtd-theme, qtconsole, gpytorch, tensorflow, gpflow, nbsphinx, jupyter
  Attempting uninstall: setuptools
    Found existing installation: setuptools 67.7.2
    Uninstalling setuptools-67.7.2:
      Successfully uninstalled setuptools-67.7.2
  Attempting uninstall: numpy
    Found existing installation: numpy 1.25.2
    Uninstalling numpy-1.25.2:
      Successfully uninstalled numpy-1.25.2
  Attempting uninstall: tensorflow
    Found existing installation: tensorflow 2.15.0
    Uninstalling tensorflow-2.15.0:
      Successfully uninstalled tensorflow-2.15.0
<span class=" -Color -Color-Red">ERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.</span>
<span class=" -Color -Color-Red">chex 0.1.85 requires numpy&gt;=1.24.1, but you have numpy 1.23.5 which is incompatible.</span>
Successfully installed cftime-1.6.3 check-shapes-1.1.1 dataclasses-json-0.5.7 deprecated-1.2.14 dropstackframe-0.1.0 global-land-mask-1.0.0 gpflow-2.9.1 gpytorch-1.10 jaxtyping-0.2.28 jedi-0.19.1 jupyter-1.0.0 lark-1.1.9 linear-operator-0.5.2 marshmallow-3.21.1 marshmallow-enum-1.5.1 mypy-extensions-1.0.0 nbsphinx-0.9.3 netCDF4-1.6.2 numpy-1.23.5 numpydoc-1.6.0 nvidia-cublas-cu12-12.2.5.6 nvidia-cuda-cupti-cu12-12.2.142 nvidia-cuda-nvcc-cu12-12.2.140 nvidia-cuda-nvrtc-cu12-12.2.140 nvidia-cuda-runtime-cu12-12.2.140 nvidia-cudnn-cu12-8.9.4.25 nvidia-cufft-cu12-11.0.8.103 nvidia-curand-cu12-10.3.3.141 nvidia-cusolver-cu12-11.5.2.141 nvidia-cusparse-cu12-12.1.2.141 nvidia-nccl-cu12-2.16.5 nvidia-nvjitlink-cu12-12.2.140 qtconsole-5.5.1 qtpy-2.4.1 setuptools-69.1.1 sphinx-rtd-theme-2.0.0 sphinxcontrib-jquery-4.1 sphinxemoji-0.3.1 tensorflow-2.15.0.post1 typeguard-2.13.3 typing-inspect-0.9.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">IN_COLAB</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>.
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Obtaining file:///content/GPSat
  Preparing metadata (setup.py) ... ?25l?25hdone
Installing collected packages: GPSat
  Running setup.py develop for GPSat
Successfully installed GPSat-0.0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeat</span>

<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">GPSat</span> <span class="kn">import</span> <span class="n">get_data_path</span><span class="p">,</span> <span class="n">get_parent_path</span>
<span class="kn">from</span> <span class="nn">GPSat.dataprepper</span> <span class="kn">import</span> <span class="n">DataPrep</span>
<span class="kn">from</span> <span class="nn">GPSat.utils</span> <span class="kn">import</span> <span class="n">WGS84toEASE2_New</span><span class="p">,</span> <span class="n">EASE2toWGS84_New</span><span class="p">,</span> <span class="n">cprint</span><span class="p">,</span> <span class="n">grid_2d_flatten</span><span class="p">,</span> <span class="n">get_weighted_values</span>
<span class="kn">from</span> <span class="nn">GPSat.local_experts</span> <span class="kn">import</span> <span class="n">LocalExpertOI</span><span class="p">,</span> <span class="n">get_results_from_h5file</span>
<span class="kn">from</span> <span class="nn">GPSat.plot_utils</span> <span class="kn">import</span> <span class="n">plot_pcolormesh</span><span class="p">,</span> <span class="n">get_projection</span><span class="p">,</span> <span class="n">plot_pcolormesh_from_results_data</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">smooth_hyperparameters</span>
<span class="kn">import</span> <span class="nn">GPSat</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions_1d</span>
<span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions_2d</span>


<span class="k">def</span> <span class="nf">GCdist</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Xs</span><span class="p">):</span>
    <span class="n">radius</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">lat</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(((</span><span class="mi">6378137</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6356752</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span>\
                                  <span class="p">(</span><span class="mi">6378137</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">6356752</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="n">minlat</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">maxlat</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
    <span class="n">lon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">;</span> <span class="n">lat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">lon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">0</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="p">;</span> <span class="n">lat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">Xs</span><span class="o">.</span><span class="n">T</span><span class="p">[(</span><span class="mi">1</span><span class="p">,)]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
    <span class="n">r</span> <span class="o">=</span> <span class="mi">6356752</span><span class="c1">#np.mean(radius(np.arange(minlat,maxlat)))</span>

    <span class="n">Clat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Clat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">Slat1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Slat2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lat2</span><span class="p">)</span>
    <span class="n">Clon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Clon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>
    <span class="n">Slon1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon1</span><span class="p">)</span> <span class="p">;</span> <span class="n">Slon2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">lon2</span><span class="p">)</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Clat1</span><span class="o">*</span><span class="n">Clon1</span><span class="p">,</span><span class="n">Clat1</span><span class="o">*</span><span class="n">Slon1</span><span class="p">,</span><span class="n">Slat1</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">Clat2</span><span class="o">*</span><span class="n">Clon2</span><span class="p">,</span><span class="n">Clat2</span><span class="o">*</span><span class="n">Slon2</span><span class="p">,</span><span class="n">Slat2</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n1</span><span class="p">,</span><span class="n">n2</span><span class="o">.</span><span class="n">T</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mounted at /content/drive
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="load-data">
<h1>Load data<a class="headerlink" href="#load-data" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#indices for GPOD data:</span>
<span class="c1">#0 = Lon</span>
<span class="c1">#1 = Lat</span>
<span class="c1">#2 = Interpolated SLA</span>
<span class="c1">#3 = Error in interpolated SLA</span>
<span class="c1">#4 = Freeboard</span>
<span class="c1">#5 = Pulse Peakiness</span>
<span class="c1">#6 = Lew</span>
<span class="c1">#7 = Class (1=Lead, 2=Floe, 3=OO)</span>
<span class="c1">#8 = Sigma 0</span>
<span class="c1">#9 = Raw Elevation</span>
<span class="c1">#10 = Mean Sea-surface</span>
<span class="c1">#11 = SIC</span>
<span class="c1">#12 = Sea ice type (0=FYI, 1=MYI)</span>
<span class="c1">#13 = Snow depth</span>
<span class="c1">#14 = Snow density</span>
<span class="c1">#15 = Sea ice thickness</span>
<span class="c1">#16 = GPOD SLA</span>
<span class="c1">#17 = GPOD SSH</span>
<span class="c1">#18 = GPOD SWH</span>
<span class="c1">#19 = Elevation from Samosa</span>

<span class="n">interp_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2019</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">)</span>
<span class="n">grab_dates</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">interp_date</span><span class="o">-</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span><span class="o">+</span><span class="p">[</span><span class="n">interp_date</span><span class="o">+</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)])</span>
<span class="n">grab_dates</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y%m</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">grab_dates</span><span class="p">]</span>

<span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">lat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dates</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">classif</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">interpSLA</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">elev</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">satellite</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">trackID</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># dirs = sorted(glob.glob(&#39;/Users/wg4031/Dropbox/GPOD_DATA/*&#39;))</span>
<span class="n">dirs</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/GPOD/*&#39;</span><span class="p">))</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">directory</span> <span class="ow">in</span> <span class="n">dirs</span><span class="p">:</span>
    <span class="n">tracks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">directory</span><span class="o">+</span><span class="s1">&#39;/*v1.proc&#39;</span><span class="p">))</span>
    <span class="n">SAT</span> <span class="o">=</span> <span class="n">directory</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">SAT</span> <span class="o">==</span> <span class="s1">&#39;SARIN&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">SAT</span> <span class="o">==</span> <span class="s1">&#39;SAR&#39;</span><span class="p">):</span>
    <span class="c1"># if (SAT == &#39;CS2_SARIN&#39;) or (SAT == &#39;CS2_SAR&#39;):</span>
        <span class="n">SAT</span> <span class="o">=</span> <span class="s1">&#39;CS2&#39;</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">grab_dates</span><span class="p">:</span>
                <span class="n">time</span> <span class="o">=</span> <span class="mi">14975</span> <span class="o">+</span> <span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[:</span><span class="mi">4</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]))</span><span class="o">-</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">days</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

                <span class="n">ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">f</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0.75</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;1.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lead&#39;</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;2.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;floe&#39;</span>
                <span class="n">elvmss</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1626</span> <span class="c1">#subtract 16.26cm bias (see Lawrence et al., 2019)</span>

                <span class="n">xg</span><span class="p">,</span><span class="n">yg</span> <span class="o">=</span> <span class="n">WGS84toEASE2_New</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">yg</span><span class="p">)</span>
                <span class="n">t</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">time</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">lon</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">lat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">dates</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">date</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">classif</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
                <span class="n">interpSLA</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">elev</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">elvmss</span><span class="p">)</span>
                <span class="n">satellite</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">SAT</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">trackID</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">SAT</span> <span class="o">==</span> <span class="s1">&#39;S3A&#39;</span><span class="p">):</span>
    <span class="c1"># if (SAT == &#39;CS2_SARIN&#39;) or (SAT == &#39;CS2_SAR&#39;):</span>
        <span class="n">SAT</span> <span class="o">=</span> <span class="s1">&#39;S3A&#39;</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">grab_dates</span><span class="p">:</span>
                <span class="n">time</span> <span class="o">=</span> <span class="mi">14975</span> <span class="o">+</span> <span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[:</span><span class="mi">4</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]))</span><span class="o">-</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">days</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

                <span class="n">ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">f</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0.75</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;1.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lead&#39;</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;2.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;floe&#39;</span>
                <span class="n">elvmss</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1626</span> <span class="c1">#subtract 16.26cm bias (see Lawrence et al., 2019)</span>

                <span class="n">xg</span><span class="p">,</span><span class="n">yg</span> <span class="o">=</span> <span class="n">WGS84toEASE2_New</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">yg</span><span class="p">)</span>
                <span class="n">t</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">time</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">lon</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">lat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">dates</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">date</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">classif</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
                <span class="n">interpSLA</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">elev</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">elvmss</span><span class="p">)</span>
                <span class="n">satellite</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">SAT</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">trackID</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">SAT</span> <span class="o">==</span> <span class="s1">&#39;S3B&#39;</span><span class="p">):</span>
    <span class="c1"># if (SAT == &#39;CS2_SARIN&#39;) or (SAT == &#39;CS2_SAR&#39;):</span>
        <span class="n">SAT</span> <span class="o">=</span> <span class="s1">&#39;S3B&#39;</span>
        <span class="k">for</span> <span class="n">track</span> <span class="ow">in</span> <span class="n">tracks</span><span class="p">:</span>
            <span class="n">date</span> <span class="o">=</span> <span class="n">track</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;T&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">grab_dates</span><span class="p">:</span>
                <span class="n">time</span> <span class="o">=</span> <span class="mi">14975</span> <span class="o">+</span> <span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[:</span><span class="mi">4</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">6</span><span class="p">]),</span><span class="nb">int</span><span class="p">(</span><span class="n">date</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">8</span><span class="p">]))</span><span class="o">-</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2011</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">days</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span><span class="n">track</span><span class="p">)</span>

                <span class="n">ID</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">f</span><span class="p">[:,</span><span class="mi">7</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">3</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">f</span><span class="p">[:,</span><span class="mi">11</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0.75</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">7</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;1.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lead&#39;</span>
                <span class="n">classes</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;2.0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;floe&#39;</span>
                <span class="n">elvmss</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">9</span><span class="p">]</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">elvmss</span><span class="p">[</span><span class="n">classes</span><span class="o">==</span><span class="s1">&#39;floe&#39;</span><span class="p">]</span><span class="o">-</span><span class="mf">0.1626</span> <span class="c1">#subtract 16.26cm bias (see Lawrence et al., 2019)</span>

                <span class="n">xg</span><span class="p">,</span><span class="n">yg</span> <span class="o">=</span> <span class="n">WGS84toEASE2_New</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">x</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">xg</span><span class="p">)</span>
                <span class="n">y</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">yg</span><span class="p">)</span>
                <span class="n">t</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">time</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">lon</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">lat</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">dates</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">date</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">classif</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">classes</span><span class="p">)</span>
                <span class="n">interpSLA</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="n">ID</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">elev</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">elvmss</span><span class="p">)</span>
                <span class="n">satellite</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">SAT</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">trackID</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">count</span><span class="p">]</span><span class="o">*</span><span class="n">N</span><span class="p">)</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>



<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="s1">&#39;y&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="s1">&#39;lon&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lon</span><span class="p">),</span><span class="s1">&#39;lat&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lat</span><span class="p">),</span><span class="s1">&#39;date&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">dates</span><span class="p">),</span>
                  <span class="s1">&#39;elevation&#39;</span><span class="p">:</span><span class="n">elev</span><span class="p">,</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">interpSLA</span><span class="p">),</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">classif</span><span class="p">),</span>
                  <span class="s1">&#39;SAT&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">satellite</span><span class="p">),</span><span class="s1">&#39;track&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trackID</span><span class="p">)})</span>

<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-fe094165-40a5-4010-9644-ab6b6f1ffa0b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>elevation</th>
      <th>interpSLA</th>
      <th>class</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-3.056178e+06</td>
      <td>-1.270463e+06</td>
      <td>17907</td>
      <td>-67.427184</td>
      <td>60.000844</td>
      <td>20190111</td>
      <td>0.4397</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-3.055943e+06</td>
      <td>-1.270243e+06</td>
      <td>17907</td>
      <td>-67.429148</td>
      <td>60.003653</td>
      <td>20190111</td>
      <td>0.4250</td>
      <td>0.4207</td>
      <td>lead</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-3.055707e+06</td>
      <td>-1.270022e+06</td>
      <td>17907</td>
      <td>-67.431112</td>
      <td>60.006463</td>
      <td>20190111</td>
      <td>0.4296</td>
      <td>0.4201</td>
      <td>lead</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-3.055472e+06</td>
      <td>-1.269801e+06</td>
      <td>17907</td>
      <td>-67.433077</td>
      <td>60.009272</td>
      <td>20190111</td>
      <td>0.4494</td>
      <td>0.4195</td>
      <td>lead</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-3.055236e+06</td>
      <td>-1.269580e+06</td>
      <td>17907</td>
      <td>-67.435042</td>
      <td>60.012081</td>
      <td>20190111</td>
      <td>0.4171</td>
      <td>0.4190</td>
      <td>lead</td>
      <td>S3A</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2063569</th>
      <td>-1.099325e+06</td>
      <td>3.126184e+05</td>
      <td>17915</td>
      <td>-105.874325</td>
      <td>79.752732</td>
      <td>20190119</td>
      <td>0.2087</td>
      <td>-0.0866</td>
      <td>floe</td>
      <td>CS2</td>
      <td>877</td>
    </tr>
    <tr>
      <th>2063570</th>
      <td>-1.099022e+06</td>
      <td>3.125989e+05</td>
      <td>17915</td>
      <td>-105.877535</td>
      <td>79.755398</td>
      <td>20190119</td>
      <td>-0.1044</td>
      <td>NaN</td>
      <td>lead</td>
      <td>CS2</td>
      <td>877</td>
    </tr>
    <tr>
      <th>2063571</th>
      <td>-1.098114e+06</td>
      <td>3.125402e+05</td>
      <td>17915</td>
      <td>-105.887172</td>
      <td>79.763397</td>
      <td>20190119</td>
      <td>0.2351</td>
      <td>NaN</td>
      <td>floe</td>
      <td>CS2</td>
      <td>877</td>
    </tr>
    <tr>
      <th>2063572</th>
      <td>-1.097811e+06</td>
      <td>3.125207e+05</td>
      <td>17915</td>
      <td>-105.890387</td>
      <td>79.766064</td>
      <td>20190119</td>
      <td>0.3295</td>
      <td>NaN</td>
      <td>floe</td>
      <td>CS2</td>
      <td>877</td>
    </tr>
    <tr>
      <th>2063573</th>
      <td>-1.097509e+06</td>
      <td>3.125011e+05</td>
      <td>17915</td>
      <td>-105.893604</td>
      <td>79.768730</td>
      <td>20190119</td>
      <td>0.3016</td>
      <td>NaN</td>
      <td>floe</td>
      <td>CS2</td>
      <td>877</td>
    </tr>
  </tbody>
</table>
<p>2063574 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-fe094165-40a5-4010-9644-ab6b6f1ffa0b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-fe094165-40a5-4010-9644-ab6b6f1ffa0b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-fe094165-40a5-4010-9644-ab6b6f1ffa0b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-14310478-52f8-4f21-8d16-2be5bf83d53e">
  <button class="colab-df-quickchart" onclick="quickchart('df-14310478-52f8-4f21-8d16-2be5bf83d53e')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-14310478-52f8-4f21-8d16-2be5bf83d53e button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/&#39;</span>

<span class="c1"># Assuming all_data_df is your DataFrame</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;df_GPOD.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># savepath = &#39;/Users/wg4031/Downloads/&#39;</span>
<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/&#39;</span>

<span class="c1"># Load DataFrame from CSV file</span>
<span class="c1"># df = pd.read_csv(savepath+&#39;all_data_01.csv&#39;)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">savepath</span><span class="o">+</span><span class="s1">&#39;df_GPOD.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="select-profile-for-interpolation">
<h1>Select profile for interpolation<a class="headerlink" href="#select-profile-for-interpolation" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0            0
1            0
2            0
3            0
4            0
          ... 
2063569    877
2063570    877
2063571    877
2063572    877
2063573    877
Name: track, Length: 2063574, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">interptrack</span> <span class="o">=</span> <span class="mi">136</span> <span class="c1">#track on interp day 20190115</span>
<span class="n">df_val</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;track&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">interptrack</span><span class="p">]</span>


<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">df_val</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/99cb8a7196d8902feff99877d84a9059a2c5fa7e82547718d8555069c12a363c.png" src="_images/99cb8a7196d8902feff99877d84a9059a2c5fa7e82547718d8555069c12a363c.png" />
<div class="output text_html">
  <div id="df-f1a2d1f9-48c1-4507-8d0d-b413b6dd6e38" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>elevation</th>
      <th>interpSLA</th>
      <th>class</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>293032</th>
      <td>-9.647215e+05</td>
      <td>8.001362e+04</td>
      <td>17911</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293033</th>
      <td>-9.657332e+05</td>
      <td>9.735208e+04</td>
      <td>17911</td>
      <td>-95.756335</td>
      <td>81.300914</td>
      <td>20190115</td>
      <td>-0.2707</td>
      <td>-0.1441</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293034</th>
      <td>-9.658105e+05</td>
      <td>9.868576e+04</td>
      <td>17911</td>
      <td>-95.834190</td>
      <td>81.299013</td>
      <td>20190115</td>
      <td>NaN</td>
      <td>-0.1451</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293035</th>
      <td>-9.658492e+05</td>
      <td>9.935263e+04</td>
      <td>17911</td>
      <td>-95.873106</td>
      <td>81.298057</td>
      <td>20190115</td>
      <td>0.0723</td>
      <td>-0.1456</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293036</th>
      <td>-9.658685e+05</td>
      <td>9.968607e+04</td>
      <td>17911</td>
      <td>-95.892562</td>
      <td>81.297578</td>
      <td>20190115</td>
      <td>0.3727</td>
      <td>-0.1458</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>296847</th>
      <td>-1.006973e+06</td>
      <td>1.866945e+06</td>
      <td>17911</td>
      <td>-151.658943</td>
      <td>70.913814</td>
      <td>20190115</td>
      <td>-0.1308</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296848</th>
      <td>-1.006953e+06</td>
      <td>1.868595e+06</td>
      <td>17911</td>
      <td>-151.680544</td>
      <td>70.900700</td>
      <td>20190115</td>
      <td>-0.1692</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296849</th>
      <td>-1.006950e+06</td>
      <td>1.868925e+06</td>
      <td>17911</td>
      <td>-151.684861</td>
      <td>70.898077</td>
      <td>20190115</td>
      <td>-0.1565</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296850</th>
      <td>-1.006946e+06</td>
      <td>1.869255e+06</td>
      <td>17911</td>
      <td>-151.689177</td>
      <td>70.895454</td>
      <td>20190115</td>
      <td>-0.0730</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296851</th>
      <td>-1.006942e+06</td>
      <td>1.869585e+06</td>
      <td>17911</td>
      <td>-151.693492</td>
      <td>70.892831</td>
      <td>20190115</td>
      <td>-0.0907</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
  </tbody>
</table>
<p>3820 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-f1a2d1f9-48c1-4507-8d0d-b413b6dd6e38')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-f1a2d1f9-48c1-4507-8d0d-b413b6dd6e38 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-f1a2d1f9-48c1-4507-8d0d-b413b6dd6e38');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c5c172db-2fad-41b9-8878-d3167f8a131b">
  <button class="colab-df-quickchart" onclick="quickchart('df-c5c172db-2fad-41b9-8878-d3167f8a131b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c5c172db-2fad-41b9-8878-d3167f8a131b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lead&#39;</span><span class="p">)</span>
<span class="n">floes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;floe&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">leads</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">leads</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;leads&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">floes</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">floes</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;floes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">])),</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5873b681bb94ea30e8c89a78c412c7f263642ccfe9b4fb6d0f5f4e225cf70262.png" src="_images/5873b681bb94ea30e8c89a78c412c7f263642ccfe9b4fb6d0f5f4e225cf70262.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="generate-expert-locations-at-200-km">
<h1>Generate expert locations at 200 km<a class="headerlink" href="#generate-expert-locations-at-200-km" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#divide track into 200 km points for expert locations</span>
<span class="n">Xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>
<span class="n">r_exp</span> <span class="o">=</span> <span class="n">GCdist</span><span class="p">(</span><span class="n">Xs</span><span class="p">,</span><span class="n">Xs</span><span class="p">)</span> <span class="c1">#compute distance matrix</span>
<span class="n">exp_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]),</span><span class="mf">100e3</span><span class="p">)</span>
<span class="n">locs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ix</span> <span class="ow">in</span> <span class="n">exp_grid</span><span class="p">:</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">r_exp</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">-</span><span class="n">ix</span><span class="p">)</span>
    <span class="n">dm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">temp</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">temp</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">locs</span><span class="p">)</span><span class="o">&lt;=</span><span class="mi">16</span><span class="p">:</span>
        <span class="n">locs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dm</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="n">subplot_kw</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">()))</span>
<span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">90</span><span class="p">],</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cfeat</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">,</span><span class="mf">0.7</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span><span class="n">vmin</span><span class="o">=-</span><span class="mf">0.3</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">c</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">],</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">],</span><span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">experts</span> <span class="o">=</span> <span class="n">df_val</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">locs</span><span class="p">]</span>
<span class="n">experts</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c37c50ec9125010a4abf3174afa08b66c4ded9bdc7ceb4105bb50d6903c1310c.png" src="_images/c37c50ec9125010a4abf3174afa08b66c4ded9bdc7ceb4105bb50d6903c1310c.png" />
<div class="output text_html">
  <div id="df-c7b560df-02e2-427d-813e-b2d20ad480f4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>elevation</th>
      <th>interpSLA</th>
      <th>class</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>293032</th>
      <td>-9.647215e+05</td>
      <td>8.001362e+04</td>
      <td>17911</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293257</th>
      <td>-9.704333e+05</td>
      <td>1.807138e+05</td>
      <td>17911</td>
      <td>-100.548776</td>
      <td>81.152823</td>
      <td>20190115</td>
      <td>NaN</td>
      <td>-0.1112</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293540</th>
      <td>-9.757493e+05</td>
      <td>2.814191e+05</td>
      <td>17911</td>
      <td>-106.088264</td>
      <td>80.897666</td>
      <td>20190115</td>
      <td>NaN</td>
      <td>-0.0741</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293787</th>
      <td>-9.806846e+05</td>
      <td>3.824547e+05</td>
      <td>17911</td>
      <td>-111.305158</td>
      <td>80.564322</td>
      <td>20190115</td>
      <td>NaN</td>
      <td>-0.1113</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>294032</th>
      <td>-9.852062e+05</td>
      <td>4.831453e+05</td>
      <td>17911</td>
      <td>-116.123339</td>
      <td>80.162816</td>
      <td>20190115</td>
      <td>0.2475</td>
      <td>-0.0977</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>294244</th>
      <td>-9.893178e+05</td>
      <td>5.834831e+05</td>
      <td>17911</td>
      <td>-120.531395</td>
      <td>79.701889</td>
      <td>20190115</td>
      <td>-0.1234</td>
      <td>-0.0940</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>294488</th>
      <td>-9.930581e+05</td>
      <td>6.844599e+05</td>
      <td>17911</td>
      <td>-124.576343</td>
      <td>79.184512</td>
      <td>20190115</td>
      <td>0.1136</td>
      <td>-0.0422</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>294743</th>
      <td>-9.963981e+05</td>
      <td>7.854005e+05</td>
      <td>17911</td>
      <td>-128.246582</td>
      <td>78.620875</td>
      <td>20190115</td>
      <td>0.2212</td>
      <td>-0.0261</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>294948</th>
      <td>-9.993285e+05</td>
      <td>8.859638e+05</td>
      <td>17911</td>
      <td>-131.558885</td>
      <td>78.019570</td>
      <td>20190115</td>
      <td>0.1093</td>
      <td>-0.0169</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>295163</th>
      <td>-1.001861e+06</td>
      <td>9.864750e+05</td>
      <td>17911</td>
      <td>-134.556649</td>
      <td>77.384464</td>
      <td>20190115</td>
      <td>0.1629</td>
      <td>0.0107</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>295393</th>
      <td>-1.003995e+06</td>
      <td>1.086926e+06</td>
      <td>17911</td>
      <td>-137.271294</td>
      <td>76.720423</td>
      <td>20190115</td>
      <td>0.0876</td>
      <td>0.0494</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>295555</th>
      <td>-1.005711e+06</td>
      <td>1.185979e+06</td>
      <td>17911</td>
      <td>-139.702054</td>
      <td>76.040860</td>
      <td>20190115</td>
      <td>0.0749</td>
      <td>0.0873</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>295746</th>
      <td>-1.007083e+06</td>
      <td>1.288943e+06</td>
      <td>17911</td>
      <td>-141.998591</td>
      <td>75.311940</td>
      <td>20190115</td>
      <td>0.1013</td>
      <td>0.1221</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>295951</th>
      <td>-1.008017e+06</td>
      <td>1.389163e+06</td>
      <td>17911</td>
      <td>-144.034273</td>
      <td>74.583275</td>
      <td>20190115</td>
      <td>0.2134</td>
      <td>0.1485</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296159</th>
      <td>-1.008550e+06</td>
      <td>1.488628e+06</td>
      <td>17911</td>
      <td>-145.882250</td>
      <td>73.843791</td>
      <td>20190115</td>
      <td>0.0896</td>
      <td>0.1145</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296340</th>
      <td>-1.008689e+06</td>
      <td>1.588987e+06</td>
      <td>17911</td>
      <td>-147.592630</td>
      <td>73.083192</td>
      <td>20190115</td>
      <td>0.0450</td>
      <td>0.0691</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296522</th>
      <td>-1.008427e+06</td>
      <td>1.689237e+06</td>
      <td>17911</td>
      <td>-149.164002</td>
      <td>72.310595</td>
      <td>20190115</td>
      <td>0.0948</td>
      <td>0.0349</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c7b560df-02e2-427d-813e-b2d20ad480f4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c7b560df-02e2-427d-813e-b2d20ad480f4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c7b560df-02e2-427d-813e-b2d20ad480f4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-98db1c4a-6b95-4878-aa2e-4e5cdfbfeb13">
  <button class="colab-df-quickchart" onclick="quickchart('df-98db1c4a-6b95-4878-aa2e-4e5cdfbfeb13')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-98db1c4a-6b95-4878-aa2e-4e5cdfbfeb13 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_val</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-ce86a6c3-a971-47ed-afbf-d625c79bdfa6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>elevation</th>
      <th>interpSLA</th>
      <th>class</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>293032</th>
      <td>-9.647215e+05</td>
      <td>8.001362e+04</td>
      <td>17911</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293033</th>
      <td>-9.657332e+05</td>
      <td>9.735208e+04</td>
      <td>17911</td>
      <td>-95.756335</td>
      <td>81.300914</td>
      <td>20190115</td>
      <td>-0.2707</td>
      <td>-0.1441</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293034</th>
      <td>-9.658105e+05</td>
      <td>9.868576e+04</td>
      <td>17911</td>
      <td>-95.834190</td>
      <td>81.299013</td>
      <td>20190115</td>
      <td>NaN</td>
      <td>-0.1451</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293035</th>
      <td>-9.658492e+05</td>
      <td>9.935263e+04</td>
      <td>17911</td>
      <td>-95.873106</td>
      <td>81.298057</td>
      <td>20190115</td>
      <td>0.0723</td>
      <td>-0.1456</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>293036</th>
      <td>-9.658685e+05</td>
      <td>9.968607e+04</td>
      <td>17911</td>
      <td>-95.892562</td>
      <td>81.297578</td>
      <td>20190115</td>
      <td>0.3727</td>
      <td>-0.1458</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>296847</th>
      <td>-1.006973e+06</td>
      <td>1.866945e+06</td>
      <td>17911</td>
      <td>-151.658943</td>
      <td>70.913814</td>
      <td>20190115</td>
      <td>-0.1308</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296848</th>
      <td>-1.006953e+06</td>
      <td>1.868595e+06</td>
      <td>17911</td>
      <td>-151.680544</td>
      <td>70.900700</td>
      <td>20190115</td>
      <td>-0.1692</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296849</th>
      <td>-1.006950e+06</td>
      <td>1.868925e+06</td>
      <td>17911</td>
      <td>-151.684861</td>
      <td>70.898077</td>
      <td>20190115</td>
      <td>-0.1565</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296850</th>
      <td>-1.006946e+06</td>
      <td>1.869255e+06</td>
      <td>17911</td>
      <td>-151.689177</td>
      <td>70.895454</td>
      <td>20190115</td>
      <td>-0.0730</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>296851</th>
      <td>-1.006942e+06</td>
      <td>1.869585e+06</td>
      <td>17911</td>
      <td>-151.693492</td>
      <td>70.892831</td>
      <td>20190115</td>
      <td>-0.0907</td>
      <td>NaN</td>
      <td>floe</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
  </tbody>
</table>
<p>3820 rows × 11 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ce86a6c3-a971-47ed-afbf-d625c79bdfa6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ce86a6c3-a971-47ed-afbf-d625c79bdfa6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ce86a6c3-a971-47ed-afbf-d625c79bdfa6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-62b5a6f1-4b77-47c7-8456-fdd618b0e10b">
  <button class="colab-df-quickchart" onclick="quickchart('df-62b5a6f1-4b77-47c7-8456-fdd618b0e10b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-62b5a6f1-4b77-47c7-8456-fdd618b0e10b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="interpolate-along-track">
<h1>Interpolate along-track<a class="headerlink" href="#interpolate-along-track" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#WHERE TO SAVE</span>
<span class="c1"># store_path = get_parent_path(&quot;/Users/wg4031/Dropbox/&quot;, &quot;GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5&quot;)</span>
<span class="n">store_path</span> <span class="o">=</span> <span class="n">get_parent_path</span><span class="p">(</span><span class="s2">&quot;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/&quot;</span><span class="p">,</span> <span class="s2">&quot;GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5&quot;</span><span class="p">)</span>


<span class="c1">#SET PARAMETERS OF MODEL (e.g., use data within 300 km and +/- 4 days)</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;data_source&quot;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;lead&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">])</span><span class="o">&lt;</span><span class="mf">0.6</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]))],</span>
    <span class="s2">&quot;obs_col&quot;</span><span class="p">:</span> <span class="s2">&quot;elevation&quot;</span><span class="p">,</span>
    <span class="s2">&quot;coords_col&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;t&quot;</span><span class="p">],</span>
    <span class="c1"># selection criteria used for each local expert</span>
    <span class="s2">&quot;local_select&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;x&quot;</span><span class="p">,</span>
                <span class="s2">&quot;y&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">100_000</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span><span class="s2">&quot;&lt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span><span class="mi">2</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span><span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span>
        <span class="p">}</span>
    <span class="p">],</span>
    <span class="s2">&quot;global_select&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;col&quot;</span><span class="p">:</span> <span class="s2">&quot;lat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;comp&quot;</span><span class="p">:</span> <span class="s2">&quot;&gt;=&quot;</span><span class="p">,</span>
            <span class="s2">&quot;val&quot;</span><span class="p">:</span> <span class="mi">45</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>

<span class="c1">#GIVE DATAFRAME OF EXPERTS</span>
<span class="n">local_expert</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;source&quot;</span><span class="p">:</span> <span class="n">experts</span>
<span class="p">}</span>

<span class="c1">#GIVE DATAFRAME OF PREDICTION LOCATIONS (predict at all lead and floe locations along track)</span>
<span class="n">pred_loc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;method&quot;</span><span class="p">:</span> <span class="s2">&quot;from_dataframe&quot;</span><span class="p">,</span>
    <span class="s2">&quot;df&quot;</span><span class="p">:</span> <span class="n">df_val</span><span class="p">,</span>
    <span class="s2">&quot;max_dist&quot;</span><span class="p">:</span> <span class="mi">200_000</span>
<span class="p">}</span>


<span class="c1">#SETUP SPARSE GP MODEL (PLAY WITH MINIBATCH AND INDUCING POINTS)</span>
<span class="n">model</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># &quot;oi_model&quot;: &quot;GPflowSVGPModel&quot;,</span>
    <span class="s2">&quot;oi_model&quot;</span><span class="p">:</span> <span class="s2">&quot;GPflowGPRModel&quot;</span><span class="p">,</span>
    <span class="s2">&quot;init_params&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># scale (divide) coordinates</span>
        <span class="s2">&quot;coords_scale&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="s2">&quot;minibatch_size&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">&quot;num_inducing_points&quot;</span><span class="p">:</span><span class="mi">200</span>
    <span class="p">},</span>
    <span class="s2">&quot;constraints&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="c1"># lengthscales - same order coord_col (see data)</span>
        <span class="s2">&quot;lengthscales&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100_000</span><span class="p">,</span> <span class="mi">100_000</span><span class="p">,</span> <span class="mf">1e-08</span><span class="p">],</span>
            <span class="c1"># &quot;low&quot;: [5_000, 5_000, 1e-08],</span>
            <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200000</span><span class="p">,</span> <span class="mi">200000</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="mi">10</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">locexp</span> <span class="o">=</span> <span class="n">LocalExpertOI</span><span class="p">(</span><span class="n">expert_loc_config</span><span class="o">=</span><span class="n">local_expert</span><span class="p">,</span>
                       <span class="n">data_config</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                       <span class="n">model_config</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                       <span class="n">pred_loc_config</span><span class="o">=</span><span class="n">pred_loc</span><span class="p">)</span>

<span class="c1"># run optimal interpolation</span>
<span class="n">locexp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
           <span class="n">optimise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1">#SMOOTH HYPERPARMETERS</span>
<span class="n">smooth_configs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;lengthscales&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
                  <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">),</span>
                  <span class="s2">&quot;kernel_variance&quot;</span><span class="p">:</span> <span class="nb">dict</span><span class="p">(</span><span class="n">l_x</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="n">l_y</span><span class="o">=</span><span class="mi">200_000</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)}</span>

<span class="n">smooth_hyperparameters</span><span class="p">(</span><span class="n">result_file</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
                       <span class="n">params_to_smooth</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;lengthscales&quot;</span><span class="p">,</span> <span class="s2">&quot;kernel_variance&quot;</span><span class="p">,</span> <span class="s2">&quot;likelihood_variance&quot;</span><span class="p">],</span>
                       <span class="n">smooth_config_dict</span><span class="o">=</span><span class="n">smooth_configs</span><span class="p">,</span>
                       <span class="n">save_config_file</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># %%</span>
<span class="c1"># ---</span>
<span class="c1"># Make predictions with smoothed hyperparameters</span>
<span class="c1"># ---</span>
<span class="n">model</span><span class="p">[</span><span class="s1">&#39;load_params&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file&quot;</span><span class="p">:</span> <span class="n">store_path</span><span class="p">,</span> <span class="s2">&quot;table_suffix&quot;</span><span class="p">:</span> <span class="s2">&quot;_SMOOTHED&quot;</span><span class="p">}</span>
<span class="n">locexp</span> <span class="o">=</span> <span class="n">LocalExpertOI</span><span class="p">(</span><span class="n">expert_loc_config</span><span class="o">=</span><span class="n">local_expert</span><span class="p">,</span>
                       <span class="n">data_config</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                       <span class="n">model_config</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
                       <span class="n">pred_loc_config</span><span class="o">=</span><span class="n">pred_loc</span><span class="p">)</span>

<span class="n">locexp</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">store_path</span><span class="o">=</span><span class="n">store_path</span><span class="p">,</span>
           <span class="n">optimise</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">predict</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
           <span class="n">table_suffix</span><span class="o">=</span><span class="s1">&#39;_SMOOTHED&#39;</span><span class="p">)</span>

<span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">store</span><span class="p">:</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_mean&#39;</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_mean_SMOOTHED&#39;</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_chol&#39;</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_chol_SMOOTHED&#39;</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_points&#39;</span><span class="p">)</span>
    <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_points_SMOOTHED&#39;</span><span class="p">)</span>

<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;ptrepack --chunkshape=auto --propindexes --complib=blosc &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="o">+</span><span class="s1">&#39; temp_store_3D.csv&#39;</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;rm &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="p">)</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;mv temp_store_3D.csv &#39;</span><span class="o">+</span><span class="n">store_path</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Done!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.001 seconds
in json_serializable - key: &#39;data_source&#39; has value DataFrame/Series, but is too long: 933261 &gt;  100
storing as str
in json_serializable - key: &#39;df&#39; has value DataFrame/Series, but is too long: 3820 &gt;  100
storing as str
---------
storing expert locations in &#39;expert_locs&#39; table
exception occurred: &#39;No object named expert_locs in the file&#39;
will now close object

---------
dropping expert locations that already exists in &#39;run_details&#39; table
exception occurred: &#39;No object named run_details in the file&#39;
will now close object

<span class=" -Color -Color-Bold">--------------------------------------------------</span>
1 / 17
current local expert:
                    x             y      t        lon        lat      date  \
293032 -964721.476545  80013.622113  17911 -94.741238  81.324207  20190115   

        elevation  interpSLA class  SAT  track  
293032    -0.0435        NaN  lead  S3A    136  
&#39;data_select&#39;: 0.274 seconds
&#39;load&#39;: 0.386 seconds
&#39;local_data_select&#39;: 0.366 seconds
number obs: 175
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 3.766 seconds
&#39;get_parameters&#39;: 0.010 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.108 seconds
&#39;optimise_parameters&#39;: 4.669 seconds
&#39;get_parameters&#39;: 0.007 seconds
parameters:
lengthscales: array([19.99999271, 10.        ,  0.88866497]) 
kernel_variance: 0.0430536058303766
likelihood_variance: 0.01477252407915098
&#39;predict&#39;: 0.119 seconds
total run time : 10.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
2 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293257 -970433.346901  180713.832721  17911 -100.548776  81.152823  20190115   

        elevation  interpSLA class  SAT  track  
293257        NaN    -0.1112  floe  S3A    136  
&#39;local_data_select&#39;: 0.430 seconds
number obs: 402
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.060 seconds
&#39;set_lengthscales_constraints&#39;: 0.020 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
&#39;optimise_parameters&#39;: 0.945 seconds
&#39;get_parameters&#39;: 0.005 seconds
parameters:
lengthscales: array([10.01001584, 10.00987674,  0.76385487]) 
kernel_variance: 0.006890050305771766
likelihood_variance: 0.017068883578775677
&#39;predict&#39;: 0.076 seconds
total run time : 2.17 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
3 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293540 -975749.307733  281419.070989  17911 -106.088264  80.897666  20190115   

        elevation  interpSLA class  SAT  track  
293540        NaN    -0.0741  floe  S3A    136  
&#39;local_data_select&#39;: 0.297 seconds
number obs: 456
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 0.861 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([14.341449, 10.      ,  4.      ]) 
kernel_variance: 0.02635603404748697
likelihood_variance: 0.01210612297648422
&#39;predict&#39;: 0.080 seconds
total run time : 1.92 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
4 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293787 -980684.592115  382454.654078  17911 -111.305158  80.564322  20190115   

        elevation  interpSLA class  SAT  track  
293787        NaN    -0.1113  floe  S3A    136  
&#39;local_data_select&#39;: 0.293 seconds
number obs: 725
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 1.641 seconds
&#39;get_parameters&#39;: 0.005 seconds
parameters:
lengthscales: array([10.        , 10.00007354,  1.69677076]) 
kernel_variance: 0.02019478365640555
likelihood_variance: 0.01
&#39;predict&#39;: 0.099 seconds
total run time : 2.69 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
5 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294032 -985206.226433  483145.278338  17911 -116.123339  80.162816  20190115   

        elevation  interpSLA class  SAT  track  
294032     0.2475    -0.0977  floe  S3A    136  
&#39;local_data_select&#39;: 0.294 seconds
number obs: 944
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.047 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 2.235 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.00000363, 10.01043752,  1.60707399]) 
kernel_variance: 0.013727496913800962
likelihood_variance: 0.010658148132878858
&#39;predict&#39;: 0.115 seconds
total run time : 3.35 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
6 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294244 -989317.812886  583483.138854  17911 -120.531395  79.701889  20190115   

        elevation  interpSLA class  SAT  track  
294244    -0.1234     -0.094  floe  S3A    136  
&#39;local_data_select&#39;: 0.327 seconds
number obs: 702
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.030 seconds
**********
optimization failed!
&#39;optimise_parameters&#39;: 4.813 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([19.99999994, 17.58238501,  4.        ]) 
kernel_variance: 0.0022200264722359512
likelihood_variance: 0.01254682630824435
&#39;predict&#39;: 0.087 seconds
total run time : 5.89 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
7 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294488 -993058.063068  684459.877912  17911 -124.576343  79.184512  20190115   

        elevation  interpSLA class  SAT  track  
294488     0.1136    -0.0422  floe  S3A    136  
&#39;local_data_select&#39;: 0.307 seconds
number obs: 824
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.050 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.022 seconds
&#39;optimise_parameters&#39;: 1.643 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.00000046, 10.00000393,  4.        ]) 
kernel_variance: 0.0053004091404399226
likelihood_variance: 0.010000000000000406
&#39;predict&#39;: 0.097 seconds
total run time : 2.72 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
8 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294743 -996398.060176  785400.509049  17911 -128.246582  78.620875  20190115   

        elevation  interpSLA class  SAT  track  
294743     0.2212    -0.0261  floe  S3A    136  
&#39;local_data_select&#39;: 0.292 seconds
number obs: 1088
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 3.141 seconds
&#39;get_parameters&#39;: 0.021 seconds
parameters:
lengthscales: array([10.00000759, 10.00014288,  2.13480654]) 
kernel_variance: 0.007392448187585952
likelihood_variance: 0.01000000000009845
&#39;predict&#39;: 0.339 seconds
total run time : 5.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
9 / 17
current local expert:
                    x              y      t         lon       lat      date  \
294948 -999328.512971  885963.803449  17911 -131.558885  78.01957  20190115   

        elevation  interpSLA class  SAT  track  
294948     0.1093    -0.0169  floe  S3A    136  
&#39;local_data_select&#39;: 1.574 seconds
number obs: 1052
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.202 seconds
&#39;set_lengthscales_constraints&#39;: 0.051 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.125 seconds
&#39;optimise_parameters&#39;: 6.389 seconds
&#39;get_parameters&#39;: 0.013 seconds
parameters:
lengthscales: array([19.99988387, 20.        ,  1.04963929]) 
kernel_variance: 0.002075142758629723
likelihood_variance: 0.01
&#39;predict&#39;: 0.233 seconds
total run time : 9.51 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
10 / 17
current local expert:
                   x              y      t         lon        lat      date  \
295163 -1.001861e+06  986475.006722  17911 -134.556649  77.384464  20190115   

        elevation  interpSLA class  SAT  track  
295163     0.1629     0.0107  floe  S3A    136  
&#39;local_data_select&#39;: 0.473 seconds
number obs: 1195
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.063 seconds
&#39;set_lengthscales_constraints&#39;: 0.022 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.046 seconds
&#39;optimise_parameters&#39;: 4.052 seconds
&#39;get_parameters&#39;: 0.024 seconds
parameters:
lengthscales: array([10.00000012, 14.1004491 ,  3.99999999]) 
kernel_variance: 0.009617917843922491
likelihood_variance: 0.01000000000138903
&#39;predict&#39;: 0.318 seconds
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
total run time : 8.09 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
11 / 17
current local expert:
                   x             y      t         lon        lat      date  \
295393 -1.003995e+06  1.086926e+06  17911 -137.271294  76.720423  20190115   

        elevation  interpSLA class  SAT  track  
295393     0.0876     0.0494  lead  S3A    136  
&#39;local_data_select&#39;: 0.612 seconds
number obs: 1672
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.147 seconds
&#39;set_lengthscales_constraints&#39;: 0.040 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.065 seconds
&#39;optimise_parameters&#39;: 11.466 seconds
&#39;get_parameters&#39;: 0.009 seconds
parameters:
lengthscales: array([12.27667603, 10.        ,  3.67229893]) 
kernel_variance: 0.01959755685357417
likelihood_variance: 0.01
&#39;predict&#39;: 0.182 seconds
total run time : 13.14 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
12 / 17
current local expert:
                   x             y      t         lon       lat      date  \
295555 -1.005711e+06  1.185979e+06  17911 -139.702054  76.04086  20190115   

        elevation  interpSLA class  SAT  track  
295555     0.0749     0.0873  lead  S3A    136  
&#39;local_data_select&#39;: 0.305 seconds
number obs: 2622
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 18.342 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([19.99999949, 10.        ,  4.        ]) 
kernel_variance: 0.024659743032565754
likelihood_variance: 0.01
&#39;predict&#39;: 0.314 seconds
total run time : 19.72 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
13 / 17
current local expert:
                   x             y      t         lon       lat      date  \
295746 -1.007083e+06  1.288943e+06  17911 -141.998591  75.31194  20190115   

        elevation  interpSLA class  SAT  track  
295746     0.1013     0.1221  lead  S3A    136  
&#39;local_data_select&#39;: 0.303 seconds
number obs: 2577
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.024 seconds
&#39;optimise_parameters&#39;: 20.642 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.0170807 , 12.07547748,  4.        ]) 
kernel_variance: 0.010214916585432453
likelihood_variance: 0.01
&#39;predict&#39;: 0.286 seconds
total run time : 21.98 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
14 / 17
current local expert:
                   x             y      t         lon        lat      date  \
295951 -1.008017e+06  1.389163e+06  17911 -144.034273  74.583275  20190115   

        elevation  interpSLA class  SAT  track  
295951     0.2134     0.1485  floe  S3A    136  
&#39;local_data_select&#39;: 0.300 seconds
number obs: 2340
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;set_lengthscales_constraints&#39;: 0.013 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 22.565 seconds
&#39;get_parameters&#39;: 0.009 seconds
parameters:
lengthscales: array([10.00000009, 20.        ,  3.906177  ]) 
kernel_variance: 0.016228411353574945
likelihood_variance: 0.01
&#39;predict&#39;: 0.309 seconds
total run time : 23.97 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
15 / 17
current local expert:
                   x             y      t        lon        lat      date  \
296159 -1.008550e+06  1.488628e+06  17911 -145.88225  73.843791  20190115   

        elevation  interpSLA class  SAT  track  
296159     0.0896     0.1145  lead  S3A    136  
&#39;local_data_select&#39;: 0.303 seconds
number obs: 2321
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.042 seconds
&#39;set_lengthscales_constraints&#39;: 0.017 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.032 seconds
**********
optimization failed!
&#39;optimise_parameters&#39;: 56.327 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([20.        , 20.        ,  1.34604534]) 
kernel_variance: 0.015474384698214673
likelihood_variance: 0.01
&#39;predict&#39;: 0.268 seconds
total run time : 57.69 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
16 / 17
current local expert:
                   x             y      t        lon        lat      date  \
296340 -1.008689e+06  1.588987e+06  17911 -147.59263  73.083192  20190115   

        elevation  interpSLA class  SAT  track  
296340      0.045     0.0691  lead  S3A    136  
&#39;local_data_select&#39;: 0.294 seconds
number obs: 1756
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;set_lengthscales_constraints&#39;: 0.012 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.022 seconds
&#39;optimise_parameters&#39;: 7.354 seconds
&#39;get_parameters&#39;: 0.005 seconds
parameters:
lengthscales: array([10.00005326, 10.00121324,  2.89993962]) 
kernel_variance: 0.016769875268185207
likelihood_variance: 0.01
&#39;predict&#39;: 0.172 seconds
total run time : 8.53 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
17 / 17
current local expert:
                   x             y      t         lon        lat      date  \
296522 -1.008427e+06  1.689237e+06  17911 -149.164002  72.310595  20190115   

        elevation  interpSLA class  SAT  track  
296522     0.0948     0.0349  floe  S3A    136  
&#39;local_data_select&#39;: 0.295 seconds
number obs: 862
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.049 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.023 seconds
&#39;optimise_parameters&#39;: 1.873 seconds
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([13.84233964, 10.00000027,  4.        ]) 
kernel_variance: 0.010765855862057562
likelihood_variance: 0.01
&#39;predict&#39;: 0.099 seconds
total run time : 2.95 seconds
storing any remaining tables
SAVING RESULTS TO TABLES:
run_details
preds
lengthscales
kernel_variance
likelihood_variance
&#39;run&#39;: 200.787 seconds
found model_name: GPflowGPRModel
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1.]
&#39;__init__&#39;: 0.041 seconds
reading in results
selecting only tables: [&#39;lengthscales&#39;, &#39;kernel_variance&#39;, &#39;likelihood_variance&#39;]
&#39;data_select&#39;: 0.001 seconds
&#39;load&#39;: 0.001 seconds
expert_locations data will not be merged on results data
adding smoothed table: lengthscales_SMOOTHED
adding smoothed table: kernel_variance_SMOOTHED
adding smoothed table: likelihood_variance_SMOOTHED
writing (smoothed) hyper parameters to:
/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5
table_suffix:_SMOOTHED
<span class=" -Color -Color-Bold">writing: lengthscales_SMOOTHED to table</span>
<span class=" -Color -Color-Bold">writing: kernel_variance_SMOOTHED to table</span>
<span class=" -Color -Color-Bold">writing: likelihood_variance_SMOOTHED to table</span>
&#39;data_select&#39;: 0.000 seconds
&#39;load&#39;: 0.001 seconds
in json_serializable - key: &#39;data_source&#39; has value DataFrame/Series, but is too long: 933261 &gt;  100
storing as str
in json_serializable - key: &#39;df&#39; has value DataFrame/Series, but is too long: 3820 &gt;  100
storing as str
---------
storing expert locations in &#39;expert_locs&#39; table
exception occurred: &#39;No object named expert_locs_SMOOTHED in the file&#39;
will now close object

---------
dropping expert locations that already exists in &#39;run_details&#39; table
exception occurred: &#39;No object named run_details_SMOOTHED in the file&#39;
will now close object

<span class=" -Color -Color-Bold">--------------------------------------------------</span>
1 / 17
current local expert:
                    x             y      t        lon        lat      date  \
293032 -964721.476545  80013.622113  17911 -94.741238  81.324207  20190115   

        elevation  interpSLA class  SAT  track  
293032    -0.0435        NaN  lead  S3A    136  
&#39;data_select&#39;: 0.238 seconds
&#39;load&#39;: 0.422 seconds
&#39;local_data_select&#39;: 0.315 seconds
number obs: 175
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.044 seconds
&#39;get_parameters&#39;: 0.008 seconds
&#39;_read_params_from_file&#39;: 0.098 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.036 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.10425991, 10.0315753 ,  1.65131413]) 
kernel_variance: 0.02457404425398971
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.070 seconds
total run time : 1.61 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
2 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293257 -970433.346901  180713.832721  17911 -100.548776  81.152823  20190115   

        elevation  interpSLA class  SAT  track  
293257        NaN    -0.1112  floe  S3A    136  
&#39;local_data_select&#39;: 0.299 seconds
number obs: 402
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.098 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.034 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.98284926, 10.07241214,  1.89263169]) 
kernel_variance: 0.022018459268885522
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.099 seconds
total run time : 1.23 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
3 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293540 -975749.307733  281419.070989  17911 -106.088264  80.897666  20190115   

        elevation  interpSLA class  SAT  track  
293540        NaN    -0.0741  floe  S3A    136  
&#39;local_data_select&#39;: 0.358 seconds
number obs: 456
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;_read_params_from_file&#39;: 0.096 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.032 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.005 seconds
parameters:
lengthscales: array([10.86660543, 10.15167515,  2.14329756]) 
kernel_variance: 0.01927378158838059
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.106 seconds
total run time : 1.25 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
4 / 17
current local expert:
                    x              y      t         lon        lat      date  \
293787 -980684.592115  382454.654078  17911 -111.305158  80.564322  20190115   

        elevation  interpSLA class  SAT  track  
293787        NaN    -0.1113  floe  S3A    136  
&#39;local_data_select&#39;: 0.435 seconds
number obs: 725
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.075 seconds
&#39;_read_params_from_file&#39;: 0.144 seconds
&#39;set_parameters&#39;: 0.016 seconds
&#39;set_lengthscales_constraints&#39;: 0.015 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.048 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.008 seconds
parameters:
lengthscales: array([10.77204697, 10.27692744,  2.38901019]) 
kernel_variance: 0.016196797561501046
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.173 seconds
total run time : 1.70 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
5 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294032 -985206.226433  483145.278338  17911 -116.123339  80.162816  20190115   

        elevation  interpSLA class  SAT  track  
294032     0.2475    -0.0977  floe  S3A    136  
&#39;local_data_select&#39;: 0.445 seconds
number obs: 944
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.062 seconds
&#39;_read_params_from_file&#39;: 0.150 seconds
&#39;set_parameters&#39;: 0.023 seconds
&#39;set_lengthscales_constraints&#39;: 0.017 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.052 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.008 seconds
parameters:
lengthscales: array([10.71490588, 10.43185936,  2.60899021]) 
kernel_variance: 0.012929908390136483
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.192 seconds
total run time : 1.63 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
6 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294244 -989317.812886  583483.138854  17911 -120.531395  79.701889  20190115   

        elevation  interpSLA class  SAT  track  
294244    -0.1234     -0.094  floe  S3A    136  
&#39;local_data_select&#39;: 0.314 seconds
number obs: 702
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;_read_params_from_file&#39;: 0.090 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.035 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.69836121, 10.58737127,  2.76543724]) 
kernel_variance: 0.010025830169789774
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.134 seconds
total run time : 1.24 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
7 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294488 -993058.063068  684459.877912  17911 -124.576343  79.184512  20190115   

        elevation  interpSLA class  SAT  track  
294488     0.1136    -0.0422  floe  S3A    136  
&#39;local_data_select&#39;: 0.312 seconds
number obs: 824
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.042 seconds
&#39;_read_params_from_file&#39;: 0.099 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.033 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.72323793, 10.73088981,  2.83293424]) 
kernel_variance: 0.008195760162257988
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.155 seconds
total run time : 1.30 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
8 / 17
current local expert:
                    x              y      t         lon        lat      date  \
294743 -996398.060176  785400.509049  17911 -128.246582  78.620875  20190115   

        elevation  interpSLA class  SAT  track  
294743     0.2212    -0.0261  floe  S3A    136  
&#39;local_data_select&#39;: 0.297 seconds
number obs: 1088
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.097 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.034 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.79652742, 10.86007136,  2.85895777]) 
kernel_variance: 0.007939835096793777
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.173 seconds
total run time : 1.29 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
9 / 17
current local expert:
                    x              y      t         lon       lat      date  \
294948 -999328.512971  885963.803449  17911 -131.558885  78.01957  20190115   

        elevation  interpSLA class  SAT  track  
294948     0.1093    -0.0169  floe  S3A    136  
&#39;local_data_select&#39;: 0.306 seconds
number obs: 1052
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.042 seconds
&#39;_read_params_from_file&#39;: 0.390 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.035 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.91074465, 10.95712194,  2.9475113 ]) 
kernel_variance: 0.009224605956842784
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.154 seconds
total run time : 1.58 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
10 / 17
current local expert:
                   x              y      t         lon        lat      date  \
295163 -1.001861e+06  986475.006722  17911 -134.556649  77.384464  20190115   

        elevation  interpSLA class  SAT  track  
295163     0.1629     0.0107  floe  S3A    136  
&#39;local_data_select&#39;: 0.302 seconds
number obs: 1195
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.087 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.037 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.02365545, 11.00532398,  3.14200627]) 
kernel_variance: 0.011485285263791889
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.132 seconds
SAVING RESULTS TO TABLES:
run_details
preds
total run time : 1.65 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
11 / 17
current local expert:
                   x             y      t         lon        lat      date  \
295393 -1.003995e+06  1.086926e+06  17911 -137.271294  76.720423  20190115   

        elevation  interpSLA class  SAT  track  
295393     0.0876     0.0494  lead  S3A    136  
&#39;local_data_select&#39;: 0.310 seconds
number obs: 1672
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.039 seconds
&#39;_read_params_from_file&#39;: 0.102 seconds
&#39;set_parameters&#39;: 0.011 seconds
&#39;set_lengthscales_constraints&#39;: 0.010 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.042 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.07534968, 11.03535667,  3.36459818]) 
kernel_variance: 0.01378717291162561
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.273 seconds
total run time : 1.45 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
12 / 17
current local expert:
                   x             y      t         lon       lat      date  \
295555 -1.005711e+06  1.185979e+06  17911 -139.702054  76.04086  20190115   

        elevation  interpSLA class  SAT  track  
295555     0.0749     0.0873  lead  S3A    136  
&#39;local_data_select&#39;: 0.302 seconds
number obs: 2622
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.101 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.033 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.0408923 , 11.09981867,  3.48742589]) 
kernel_variance: 0.015287868896029028
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.332 seconds
total run time : 1.65 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
13 / 17
current local expert:
                   x             y      t         lon       lat      date  \
295746 -1.007083e+06  1.288943e+06  17911 -141.998591  75.31194  20190115   

        elevation  interpSLA class  SAT  track  
295746     0.1013     0.1221  lead  S3A    136  
&#39;local_data_select&#39;: 0.436 seconds
number obs: 2577
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.058 seconds
&#39;_read_params_from_file&#39;: 0.135 seconds
&#39;set_parameters&#39;: 0.025 seconds
&#39;set_lengthscales_constraints&#39;: 0.014 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.050 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.008 seconds
parameters:
lengthscales: array([10.95764066, 11.19338889,  3.44924858]) 
kernel_variance: 0.01580213689690553
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.294 seconds
total run time : 1.86 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
14 / 17
current local expert:
                   x             y      t         lon        lat      date  \
295951 -1.008017e+06  1.389163e+06  17911 -144.034273  74.583275  20190115   

        elevation  interpSLA class  SAT  track  
295951     0.2134     0.1485  floe  S3A    136  
&#39;local_data_select&#39;: 0.405 seconds
number obs: 2340
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.046 seconds
&#39;_read_params_from_file&#39;: 0.104 seconds
&#39;set_parameters&#39;: 0.017 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.043 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.90592498, 11.22510796,  3.30092029]) 
kernel_variance: 0.015625780192371465
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.273 seconds
total run time : 1.58 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
15 / 17
current local expert:
                   x             y      t        lon        lat      date  \
296159 -1.008550e+06  1.488628e+06  17911 -145.88225  73.843791  20190115   

        elevation  interpSLA class  SAT  track  
296159     0.0896     0.1145  lead  S3A    136  
&#39;local_data_select&#39;: 0.324 seconds
number obs: 2321
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;_read_params_from_file&#39;: 0.100 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.033 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([10.92397489, 11.135057  ,  3.1558388 ]) 
kernel_variance: 0.015212203297566746
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.263 seconds
total run time : 1.45 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
16 / 17
current local expert:
                   x             y      t        lon        lat      date  \
296340 -1.008689e+06  1.588987e+06  17911 -147.59263  73.083192  20190115   

        elevation  interpSLA class  SAT  track  
296340      0.045     0.0691  lead  S3A    136  
&#39;local_data_select&#39;: 0.293 seconds
number obs: 1756
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.040 seconds
&#39;_read_params_from_file&#39;: 0.100 seconds
&#39;set_parameters&#39;: 0.012 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.034 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.00071816, 10.94098671,  3.09393932]) 
kernel_variance: 0.014748783059548076
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.175 seconds
total run time : 1.32 seconds
<span class=" -Color -Color-Bold">--------------------------------------------------</span>
17 / 17
current local expert:
                   x             y      t         lon        lat      date  \
296522 -1.008427e+06  1.689237e+06  17911 -149.164002  72.310595  20190115   

        elevation  interpSLA class  SAT  track  
296522     0.0948     0.0349  floe  S3A    136  
&#39;local_data_select&#39;: 0.330 seconds
number obs: 862
<span class=" -Color -Color-Bold">found GPU</span>
setting lengthscales to: [1. 1. 1.]
&#39;__init__&#39;: 0.041 seconds
&#39;_read_params_from_file&#39;: 0.097 seconds
&#39;set_parameters&#39;: 0.015 seconds
&#39;set_lengthscales_constraints&#39;: 0.011 seconds
&#39;set_likelihood_variance_constraints&#39;: 0.042 seconds
*** not optimising parameters
&#39;get_parameters&#39;: 0.006 seconds
parameters:
lengthscales: array([11.10554477, 10.7110218 ,  3.13041508]) 
kernel_variance: 0.014269560692386676
likelihood_variance: 0.01999999999999999
&#39;predict&#39;: 0.118 seconds
total run time : 1.31 seconds
storing any remaining tables
SAVING RESULTS TO TABLES:
run_details
preds
&#39;run&#39;: 25.453 seconds
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-15-00747b791557&gt;</span> in <span class="ni">&lt;cell line: 112&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">    </span><span class="mi">111</span> 
<span class="g g-Whitespace">    </span><span class="mi">112</span> <span class="k">with</span> <span class="n">pd</span><span class="o">.</span><span class="n">HDFStore</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">store</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">113</span>     <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_mean&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">114</span>     <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_mean_SMOOTHED&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">115</span>     <span class="n">store</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;inducing_chol&#39;</span><span class="p">)</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/pytables.py</span> in <span class="ni">remove</span><span class="nt">(self, key, where, start, stop)</span>
<span class="g g-Whitespace">   </span><span class="mi">1161</span>         <span class="n">where</span> <span class="o">=</span> <span class="n">_ensure_term</span><span class="p">(</span><span class="n">where</span><span class="p">,</span> <span class="n">scope_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1162</span>         <span class="k">try</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1163</span>             <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_storer</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1164</span>         <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1165</span>             <span class="c1"># the key is not a valid store, re-raising KeyError</span>

<span class="nn">/usr/local/lib/python3.10/dist-packages/pandas/io/pytables.py</span> in <span class="ni">get_storer</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">   </span><span class="mi">1516</span>         <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1517</span>         <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1518</span>             <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No object named </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> in the file&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1519</span> 
<span class="g g-Whitespace">   </span><span class="mi">1520</span>         <span class="n">s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_storer</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;No object named inducing_mean in the file&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract, store in dict</span>

<span class="n">store_path</span> <span class="o">=</span> <span class="s2">&quot;/content/drive/MyDrive/Teaching_Michel/GEOL0069/StudentFolder/Week_8/GPSatSVGP_CS2S3_alongtrack_SLA_3D.h5&quot;</span>
<span class="n">dfs</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">GPSat</span><span class="o">.</span><span class="n">local_experts</span><span class="o">.</span><span class="n">get_results_from_h5file</span><span class="p">(</span><span class="n">store_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>reading in results
getting all tables
merging on expert location data
table: &#39;oi_config&#39; does not have all coords_col: [&#39;x&#39;, &#39;y&#39;, &#39;t&#39;] in columns, not merging on expert_locations
table: &#39;oi_config_SMOOTHED&#39; does not have all coords_col: [&#39;x&#39;, &#39;y&#39;, &#39;t&#39;] in columns, not merging on expert_locations
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">GPSat.postprocessing</span> <span class="kn">import</span> <span class="n">glue_local_predictions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span> <span class="o">=</span> <span class="n">dfs</span><span class="p">[</span><span class="s2">&quot;preds_SMOOTHED&quot;</span><span class="p">]</span>

<span class="n">preds_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-9c0630b2-10da-4cca-bcec-e3c214b7493f" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>y</th>
      <th>t</th>
      <th>_dim_0</th>
      <th>f*</th>
      <th>f*_var</th>
      <th>y_var</th>
      <th>f_bar</th>
      <th>pred_loc_x</th>
      <th>pred_loc_y</th>
      <th>pred_loc_t</th>
      <th>lon</th>
      <th>lat</th>
      <th>date</th>
      <th>elevation</th>
      <th>interpSLA</th>
      <th>class</th>
      <th>SAT</th>
      <th>track</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>0</td>
      <td>-0.119196</td>
      <td>0.003131</td>
      <td>0.023131</td>
      <td>0</td>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>1</td>
      <td>-0.132373</td>
      <td>0.002399</td>
      <td>0.022399</td>
      <td>0</td>
      <td>-965733.180581</td>
      <td>97352.081316</td>
      <td>17911.0</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>2</td>
      <td>-0.133488</td>
      <td>0.002370</td>
      <td>0.022370</td>
      <td>0</td>
      <td>-965810.511997</td>
      <td>98685.757156</td>
      <td>17911.0</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>3</td>
      <td>-0.134043</td>
      <td>0.002357</td>
      <td>0.022357</td>
      <td>0</td>
      <td>-965849.158887</td>
      <td>99352.629960</td>
      <td>17911.0</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-964721.476545</td>
      <td>80013.622113</td>
      <td>17911.0</td>
      <td>4</td>
      <td>-0.134320</td>
      <td>0.002351</td>
      <td>0.022351</td>
      <td>0</td>
      <td>-965868.475571</td>
      <td>99686.068297</td>
      <td>17911.0</td>
      <td>-94.741238</td>
      <td>81.324207</td>
      <td>20190115</td>
      <td>-0.0435</td>
      <td>NaN</td>
      <td>lead</td>
      <td>S3A</td>
      <td>136</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9c0630b2-10da-4cca-bcec-e3c214b7493f')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9c0630b2-10da-4cca-bcec-e3c214b7493f button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9c0630b2-10da-4cca-bcec-e3c214b7493f');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-8bde8a50-dca9-4996-845f-890e5a6b8b31">
  <button class="colab-df-quickchart" onclick="quickchart('df-8bde8a50-dca9-4996-845f-890e5a6b8b31')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-8bde8a50-dca9-4996-845f-890e5a6b8b31 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(13984,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance_expert</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;xprt_locs&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">distance_expert</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance_expert</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(13984,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">distance</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_x&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_loc_y&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">preds_data</span><span class="p">[</span><span class="s1">&#39;pred_locs&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">distance</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # multiple local experts may make predictions at the same prediction location (pred_loc).</span>
<span class="c1"># # - for each prediction at a given location, take we weighted combination</span>
<span class="c1"># # - weights being a function of the distance to each local expert that made a prediction at a given location.</span>

<span class="c1"># inference_radius = 200_000  # 200km</span>
<span class="c1"># plt_data = glue_local_predictions_2d(preds_df=preds_data,</span>
<span class="c1">#                                      pred_loc_cols=[&quot;pred_loc_x&quot;, &quot;pred_loc_y&quot;],</span>
<span class="c1">#                                      xprt_loc_cols=[&quot;x&quot;, &quot;y&quot;],</span>
<span class="c1">#                                      vars_to_glue=[&quot;f*&quot;, &quot;f*_var&quot;],</span>
<span class="c1">#                                      inference_radius=inference_radius)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">inference_radius</span> <span class="o">=</span> <span class="mi">200_000</span>  <span class="c1"># 200km</span>

<span class="n">glued_preds</span> <span class="o">=</span> <span class="n">glue_local_predictions_1d</span><span class="p">(</span><span class="n">preds_df</span> <span class="o">=</span> <span class="n">preds_data</span><span class="p">,</span>                  <span class="c1"># The dataframe where results are stored</span>
                                        <span class="n">pred_loc_col</span> <span class="o">=</span> <span class="s1">&#39;pred_locs&#39;</span><span class="p">,</span>             <span class="c1"># The column in dataframe corresponding to the prediction locations</span>
                                        <span class="n">xprt_loc_col</span> <span class="o">=</span> <span class="s1">&#39;xprt_locs&#39;</span><span class="p">,</span>             <span class="c1"># The column in dataframe corresponding to the local expert locations</span>
                                        <span class="n">vars_to_glue</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;f*&quot;</span><span class="p">,</span> <span class="s2">&quot;f*_var&quot;</span><span class="p">],</span>          <span class="c1"># The columns in dataframe corresponding to the predictions</span>
                                        <span class="n">inference_radius</span> <span class="o">=</span> <span class="n">inference_radius</span><span class="p">)</span>    <span class="c1"># The inference radius (by passing a single float, it is assumed to be equal for both regions)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glued_preds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
  <div id="df-d16bd93b-718b-47b0-aa20-f335763dd0f1" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pred_locs</th>
      <th>f*</th>
      <th>f*_var</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.000000e+00</td>
      <td>-0.114224</td>
      <td>0.003273</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.736795e+04</td>
      <td>-0.126856</td>
      <td>0.002586</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.870387e+04</td>
      <td>-0.127944</td>
      <td>0.002556</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.937186e+04</td>
      <td>-0.128480</td>
      <td>0.002543</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.970586e+04</td>
      <td>-0.128746</td>
      <td>0.002537</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3815</th>
      <td>1.787431e+06</td>
      <td>-0.051931</td>
      <td>0.009066</td>
    </tr>
    <tr>
      <th>3816</th>
      <td>1.789080e+06</td>
      <td>-0.051383</td>
      <td>0.009216</td>
    </tr>
    <tr>
      <th>3817</th>
      <td>1.789410e+06</td>
      <td>-0.051273</td>
      <td>0.009245</td>
    </tr>
    <tr>
      <th>3818</th>
      <td>1.789740e+06</td>
      <td>-0.051162</td>
      <td>0.009275</td>
    </tr>
    <tr>
      <th>3819</th>
      <td>1.790069e+06</td>
      <td>-0.051051</td>
      <td>0.009304</td>
    </tr>
  </tbody>
</table>
<p>3820 rows × 3 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d16bd93b-718b-47b0-aa20-f335763dd0f1')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d16bd93b-718b-47b0-aa20-f335763dd0f1 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d16bd93b-718b-47b0-aa20-f335763dd0f1');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a9868153-9cf4-4851-b3dc-76a4164bc70f">
  <button class="colab-df-quickchart" onclick="quickchart('df-a9868153-9cf4-4851-b3dc-76a4164bc70f')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a9868153-9cf4-4851-b3dc-76a4164bc70f button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>
    </div>
  </div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">glued_preds</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3820,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3820,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leads</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([   0,    1,   88, ..., 3753, 3754, 3755]),)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">leads</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lead&#39;</span><span class="p">)</span>
<span class="n">floes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;floe&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">leads</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">leads</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;leads&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">floes</span><span class="p">,</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">floes</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;floes&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">])),</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;linear interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">df_val</span><span class="p">[</span><span class="s1">&#39;interpSLA&#39;</span><span class="p">])),</span><span class="n">glued_preds</span><span class="p">[</span><span class="s1">&#39;f*&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;GPSat interp SLA&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/3e7349ecd6ff552b77f810480491c444f0a961571cc99afbec14ed7b5b493cdc.png" src="_images/3e7349ecd6ff552b77f810480491c444f0a961571cc99afbec14ed7b5b493cdc.png" />
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="Chapter_2_SLA_GPSat_William.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Interpolation of Sea Level Anomaly using GPSat</p>
      </div>
    </a>
    <a class="right-next"
       href="ExplainableAI.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Explainable AI</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Along track interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load data</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#select-profile-for-interpolation">Select profile for interpolation</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#generate-expert-locations-at-200-km">Generate expert locations at 200 km</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#interpolate-along-track">Interpolate along-track</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Michel Tsamados/Weibin Chen
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>